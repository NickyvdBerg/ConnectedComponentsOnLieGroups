(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    969115,      21433]
NotebookOptionsPosition[    640318,      15106]
NotebookOutlinePosition[    944513,      21075]
CellTagsIndexPosition[    944470,      21072]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.635672260738264*^9, 3.635672265820571*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b48582d0-796c-4d80-a70e-26fe08b36565"],

Cell[CellGroupData[{

Cell["Functions", "Chapter",
 CellChangeTimes->{{3.9055881397239814`*^9, 
  3.9055881412441463`*^9}},ExpressionUUID->"1f1b5ca2-a3e0-4c9b-ae2f-\
da293954b2b8"],

Cell[CellGroupData[{

Cell["General functions", "Section",
 CellChangeTimes->{{3.8713711461793976`*^9, 
  3.871371148540756*^9}},ExpressionUUID->"5be36f9a-83fd-47c6-9cf4-\
aa397ae71445"],

Cell[CellGroupData[{

Cell["Coordinate Conversion", "Subsection",
 CellChangeTimes->{{3.665124935814988*^9, 
  3.6651249390832376`*^9}},ExpressionUUID->"5eecc558-7caf-4f54-a673-\
ab096ff804e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Converts", " ", "graphics", " ", "coordinates", " ", "to", " ", "image", 
    " ", "coordinates", " ", "using", " ", "image", " ", "dimensions"}], 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"graphicsToImageCoordinates", "[", 
     RowBox[{"imOrImDim_", ",", "coordinates_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ydim", ",", "xdim"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "imOrImDim", "]"}], "\[Equal]", "2"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", "imOrImDim", "]"}], "\[Equal]", "2"}]}], 
         ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ydim", ",", "xdim"}], "}"}], "=", "imOrImDim"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ydim", ",", "xdim"}], "}"}], "=", 
          RowBox[{"Dimensions", "[", "imOrImDim", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ydim", "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "+", 
           RowBox[{"1", "/", "2"}]}], "&"}], ",", "coordinates", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Depth", "[", "coordinates", "]"}], "-", "2"}], "}"}]}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Converts", " ", "image", " ", "coordinates", " ", "to", " ", "graphics", 
     " ", "coordinates", " ", "using", " ", "image", " ", "dimensions"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imageToGraphicsCoordinates", "[", 
     RowBox[{"imOrImDim_", ",", "coordinates_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ydim", ",", "xdim"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "imOrImDim", "]"}], "\[Equal]", "2"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", "imOrImDim", "]"}], "\[Equal]", "2"}]}], 
         ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ydim", ",", "xdim"}], "}"}], "=", "imOrImDim"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ydim", ",", "xdim"}], "}"}], "=", 
          RowBox[{"Dimensions", "[", "imOrImDim", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"ydim", "+", "1", "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "-", 
           RowBox[{"1", "/", "2"}]}], "&"}], ",", "coordinates", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Depth", "[", "coordinates", "]"}], "-", "2"}], "}"}]}], 
        "]"}]}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"PointImageCoordinates", "[", 
     RowBox[{"imOrImDim_", ",", "coordinates_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ydim", ",", "xdim"}], "}"}], ",", "\n", 
      RowBox[{"Point", "[", 
       RowBox[{"imageToGraphicsCoordinates", "[", 
        RowBox[{"imOrImDim", ",", "coordinates"}], "]"}], "]"}]}], "]"}]}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{"LineImageCoordinates", "[", 
     RowBox[{"imOrImDim_", ",", "coordinates_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ydim", ",", "xdim"}], "}"}], ",", "\n", 
      RowBox[{"Line", "[", 
       RowBox[{"imageToGraphicsCoordinates", "[", 
        RowBox[{"imOrImDim", ",", "coordinates"}], "]"}], "]"}]}], "]"}]}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{"ArrowImageCoordinates", "[", 
     RowBox[{"imOrImDim_", ",", "coordinates_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ydim", ",", "xdim"}], "}"}], ",", "\n", 
      RowBox[{"Map", "[", 
       RowBox[{"Arrow", ",", 
        RowBox[{"imageToGraphicsCoordinates", "[", 
         RowBox[{"imOrImDim", ",", "coordinates"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Depth", "[", "coordinates", "]"}], "-", "3"}], "}"}]}], 
       "]"}]}], "]"}]}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.665124939880169*^9, 3.665124939895767*^9}, {
   3.6651279049928255`*^9, 3.665127911816661*^9}, {3.665127948462348*^9, 
   3.6651280186162367`*^9}, {3.6651281213424406`*^9, 3.665128130117424*^9}, 
   3.665128584550886*^9, {3.665128867302336*^9, 3.6651289344292917`*^9}, {
   3.665128964644614*^9, 3.665129023836845*^9}, {3.6651323236384478`*^9, 
   3.66513232860851*^9}, {3.6651329851615205`*^9, 3.6651329854115896`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"ce0bcb8c-1ef3-4c54-ae9d-7ead0859c500"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Cost Function", "Section",
 CellChangeTimes->{{3.871371313477089*^9, 3.8713713230924745`*^9}, 
   3.8713744994680367`*^9},ExpressionUUID->"1ac3cd53-09e5-45f5-b47e-\
6795de51639f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", " ", "LieAnalysis`"}]}], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"b66c351f-b1cc-4483-b96b-f808bb4bc972"],

Cell[CellGroupData[{

Cell["Single Scale Vesselness Filter", "Subsection",
 CellChangeTimes->{{3.8316344807809677`*^9, 3.831634483141035*^9}, {
  3.8713757292638564`*^9, 3.871375737736952*^9}, {3.8713757708660736`*^9, 
  3.8713757848739877`*^9}},ExpressionUUID->"98d76889-0838-449f-98b7-\
d7385e0c913c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostFunctionVesselnessFiltering", "[", 
   RowBox[{
   "U_", ",", "\[Xi]_", ",", "\[Zeta]_", ",", "\[Sigma]s_", ",", "method_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cost", ",", "H", ",", "Q", ",", "S", ",", "R", ",", "B11", ",", "B22", 
      ",", "obj", ",", "oc", ",", 
      RowBox[{"\[Sigma]1", "=", "0.5"}], ",", "\[Sigma]2", ",", "Qgreater0", 
      ",", "M", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3", ",", 
      "c", ",", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"0.75", "/", "\[Sigma]s"}]}], ",", "Hess"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"calculate", " ", "the", " ", "Hessian"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"obj", "=", 
      RowBox[{"ObjPositionOrientationData", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Data\>\"", "\[Rule]", "U"}], ",", 
         RowBox[{"\"\<Symmetry\>\"", "\[Rule]", 
          RowBox[{"2", "\[Pi]"}]}], ",", " ", 
         RowBox[{"\"\<Wavelets\>\"", "\[Rule]", " ", "None"}], ",", " ", 
         RowBox[{"\"\<InputData\>\"", "\[Rule]", " ", "None"}], ",", " ", 
         RowBox[{"\"\<DcFilteredImage\>\"", "\[Rule]", "0"}]}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{
       RowBox[{"OrientationScoreTensor", "[", 
        RowBox[{"obj", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0.5", "*", 
            SuperscriptBox["\[Sigma]s", "2"]}], ",", 
           RowBox[{"0.5", "*", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[Beta]", "*", "\[Sigma]s"}], ")"}], "2"]}]}], "}"}], 
         ",", "\"\<Hessian\>\""}], "]"}], "[", "\"\<Data\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"define", " ", "M"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"M", " ", "=", " ", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "\[Xi]"], ",", 
         FractionBox["\[Zeta]", "\[Xi]"], ",", "1"}], "}"}], "]"}]}], ";", 
     "  ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"obtain", " ", "the", " ", "Hessian", " ", "field"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Hess", "=", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"M", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ".", "M"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"Nx", ",", "Ny", ",", "No"}], "}"}]}], "]"}], "*", "H"}]}], 
     ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Hess", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"M", ".", "#", ".", "M"}], "&"}], ",", "H", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Determine", " ", "variables", " ", "depending", " ", "on", " ", "the", 
       " ", "method", " ", "that", " ", "is", " ", "considered"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"method", "==", "\"\<LIF\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Lambda]1", "=", 
         RowBox[{"Hess", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "All", ",", "1", ",", "1"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"Hess", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "All", ",", "2", ",", "2"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Q", "=", "c"}], ";"}], " ", 
       RowBox[{"(*", 
        RowBox[{"convexity", " ", "criterion"}], "*)"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]3", ",", "\[Lambda]2", ",", "\[Lambda]1"}], "}"}],
          "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Eigenvalues", "[", 
               RowBox[{"M", ".", "M", ".", 
                RowBox[{"Transpose", "[", "#", "]"}], ".", "M", ".", "M", ".",
                 "#"}], "]"}], "&"}], ",", "H", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"0.5", "*", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]2", "+", "\[Lambda]3"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"Hess", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "All", ",", "2", ",", "2"}], 
          "\[RightDoubleBracket]"}]}]}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"convexity", " ", "criterion"}], "*)"}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Determine", " ", "measures", " ", "that", " ", "are", " ", "used", " ",
        "when", " ", "calculating", " ", "the", " ", "vesselness"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{
       SuperscriptBox["\[Lambda]1", "2"], "+", 
       SuperscriptBox["c", "2"]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"structure", " ", "measure"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"\[Lambda]1", "/", "c"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"anisotropy", " ", "measure"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]2", "=", 
      RowBox[{"0.2", "*", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", "S", "]"}], "]"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", "S", "]"}], "]"}], " ", "ensures", " ", "that", 
       " ", "the", " ", "method", " ", "is", " ", "scaling", " ", 
       "invariant"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calculate", " ", "the", " ", "vesselness", " ", "at", " ", "ALL", " ", 
       "locations", " ", "and", " ", "orientations"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["R", "2"]}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SuperscriptBox["\[Sigma]1", "2"]}], ")"}]}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "S"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "\[Sigma]2"}], ")"}]}], "]"}]}], ")"}]}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Selection", " ", "criterion", " ", "on", " ", "convexity"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Qgreater0", "=", 
      RowBox[{"1", "-", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"-", "Q"}], "]"}]}]}], 
     RowBox[{"(*", 
      RowBox[{"Boole", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ">", "0"}], "&"}], ",", "Q", ",", 
         RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "*)"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Vesselness", " ", "at", " ", "locations", " ", "that", " ", "meet", 
       " ", "the", " ", "convexity", " ", "criterion"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{"cost", "*", "Qgreater0"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "cost", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.831700621055113*^9, 3.83170071527347*^9}, {
   3.831700747539089*^9, 3.8317007766656637`*^9}, {3.8317008204573913`*^9, 
   3.831700862001667*^9}, {3.831700892710336*^9, 3.831700970456744*^9}, {
   3.8317010154423776`*^9, 3.831701059479223*^9}, {3.8317013033704925`*^9, 
   3.8317013312815733`*^9}, {3.831701406870053*^9, 3.831701479619607*^9}, 
   3.831702376776008*^9, {3.831702481275221*^9, 3.831702483945857*^9}, {
   3.8317025887621565`*^9, 3.8317025903591995`*^9}, {3.8317027497648787`*^9, 
   3.831702800763775*^9}, {3.8317033970662265`*^9, 3.831703398700817*^9}, {
   3.8317035132347107`*^9, 3.8317035667713284`*^9}, 3.831703623390505*^9, {
   3.831703687980508*^9, 3.831703755108315*^9}, 3.8317040310380526`*^9, {
   3.831704503596468*^9, 3.8317045060547113`*^9}, {3.8317091510973673`*^9, 
   3.831709151348405*^9}, {3.831709700050008*^9, 3.8317097006454115`*^9}, {
   3.831709769465223*^9, 3.831709778053362*^9}, {3.8317155312170706`*^9, 
   3.8317155333119874`*^9}, {3.8317161114464207`*^9, 3.831716113460864*^9}, {
   3.8317165663062634`*^9, 3.831716601884225*^9}, {3.8317166341631827`*^9, 
   3.8317166662136497`*^9}, {3.831716698452117*^9, 3.8317168843813276`*^9}, {
   3.8317170307114677`*^9, 3.8317170337875433`*^9}, {3.8317171661180487`*^9, 
   3.8317171824213257`*^9}, 3.8317196038493547`*^9, {3.8317198439178524`*^9, 
   3.831719846461735*^9}, {3.831720090946414*^9, 3.831720107271838*^9}, {
   3.83180597103368*^9, 3.831805975131879*^9}, 3.8318066757759495`*^9, 
   3.831807160890427*^9, {3.831807535208869*^9, 3.83180753950561*^9}, 
   3.831816444761509*^9, {3.8318769075046463`*^9, 3.831876924351859*^9}, {
   3.8318769679894247`*^9, 3.831876969530199*^9}, 3.8318770753873186`*^9, {
   3.831877380489173*^9, 3.831877416462142*^9}, 3.8318776429750586`*^9, {
   3.831877724862707*^9, 3.831877724981058*^9}, 3.831877863831921*^9, {
   3.831877987522004*^9, 3.831877987771125*^9}, 3.8318780977397194`*^9, 
   3.831878680963387*^9, {3.831878755740961*^9, 3.831878755799967*^9}, 
   3.8318792938839674`*^9, {3.8318798792499523`*^9, 3.831879879727828*^9}, 
   3.8318918349459953`*^9, 3.831892122586246*^9, {3.8318924298905687`*^9, 
   3.831892429990985*^9}, 3.831893137371763*^9, {3.831893508108944*^9, 
   3.8318935086064987`*^9}, {3.8318977629378843`*^9, 3.831897763043951*^9}, 
   3.8319619837836237`*^9, {3.831962015095559*^9, 3.8319620211980247`*^9}, {
   3.832039708432623*^9, 3.832039771838543*^9}, {3.8320399649595394`*^9, 
   3.832039967207567*^9}, {3.8320400626702003`*^9, 3.832040090979965*^9}, {
   3.832040147331139*^9, 3.83204021589231*^9}, {3.8320404626864543`*^9, 
   3.83204047811031*^9}, {3.8320405304053903`*^9, 3.832040532371476*^9}, {
   3.8320406329553537`*^9, 3.832040639388233*^9}, {3.8320406794126854`*^9, 
   3.8320406815172057`*^9}, {3.8320415723932037`*^9, 
   3.8320417365714226`*^9}, {3.8320418581849036`*^9, 3.832041858268427*^9}, {
   3.8320419615836406`*^9, 3.83204197356218*^9}, {3.8320422023049603`*^9, 
   3.8320422244985046`*^9}, 3.832043217729306*^9, 3.832043405912733*^9, {
   3.83204354210608*^9, 3.832043544501052*^9}, {3.8320501159262037`*^9, 
   3.83205011599699*^9}, {3.8320877489160194`*^9, 3.8320877502980633`*^9}, 
   3.8320893687909594`*^9, {3.832089922644105*^9, 3.832089923021311*^9}, {
   3.8320920918539553`*^9, 3.832092092656397*^9}, {3.832147657024498*^9, 
   3.8321476779655695`*^9}, {3.832147862083398*^9, 3.83214786842303*^9}, {
   3.8322997317459273`*^9, 3.8322997436680493`*^9}, {3.8466754167767963`*^9, 
   3.8466754214888153`*^9}, 3.8466755327969456`*^9, 3.8466757923554125`*^9, {
   3.8467384136211014`*^9, 3.846738663916294*^9}, {3.8467553051584396`*^9, 
   3.8467553078065615`*^9}, {3.8472525489043355`*^9, 
   3.8472525532853584`*^9}, {3.8472525955539646`*^9, 
   3.8472526036202583`*^9}, {3.8472532930518665`*^9, 
   3.8472532993081465`*^9}, {3.847253682235481*^9, 3.847253690273202*^9}, {
   3.84726643518459*^9, 3.847266452966767*^9}, {3.847270444672587*^9, 
   3.847270446233013*^9}, 3.8472736558816433`*^9, {3.847276058842713*^9, 
   3.8472761159053526`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"e9b7349a-76e7-4e6b-9d41-a98e279a90e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cost", "[", 
   RowBox[{"oc_", ",", "\[Lambda]_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "cost", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cost", "=", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"\[Lambda]", "*", 
          SuperscriptBox["oc", "p"]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ImageAdjust", "[", 
        RowBox[{"Image", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"Min", ",", 
           RowBox[{"Rescale", "[", "cost", "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8319618117031293`*^9, 3.8319618838348403`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"00dbe610-eee4-4379-b93e-2e35226421c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostFunction", "[", 
   RowBox[{"oc_", ",", "\[Lambda]_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "cost", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cost", "=", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"\[Lambda]", "*", 
          SuperscriptBox["oc", "p"]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "cost", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8319618117031293`*^9, 3.8319618838348403`*^9}, {
  3.831998121571029*^9, 3.831998129082103*^9}, {3.831998168905656*^9, 
  3.831998169657459*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"9b967058-8619-4a9f-bd37-6860dc4468c6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Multiscale Vesselness Filter", "Subsection",
 CellChangeTimes->{{3.8467368047953024`*^9, 
  3.8467368118756647`*^9}},ExpressionUUID->"bf5c9a22-840b-42b0-85ad-\
d8bddec3f25d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiScaleVesselness", "[", 
   RowBox[{
   "U_", ",", "Uboarder_", ",", "\[Xi]_", ",", "\[Zeta]_", ",", "\[Sigma]s_", 
    ",", "method_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vesselness", ",", "vesselnessBoarder", ",", "vesselnessfilterNoBoarder",
       ",", "vesselnessfilterNoBoarderErosion", ",", 
      "vesselnessfilterNoBoarderErosion2", ",", "liftElevators", ",", 
      "newvesselnessfilter", ",", 
      RowBox[{"vesselnessfilter", "=", 
       RowBox[{"{", "}"}]}], ",", "k", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "\[Sigma]s", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Select", " ", "the", " ", "spatial", " ", "scale", " ", "for", " ", 
         "the", " ", "specific", " ", "iteration"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"\[Sigma]s", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "of", " ", "the", 
          " ", "full", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselness", "=", 
         RowBox[{"CostFunctionVesselnessFiltering", "[", 
          RowBox[{
          "U", ",", "\[Xi]", ",", "\[Zeta]", ",", "k", ",", "method"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "of", " ", "the", 
          " ", "boarder", " ", "of", " ", "the", " ", "image"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"vesselnessBoarder", "=", 
         RowBox[{"CostFunctionVesselnessFiltering", "[", 
          RowBox[{
          "Uboarder", ",", "\[Xi]", ",", "\[Zeta]", ",", "k", ",", "method"}],
           "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "without", " ", 
          "the", " ", "boarder"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselnessfilterNoBoarder", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"UnitStep", "[", 
             RowBox[{"vesselnessBoarder", "-", "0.0001"}], "]"}]}], ")"}], 
          "*", "vesselness"}]}], 
        RowBox[{"(*", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Boole", "[", 
             RowBox[{"#", "<", "0.0001"}], "]"}], "&"}], ",", 
           "vesselnessBoarder", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "*)"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Add", " ", "erosion", " ", "to", " ", "the", " ", "cost", " ", 
           "function"}], " ", "\[Rule]", " ", 
          RowBox[{
          "erosion", " ", "of", " ", "broad", " ", "angular", " ", 
           "boundaries"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselnessfilterNoBoarderErosion", "=", 
         RowBox[{"Erosion", "[", 
          RowBox[{"vesselnessfilterNoBoarder", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}], "}"}], ",", 
           RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Erosion", "[", 
              RowBox[{"#", ",", "0.5", ",", 
               RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}], 
             "&"}], ",", "vesselnessfilterNoBoarder", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ";"}], "*)"}], " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Cut", " ", "off", " ", "the", " ", "upper", " ", "boarder", " ", 
          "which", " ", "influences", " ", "the", " ", "vesselness"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
        "vesselnessfilterNoBoarderErosion2", "=", 
         "vesselnessfilterNoBoarderErosion"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vesselnessfilterNoBoarderErosion2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "5"}], "]"}], "]"}], "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "Ny", ",", "No"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Boole", "[", 
               RowBox[{
                RowBox[{
                "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "\[GreaterEqual]", "6"}], "]"}], "*", "#1"}], "&"}], ",", 
            "vesselnessfilterNoBoarderErosion", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], ";"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"Cut", " ", "off", " ", "upper", " ", "boarder"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"(*", 
          RowBox[{
          "Create", " ", "mobility", " ", "function", " ", "only", " ", 
           "containing", " ", "lifts", " ", "at", " ", "bifurcations"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"liftElevators", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"No", ",", "Nx", ",", "Ny"}], "}"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"liftElevators", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"ySelect", ",", "0"}], "}"}]}], ")"}]}]}], 
                 "\[RightDoubleBracket]"}], "=", "1"}], ";"}], "&"}], ",", 
             "seedsIndex"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"liftElevators", "=", 
            RowBox[{"GaussianFilter", "[", 
             RowBox[{"liftElevators", ",", "1.5"}], "]"}]}], ";"}], "*)"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Combine", " ", "both", " ", "mobility", " ", "functions"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{
                 "Rescale", "[", "vesselnessfilterNoBoarderErosion2", "]"}]}],
                 ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{
                  RowBox[{"Rescale", "[", "liftElevators", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "}"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "new", " ", "vesselness", " ", "to", " ", "the", " ", 
          "array", " ", "containing", " ", "vesselness", " ", "filters", " ", 
          "for", " ", "all", " ", "different", " ", "values", " ", "of", " ", 
          "\[Sigma]s"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "newvesselnessfilter", "=", "vesselnessfilterNoBoarderErosion2"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"vesselnessfilter", ",", "newvesselnessfilter"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"vesselnessfilter", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"vesselnessfilter", ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "vesselnessfilter", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.846069290478445*^9, 3.846069320848277*^9}, {
  3.846069388578823*^9, 3.8460694136426706`*^9}, {3.8460698943625517`*^9, 
  3.8460699961806927`*^9}, {3.8460700607895765`*^9, 3.846070370519379*^9}, {
  3.8460704370347395`*^9, 3.846070455399172*^9}, {3.8460705633723164`*^9, 
  3.846070607320956*^9}, {3.8461357617580004`*^9, 3.84613576321036*^9}, {
  3.8461371780315437`*^9, 3.8461371794824996`*^9}, {3.8467383924445486`*^9, 
  3.8467384051500874`*^9}, {3.8472527956174803`*^9, 3.847252804776075*^9}, {
  3.847254715962023*^9, 3.84725477265746*^9}, {3.8472550730271826`*^9, 
  3.8472550948254304`*^9}, {3.8472645825577707`*^9, 3.8472645902415514`*^9}, {
  3.8472648673212476`*^9, 3.8472649626651025`*^9}, {3.8472650190287113`*^9, 
  3.8472650286441393`*^9}, {3.8472761287663803`*^9, 3.8472762743068795`*^9}, {
  3.8479437503598204`*^9, 3.8479437633810444`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"998a2175-9b2d-434e-b46e-c403fdbd3cb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiScaleVesselnessFilter", "[", "vesselnessfilters_", "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sum1", ",", "\[Mu]\[Infinity]", ",", "sum2", ",", "\[Mu]l\[Infinity]", 
      ",", "cost"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Calculate", " ", "vesselness", " ", "per", " ", "location", " ", "and", 
      " ", "orientation", " ", "by", " ", "taking", " ", "sum", " ", "over", 
      " ", "all", " ", "spatial", " ", "scales"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sum1", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"vesselnessfilters", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Dimensions", "[", "vesselnessfilters", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"weights", ".", "#"}], "]"}], "&"}], ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"vesselnessfilters", ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], "*)"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calculate", " ", "maximum", " ", "value", " ", "in", " ", "sum1"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Mu]\[Infinity]", "=", 
      RowBox[{"Max", "[", "sum1", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Rescale", " ", "the", " ", "sum1", " ", "by", " ", "dividing", " ", 
       "with", " ", "its", " ", "maximum", " ", "to", " ", "find", " ", "the",
        " ", "cost", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{
       SuperscriptBox["\[Mu]\[Infinity]", 
        RowBox[{"-", "1"}]], "*", "sum1"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cost", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"cost", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Calculate", " ", "vesselness", " ", "per", " ", "location", " ", 
         "by", " ", "taking", " ", "sum", " ", "over", " ", "all", " ", 
         "orientations"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"sum2", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"cost", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "cost", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Calculate", " ", "maximum", " ", "value", " ", "in", " ", "sum2"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Mu]l\[Infinity]", "=", 
        RowBox[{"Max", "[", "sum2", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"cost", "=", 
        RowBox[{
         SuperscriptBox["\[Mu]l\[Infinity]", 
          RowBox[{"-", "1"}]], "*", "sum2"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "cost", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8461351164748793`*^9, 3.846135301233615*^9}, {
  3.8461353918983126`*^9, 3.8461354296469297`*^9}, {3.8461354708019032`*^9, 
  3.84613550183355*^9}, {3.846135565954836*^9, 3.846135585502041*^9}, {
  3.8461356206333733`*^9, 3.846135625324848*^9}, {3.8461365925473847`*^9, 
  3.8461366255417967`*^9}, {3.8461366613125324`*^9, 3.8461366681133223`*^9}, {
  3.8461380233321896`*^9, 3.8461380346543207`*^9}, {3.84658043492728*^9, 
  3.8465804362968216`*^9}, {3.846761981543815*^9, 3.8467619923206415`*^9}, {
  3.846762380572624*^9, 3.8467624741657667`*^9}, {3.84676257915926*^9, 
  3.8467625894172935`*^9}, {3.846762774042492*^9, 3.8467627925348787`*^9}, {
  3.8472751267320757`*^9, 3.847275212905927*^9}, {3.847276618866034*^9, 
  3.847276871448764*^9}, {3.847276925336969*^9, 3.847276930574594*^9}, {
  3.847277021172058*^9, 3.847277055403304*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"db448320-72fb-44bb-a98f-68f821a7f685"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiScaleVesselnessFilter2D", "[", "vesselnessfilters_", "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sum1", ",", "\[Mu]\[Infinity]", ",", "sum2", ",", "\[Mu]l\[Infinity]", 
      ",", "cost"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Calculate", " ", "vesselness", " ", "per", " ", "location", " ", "and", 
      " ", "orientation", " ", "by", " ", "taking", " ", "sum", " ", "over", 
      " ", "all", " ", "spatial", " ", "scales"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sum1", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"vesselnessfilters", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Dimensions", "[", "vesselnessfilters", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"weights", ".", "#"}], "]"}], "&"}], ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"vesselnessfilters", ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], "*)"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calculate", " ", "maximum", " ", "value", " ", "in", " ", "sum1"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Mu]\[Infinity]", "=", 
      RowBox[{"Max", "[", "sum1", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Rescale", " ", "the", " ", "sum1", " ", "by", " ", "dividing", " ", 
       "with", " ", "its", " ", "maximum", " ", "to", " ", "find", " ", "the",
        " ", "cost", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{
       SuperscriptBox["\[Mu]\[Infinity]", 
        RowBox[{"-", "1"}]], "*", "sum1"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Putting", " ", "cost", " ", "function", " ", "in", " ", "right", " ", 
       "dimensions"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"cost", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calculate", " ", "vesselness", " ", "per", " ", "location", " ", "by", 
       " ", "taking", " ", "sum", " ", "over", " ", "all", " ", 
       "orientations"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sum2", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"cost", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Dimensions", "[", "cost", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calculate", " ", "maximum", " ", "value", " ", "in", " ", "sum2"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Mu]l\[Infinity]", "=", 
      RowBox[{"Max", "[", "sum2", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{
       SuperscriptBox["\[Mu]l\[Infinity]", 
        RowBox[{"-", "1"}]], "*", "sum2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "cost", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8461351164748793`*^9, 3.846135301233615*^9}, {
  3.8461353918983126`*^9, 3.8461354296469297`*^9}, {3.8461354708019032`*^9, 
  3.84613550183355*^9}, {3.846135565954836*^9, 3.846135585502041*^9}, {
  3.8461356206333733`*^9, 3.846135625324848*^9}, {3.8461365925473847`*^9, 
  3.8461366255417967`*^9}, {3.8461366613125324`*^9, 3.8461366681133223`*^9}, {
  3.8461380233321896`*^9, 3.8461380346543207`*^9}, {3.84658043492728*^9, 
  3.8465804362968216`*^9}, {3.846761981543815*^9, 3.8467619923206415`*^9}, {
  3.846762380572624*^9, 3.8467624741657667`*^9}, {3.84676257915926*^9, 
  3.8467625894172935`*^9}, {3.846762774042492*^9, 3.8467627925348787`*^9}, {
  3.8472751267320757`*^9, 3.847275212905927*^9}, {3.847276618866034*^9, 
  3.847276871448764*^9}, {3.847276925336969*^9, 3.847276930574594*^9}, {
  3.847277021172058*^9, 3.847277055403304*^9}, {3.8472784934463716`*^9, 
  3.84727851900611*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"b7fe319a-fe9a-4561-9273-70c7584e6617"]
}, Closed]],

Cell[CellGroupData[{

Cell["External Regularization", "Subsection",
 CellChangeTimes->{{3.846736828118457*^9, 
  3.8467368336747875`*^9}},ExpressionUUID->"bd348826-fe53-4650-b8ef-\
3e44f2fcf11d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostFunctionVesselnessFilteringExtReg", "[", 
   RowBox[{
   "U_", ",", "\[Xi]_", ",", "\[Zeta]_", ",", "\[Sigma]s_", ",", "method_", 
    ",", 
    RowBox[{"\[Sigma]sExt_", ":", "0"}], ",", 
    RowBox[{"\[Sigma]aExt_", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cost", ",", "H", ",", "Q", ",", "S", ",", "R", ",", "B11", ",", "B22", 
      ",", "obj", ",", "oc", ",", 
      RowBox[{"\[Sigma]1", "=", "0.5"}], ",", "\[Sigma]2", ",", "Qgreater0", 
      ",", "M", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3", ",", 
      "c", ",", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"0.75", "/", "\[Sigma]s"}]}], ",", "Hess"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"calculate", " ", "the", " ", "Hessian"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"obj", "=", 
      RowBox[{"ObjPositionOrientationData", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Data\>\"", "\[Rule]", "U"}], ",", 
         RowBox[{"\"\<Symmetry\>\"", "\[Rule]", 
          RowBox[{"2", "\[Pi]"}]}], ",", " ", 
         RowBox[{"\"\<Wavelets\>\"", "\[Rule]", " ", "None"}], ",", " ", 
         RowBox[{"\"\<InputData\>\"", "\[Rule]", " ", "None"}], ",", " ", 
         RowBox[{"\"\<DcFilteredImage\>\"", "\[Rule]", "0"}]}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{
       RowBox[{"OrientationScoreTensor", "[", 
        RowBox[{"obj", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0.5", "*", 
            SuperscriptBox["\[Sigma]s", "2"]}], ",", 
           RowBox[{"0.5", "*", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[Beta]", "*", "\[Sigma]s"}], ")"}], "2"]}]}], "}"}], 
         ",", "\"\<Hessian\>\""}], "]"}], "[", "\"\<Data\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"define", " ", "M"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"M", " ", "=", " ", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "\[Xi]"}], ",", 
         RowBox[{"\[Zeta]", "/", "\[Xi]"}], ",", "1"}], "}"}], "]"}]}], ";", 
     "  ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Sigma]sExt", ",", "\[Sigma]aExt"}], "}"}], " ", "=!=", 
        " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Sigma]sExt", ",", "\[Sigma]aExt"}], "}"}], " ", 
           "proportional", " ", "with", " ", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]s", ",", "\[Sigma]a"}]}]}], ")"}], "?"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"H", "=", " ", 
         RowBox[{"LieAnalysis`Common`ExternalRegularization", "[", 
          RowBox[{"H", ",", " ", 
           RowBox[{"obj", "[", "\"\<FullOrientationList\>\"", "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]sExt", ",", "\[Sigma]aExt"}], "}"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Dimensions", "[", "H", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"Nx", ",", "Ny", ",", "No"}], "}"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"obtain", " ", "the", " ", "Hessian", " ", "field"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Hess", "=", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"M", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ".", "M"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"Nx", ",", "Ny", ",", "No"}], "}"}]}], "]"}], "*", "H"}]}], 
     RowBox[{"(*", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"M", ".", "#", ".", "M"}], "&"}], ",", "H", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], "*)"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Determine", " ", "variables", " ", "depending", " ", "on", " ", "the", 
       " ", "method", " ", "that", " ", "is", " ", "considered"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"method", "==", "\"\<LIF\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Lambda]1", "=", 
         RowBox[{"Hess", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "All", ",", "1", ",", "1"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"Hess", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "All", ",", "2", ",", "2"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Q", "=", "c"}], ";"}], " ", 
       RowBox[{"(*", 
        RowBox[{"convexity", " ", "criterion"}], "*)"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]3", ",", "\[Lambda]2", ",", "\[Lambda]1"}], "}"}],
          "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Eigenvalues", "[", 
               RowBox[{"M", ".", "M", ".", 
                RowBox[{"Transpose", "[", "#", "]"}], ".", "M", ".", "M", ".",
                 "#"}], "]"}], "&"}], ",", "H", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"0.5", "*", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]2", "+", "\[Lambda]3"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"Hess", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "All", ",", "2", ",", "2"}], 
          "\[RightDoubleBracket]"}]}]}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"convexity", " ", "criterion"}], "*)"}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Determine", " ", "measures", " ", "that", " ", "are", " ", "used", " ",
        "when", " ", "calculating", " ", "the", " ", "vesselness"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{
       SuperscriptBox["\[Lambda]1", "2"], "+", 
       SuperscriptBox["c", "2"]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"structure", " ", "measure"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"\[Lambda]1", "/", "c"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"anisotropy", " ", "measure"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]2", "=", 
      RowBox[{"0.2", "*", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", "S", "]"}], "]"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", "S", "]"}], "]"}], " ", "ensures", " ", "that", 
       " ", "the", " ", "method", " ", "is", " ", "scaling", " ", 
       "invariant"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calculate", " ", "the", " ", "vesselness", " ", "at", " ", "ALL", " ", 
       "locations", " ", "and", " ", "orientations"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["R", "2"]}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SuperscriptBox["\[Sigma]1", "2"]}], ")"}]}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "S"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "\[Sigma]2"}], ")"}]}], "]"}]}], ")"}]}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Selection", " ", "criterion", " ", "on", " ", "convexity"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Qgreater0", "=", 
      RowBox[{"1", "-", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"-", "Q"}], "]"}]}]}], 
     RowBox[{"(*", 
      RowBox[{"Boole", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ">", "0"}], "&"}], ",", "Q", ",", 
         RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "*)"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Vesselness", " ", "at", " ", "locations", " ", "that", " ", "meet", 
       " ", "the", " ", "convexity", " ", "criterion"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{"cost", "*", "Qgreater0"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "cost", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.831700621055113*^9, 3.83170071527347*^9}, {
   3.831700747539089*^9, 3.8317007766656637`*^9}, {3.8317008204573913`*^9, 
   3.831700862001667*^9}, {3.831700892710336*^9, 3.831700970456744*^9}, {
   3.8317010154423776`*^9, 3.831701059479223*^9}, {3.8317013033704925`*^9, 
   3.8317013312815733`*^9}, {3.831701406870053*^9, 3.831701479619607*^9}, 
   3.831702376776008*^9, {3.831702481275221*^9, 3.831702483945857*^9}, {
   3.8317025887621565`*^9, 3.8317025903591995`*^9}, {3.8317027497648787`*^9, 
   3.831702800763775*^9}, {3.8317033970662265`*^9, 3.831703398700817*^9}, {
   3.8317035132347107`*^9, 3.8317035667713284`*^9}, 3.831703623390505*^9, {
   3.831703687980508*^9, 3.831703755108315*^9}, 3.8317040310380526`*^9, {
   3.831704503596468*^9, 3.8317045060547113`*^9}, {3.8317091510973673`*^9, 
   3.831709151348405*^9}, {3.831709700050008*^9, 3.8317097006454115`*^9}, {
   3.831709769465223*^9, 3.831709778053362*^9}, {3.8317155312170706`*^9, 
   3.8317155333119874`*^9}, {3.8317161114464207`*^9, 3.831716113460864*^9}, {
   3.8317165663062634`*^9, 3.831716601884225*^9}, {3.8317166341631827`*^9, 
   3.8317166662136497`*^9}, {3.831716698452117*^9, 3.8317168843813276`*^9}, {
   3.8317170307114677`*^9, 3.8317170337875433`*^9}, {3.8317171661180487`*^9, 
   3.8317171824213257`*^9}, 3.8317196038493547`*^9, {3.8317198439178524`*^9, 
   3.831719846461735*^9}, {3.831720090946414*^9, 3.831720107271838*^9}, {
   3.83180597103368*^9, 3.831805975131879*^9}, 3.8318066757759495`*^9, 
   3.831807160890427*^9, {3.831807535208869*^9, 3.83180753950561*^9}, 
   3.831816444761509*^9, {3.8318769075046463`*^9, 3.831876924351859*^9}, {
   3.8318769679894247`*^9, 3.831876969530199*^9}, 3.8318770753873186`*^9, {
   3.831877380489173*^9, 3.831877416462142*^9}, 3.8318776429750586`*^9, {
   3.831877724862707*^9, 3.831877724981058*^9}, 3.831877863831921*^9, {
   3.831877987522004*^9, 3.831877987771125*^9}, 3.8318780977397194`*^9, 
   3.831878680963387*^9, {3.831878755740961*^9, 3.831878755799967*^9}, 
   3.8318792938839674`*^9, {3.8318798792499523`*^9, 3.831879879727828*^9}, 
   3.8318918349459953`*^9, 3.831892122586246*^9, {3.8318924298905687`*^9, 
   3.831892429990985*^9}, 3.831893137371763*^9, {3.831893508108944*^9, 
   3.8318935086064987`*^9}, {3.8318977629378843`*^9, 3.831897763043951*^9}, 
   3.8319619837836237`*^9, {3.831962015095559*^9, 3.8319620211980247`*^9}, {
   3.832039708432623*^9, 3.832039771838543*^9}, {3.8320399649595394`*^9, 
   3.832039967207567*^9}, {3.8320400626702003`*^9, 3.832040090979965*^9}, {
   3.832040147331139*^9, 3.83204021589231*^9}, {3.8320404626864543`*^9, 
   3.83204047811031*^9}, {3.8320405304053903`*^9, 3.832040532371476*^9}, {
   3.8320406329553537`*^9, 3.832040639388233*^9}, {3.8320406794126854`*^9, 
   3.8320406815172057`*^9}, {3.8320415723932037`*^9, 
   3.8320417365714226`*^9}, {3.8320418581849036`*^9, 3.832041858268427*^9}, {
   3.8320419615836406`*^9, 3.83204197356218*^9}, {3.8320422023049603`*^9, 
   3.8320422244985046`*^9}, 3.832043217729306*^9, 3.832043405912733*^9, {
   3.83204354210608*^9, 3.832043544501052*^9}, {3.8320501159262037`*^9, 
   3.83205011599699*^9}, {3.8320877489160194`*^9, 3.8320877502980633`*^9}, 
   3.8320893687909594`*^9, {3.832089922644105*^9, 3.832089923021311*^9}, {
   3.8320920918539553`*^9, 3.832092092656397*^9}, {3.832147657024498*^9, 
   3.8321476779655695`*^9}, {3.832147862083398*^9, 3.83214786842303*^9}, {
   3.8322997317459273`*^9, 3.8322997436680493`*^9}, {3.8465775928712397`*^9, 
   3.846577745083552*^9}, {3.8465778557171717`*^9, 3.8465778577551675`*^9}, {
   3.8465786742558002`*^9, 3.84657868367164*^9}, {3.8465788410951853`*^9, 
   3.846578857194363*^9}, {3.846579500498774*^9, 3.846579534540459*^9}, {
   3.8465796324902325`*^9, 3.8465796355829167`*^9}, 3.8465797857096863`*^9, {
   3.8465846164448853`*^9, 3.846584616720894*^9}, {3.846590246345928*^9, 
   3.846590319449998*^9}, 3.846592329832641*^9, {3.84666532669689*^9, 
   3.846665336334193*^9}, {3.8467368598810167`*^9, 3.846736864703286*^9}, {
   3.846736905911895*^9, 3.8467370029116135`*^9}, {3.8467370345126*^9, 
   3.846737077193122*^9}, {3.8467371253042583`*^9, 3.8467371294255247`*^9}, {
   3.8467552673380394`*^9, 3.8467552736122336`*^9}, {3.8467553158993297`*^9, 
   3.84675535142774*^9}, {3.846755429772394*^9, 3.8467554331364737`*^9}, {
   3.84727712879815*^9, 3.8472772027147455`*^9}, {3.905496086461472*^9, 
   3.9054961090841694`*^9}, {3.927604261130409*^9, 3.927604263090679*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"e4ab114b-0457-4183-a0d4-44eac90f96b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostFunctionVesselnessFilteringExtReg2", "[", 
   RowBox[{
   "U_", ",", "\[Xi]_", ",", "\[Zeta]_", ",", "\[Sigma]s_", ",", "method_", 
    ",", 
    RowBox[{"\[Sigma]sExt_", ":", "0"}], ",", 
    RowBox[{"\[Sigma]aExt_", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cost", ",", "H", ",", "Q", ",", "S", ",", "R", ",", "B11", ",", "B22", 
      ",", "obj", ",", "oc", ",", 
      RowBox[{"\[Sigma]1", "=", "0.5"}], ",", "\[Sigma]2", ",", "Qgreater0", 
      ",", "M", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3", ",", 
      "c", ",", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"0.75", "/", "\[Sigma]s"}]}], ",", "Hess", ",", " ", "HTH"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"calculate", " ", "the", " ", "Hessian"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"obj", "=", 
      RowBox[{"ObjPositionOrientationData", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Data\>\"", "\[Rule]", "U"}], ",", 
         RowBox[{"\"\<Symmetry\>\"", "\[Rule]", 
          RowBox[{"2", "\[Pi]"}]}], ",", " ", 
         RowBox[{"\"\<Wavelets\>\"", "\[Rule]", " ", "None"}], ",", " ", 
         RowBox[{"\"\<InputData\>\"", "\[Rule]", " ", "None"}], ",", " ", 
         RowBox[{"\"\<DcFilteredImage\>\"", "\[Rule]", "0"}]}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{
       RowBox[{"OrientationScoreTensor", "[", 
        RowBox[{"obj", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0.5", "*", 
            SuperscriptBox["\[Sigma]s", "2"]}], ",", 
           RowBox[{"0.5", "*", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[Beta]", "*", "\[Sigma]s"}], ")"}], "2"]}]}], "}"}], 
         ",", "\"\<Hessian\>\""}], "]"}], "[", "\"\<Data\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"define", " ", "M"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"M", " ", "=", " ", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "\[Xi]"}], ",", 
         RowBox[{"\[Zeta]", "/", "\[Xi]"}], ",", "1"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Hess", "=", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"M", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ".", "M"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"Nx", ",", "Ny", ",", "No"}], "}"}]}], "]"}], "*", "H"}]}], 
     RowBox[{"(*", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"M", ".", "#", ".", "M"}], "&"}], ",", "H", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"HTH", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "#", "]"}], ".", "#"}], "&"}], ",", 
        "Hess", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Sigma]sExt", ",", "\[Sigma]aExt"}], "}"}], " ", "=!=", 
        " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HTH", "=", " ", 
         RowBox[{"LieAnalysis`Common`ExternalRegularization", "[", 
          RowBox[{"HTH", ",", " ", 
           RowBox[{"obj", "[", "\"\<FullOrientationList\>\"", "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]sExt", ",", "\[Sigma]aExt"}], "}"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Dimensions", "[", "HTH", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"Nx", ",", "Ny", ",", "No"}], "}"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"obtain", " ", "the", " ", "Hessian", " ", "field"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Determine", " ", "variables", " ", "depending", " ", "on", " ", "the", 
       " ", "method", " ", "that", " ", "is", " ", "considered"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"method", "==", "\"\<LIF\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Lambda]1", "=", 
         RowBox[{"Hess", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "All", ",", "1", ",", "1"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"Hess", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "All", ",", "2", ",", "2"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Q", "=", "c"}], ";"}], " ", 
       RowBox[{"(*", 
        RowBox[{"convexity", " ", "criterion"}], "*)"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]3", ",", "\[Lambda]2", ",", "\[Lambda]1"}], "}"}],
          "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Eigenvalues", "[", "#", "]"}], "&"}], ",", "HTH", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"0.5", "*", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]2", "+", "\[Lambda]3"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"Hess", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "All", ",", "2", ",", "2"}], 
          "\[RightDoubleBracket]"}]}]}]}], " ", 
      RowBox[{"(*", 
       RowBox[{"convexity", " ", "criterion"}], "*)"}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Determine", " ", "measures", " ", "that", " ", "are", " ", "used", " ",
        "when", " ", "calculating", " ", "the", " ", "vesselness"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{
       SuperscriptBox["\[Lambda]1", "2"], "+", 
       SuperscriptBox["c", "2"]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"structure", " ", "measure"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"\[Lambda]1", "/", "c"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"anisotropy", " ", "measure"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]2", "=", 
      RowBox[{"0.2", "*", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", "S", "]"}], "]"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", "S", "]"}], "]"}], " ", "ensures", " ", "that", 
       " ", "the", " ", "method", " ", "is", " ", "scaling", " ", 
       "invariant"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calculate", " ", "the", " ", "vesselness", " ", "at", " ", "ALL", " ", 
       "locations", " ", "and", " ", "orientations"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["R", "2"]}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SuperscriptBox["\[Sigma]1", "2"]}], ")"}]}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "S"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "\[Sigma]2"}], ")"}]}], "]"}]}], ")"}]}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Selection", " ", "criterion", " ", "on", " ", "convexity"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Qgreater0", "=", 
      RowBox[{"1", "-", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"-", "Q"}], "]"}]}]}], 
     RowBox[{"(*", 
      RowBox[{"Boole", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ">", "0"}], "&"}], ",", "Q", ",", 
         RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "*)"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Vesselness", " ", "at", " ", "locations", " ", "that", " ", "meet", 
       " ", "the", " ", "convexity", " ", "criterion"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{"cost", "*", "Qgreater0"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "cost", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.831700621055113*^9, 3.83170071527347*^9}, {
   3.831700747539089*^9, 3.8317007766656637`*^9}, {3.8317008204573913`*^9, 
   3.831700862001667*^9}, {3.831700892710336*^9, 3.831700970456744*^9}, {
   3.8317010154423776`*^9, 3.831701059479223*^9}, {3.8317013033704925`*^9, 
   3.8317013312815733`*^9}, {3.831701406870053*^9, 3.831701479619607*^9}, 
   3.831702376776008*^9, {3.831702481275221*^9, 3.831702483945857*^9}, {
   3.8317025887621565`*^9, 3.8317025903591995`*^9}, {3.8317027497648787`*^9, 
   3.831702800763775*^9}, {3.8317033970662265`*^9, 3.831703398700817*^9}, {
   3.8317035132347107`*^9, 3.8317035667713284`*^9}, 3.831703623390505*^9, {
   3.831703687980508*^9, 3.831703755108315*^9}, 3.8317040310380526`*^9, {
   3.831704503596468*^9, 3.8317045060547113`*^9}, {3.8317091510973673`*^9, 
   3.831709151348405*^9}, {3.831709700050008*^9, 3.8317097006454115`*^9}, {
   3.831709769465223*^9, 3.831709778053362*^9}, {3.8317155312170706`*^9, 
   3.8317155333119874`*^9}, {3.8317161114464207`*^9, 3.831716113460864*^9}, {
   3.8317165663062634`*^9, 3.831716601884225*^9}, {3.8317166341631827`*^9, 
   3.8317166662136497`*^9}, {3.831716698452117*^9, 3.8317168843813276`*^9}, {
   3.8317170307114677`*^9, 3.8317170337875433`*^9}, {3.8317171661180487`*^9, 
   3.8317171824213257`*^9}, 3.8317196038493547`*^9, {3.8317198439178524`*^9, 
   3.831719846461735*^9}, {3.831720090946414*^9, 3.831720107271838*^9}, {
   3.83180597103368*^9, 3.831805975131879*^9}, 3.8318066757759495`*^9, 
   3.831807160890427*^9, {3.831807535208869*^9, 3.83180753950561*^9}, 
   3.831816444761509*^9, {3.8318769075046463`*^9, 3.831876924351859*^9}, {
   3.8318769679894247`*^9, 3.831876969530199*^9}, 3.8318770753873186`*^9, {
   3.831877380489173*^9, 3.831877416462142*^9}, 3.8318776429750586`*^9, {
   3.831877724862707*^9, 3.831877724981058*^9}, 3.831877863831921*^9, {
   3.831877987522004*^9, 3.831877987771125*^9}, 3.8318780977397194`*^9, 
   3.831878680963387*^9, {3.831878755740961*^9, 3.831878755799967*^9}, 
   3.8318792938839674`*^9, {3.8318798792499523`*^9, 3.831879879727828*^9}, 
   3.8318918349459953`*^9, 3.831892122586246*^9, {3.8318924298905687`*^9, 
   3.831892429990985*^9}, 3.831893137371763*^9, {3.831893508108944*^9, 
   3.8318935086064987`*^9}, {3.8318977629378843`*^9, 3.831897763043951*^9}, 
   3.8319619837836237`*^9, {3.831962015095559*^9, 3.8319620211980247`*^9}, {
   3.832039708432623*^9, 3.832039771838543*^9}, {3.8320399649595394`*^9, 
   3.832039967207567*^9}, {3.8320400626702003`*^9, 3.832040090979965*^9}, {
   3.832040147331139*^9, 3.83204021589231*^9}, {3.8320404626864543`*^9, 
   3.83204047811031*^9}, {3.8320405304053903`*^9, 3.832040532371476*^9}, {
   3.8320406329553537`*^9, 3.832040639388233*^9}, {3.8320406794126854`*^9, 
   3.8320406815172057`*^9}, {3.8320415723932037`*^9, 
   3.8320417365714226`*^9}, {3.8320418581849036`*^9, 3.832041858268427*^9}, {
   3.8320419615836406`*^9, 3.83204197356218*^9}, {3.8320422023049603`*^9, 
   3.8320422244985046`*^9}, 3.832043217729306*^9, 3.832043405912733*^9, {
   3.83204354210608*^9, 3.832043544501052*^9}, {3.8320501159262037`*^9, 
   3.83205011599699*^9}, {3.8320877489160194`*^9, 3.8320877502980633`*^9}, 
   3.8320893687909594`*^9, {3.832089922644105*^9, 3.832089923021311*^9}, {
   3.8320920918539553`*^9, 3.832092092656397*^9}, {3.832147657024498*^9, 
   3.8321476779655695`*^9}, {3.832147862083398*^9, 3.83214786842303*^9}, {
   3.8322997317459273`*^9, 3.8322997436680493`*^9}, {3.8465775928712397`*^9, 
   3.846577745083552*^9}, {3.8465778557171717`*^9, 3.8465778577551675`*^9}, {
   3.8465786742558002`*^9, 3.84657868367164*^9}, {3.8465788410951853`*^9, 
   3.846578857194363*^9}, {3.846579500498774*^9, 3.846579534540459*^9}, {
   3.8465796324902325`*^9, 3.8465796355829167`*^9}, 3.8465797857096863`*^9, {
   3.8465846164448853`*^9, 3.846584616720894*^9}, {3.846590246345928*^9, 
   3.846590319449998*^9}, 3.846592329832641*^9, {3.84666532669689*^9, 
   3.846665336334193*^9}, {3.8467368598810167`*^9, 3.846736864703286*^9}, {
   3.846736905911895*^9, 3.8467370029116135`*^9}, {3.8467370345126*^9, 
   3.846737077193122*^9}, {3.8467371253042583`*^9, 3.8467371294255247`*^9}, {
   3.8467552673380394`*^9, 3.8467552736122336`*^9}, {3.8467553158993297`*^9, 
   3.84675535142774*^9}, {3.846755429772394*^9, 3.8467554331364737`*^9}, {
   3.84727712879815*^9, 3.8472772027147455`*^9}, {3.905496086461472*^9, 
   3.9054961090841694`*^9}, {3.9276039711326647`*^9, 3.927604064972455*^9}, {
   3.9276044142390966`*^9, 3.9276044810993137`*^9}, {3.927604797678545*^9, 
   3.9276048116494365`*^9}, {3.9276053675473843`*^9, 3.927605368300291*^9}, {
   3.9276055560440817`*^9, 3.927605588541387*^9}, {3.9276095741602025`*^9, 
   3.9276095873079762`*^9}, {3.9276102263860145`*^9, 3.927610245267482*^9}, {
   3.927610291986785*^9, 3.92761033862362*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"65e0e830-f568-4c71-b485-3d9de782c63e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiScaleVesselnessExtReg", "[", 
   RowBox[{
   "U_", ",", "Uboarder_", ",", "\[Xi]_", ",", "\[Zeta]_", ",", "\[Sigma]s_", 
    ",", "method_", ",", 
    RowBox[{"\[Sigma]sExt_", ":", "0"}], ",", 
    RowBox[{"\[Sigma]aExt_", ":", "0"}], ",", 
    RowBox[{"erosion_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vesselness", ",", "vesselnessBoarder", ",", "vesselnessfilterNoBoarder",
       ",", "vesselnessfilterNoBoarderErosion", ",", "newvesselnessfilter", 
      ",", 
      RowBox[{"vesselnessfilter", "=", 
       RowBox[{"{", "}"}]}], ",", "k", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "\[Sigma]s", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Select", " ", "the", " ", "spatial", " ", "scale", " ", "for", " ", 
         "the", " ", "specific", " ", "iteration"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"\[Sigma]s", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "of", " ", "the", 
          " ", "full", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselness", "=", 
         RowBox[{"CostFunctionVesselnessFilteringExtReg", "[", 
          RowBox[{
          "U", ",", "\[Xi]", ",", "\[Zeta]", ",", "k", ",", "method", ",", 
           "k", ",", "\[Sigma]aExt"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "of", " ", "the", 
          " ", "boarder", " ", "of", " ", "the", " ", "image"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"vesselnessBoarder", "=", 
         RowBox[{"CostFunctionVesselnessFilteringExtReg", "[", 
          RowBox[{
          "Uboarder", ",", "\[Xi]", ",", "\[Zeta]", ",", "k", ",", "method", 
           ",", "k", ",", "\[Sigma]aExt"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "without", " ", 
          "the", " ", "boarder"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselnessfilterNoBoarder", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"UnitStep", "[", 
             RowBox[{"vesselnessBoarder", "-", "0.0001"}], "]"}]}], ")"}], 
          "*", "vesselness"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Boole", "[", 
               RowBox[{"#", "<", "0.0001"}], "]"}], "&"}], ",", 
             "vesselnessBoarder", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], "*", "vesselness"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Add", " ", "erosion", " ", "to", " ", "the", " ", "cost", " ", 
           "function"}], " ", "\[Rule]", " ", 
          RowBox[{
          "erosion", " ", "of", " ", "broad", " ", "angular", " ", 
           "boundaries"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselnessfilterNoBoarderErosion", "=", 
         RowBox[{"Erosion", "[", 
          RowBox[{"vesselnessfilterNoBoarder", ",", 
           RowBox[{"erosion", "*", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}], "}"}]}], ",", 
           RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Cut", " ", "off", " ", "the", " ", "upper", " ", "boarder", " ", 
          "which", " ", "influences", " ", "the", " ", "vesselness"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vesselnessfilterNoBoarderErosion", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "5"}], "]"}], "]"}], "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "Ny", ",", "No"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Cut", " ", "off", " ", "the", " ", "lower", " ", "boarder", " ", 
          "which", " ", "influences", " ", "the", " ", "vesselness"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vesselnessfilterNoBoarderErosion", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "5"}], ";;"}], "]"}], "]"}], "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "Ny", ",", "No"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"vesselnessfilterNoBoarderErosion2", "=", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "\[GreaterEqual]", "6"}], "]"}], "*", "#1"}], "&"}], ",", 
             "vesselnessfilterNoBoarderErosion", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], 
         RowBox[{"(*", 
          RowBox[{"Cut", " ", "off", " ", "upper", " ", "boarder"}], "*)"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"(*", 
          RowBox[{
          "Create", " ", "mobility", " ", "function", " ", "only", " ", 
           "containing", " ", "lifts", " ", "at", " ", "bifurcations"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"liftElevators", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"No", ",", "Nx", ",", "Ny"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"liftElevators", "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"ySelect", ",", "0"}], "}"}]}], ")"}]}]}], 
                  "\[RightDoubleBracket]"}], "=", "1"}], ";"}], "&"}], ",", 
              "seedsIndex"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"liftElevators", "=", 
             RowBox[{"GaussianFilter", "[", 
              RowBox[{"liftElevators", ",", "1.5"}], "]"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Combine", " ", "both", " ", "mobility", " ", "functions"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"newvesselnessfilter", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{
                  "Rescale", "[", "vesselnessfilterNoBoarderErosion2", 
                   "]"}]}], ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"Rescale", "[", "liftElevators", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "new", " ", "vesselness", " ", "to", " ", "the", " ", 
          "array", " ", "containing", " ", "vesselness", " ", "filters", " ", 
          "for", " ", "all", " ", "different", " ", "values", " ", "of", " ", 
          "\[Sigma]s"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "newvesselnessfilter", "=", "vesselnessfilterNoBoarderErosion"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"vesselnessfilter", ",", "newvesselnessfilter"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"vesselnessfilter", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"vesselnessfilter", ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "vesselnessfilter", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.846069290478445*^9, 3.846069320848277*^9}, {
   3.846069388578823*^9, 3.8460694136426706`*^9}, {3.8460698943625517`*^9, 
   3.8460699961806927`*^9}, {3.8460700607895765`*^9, 3.846070370519379*^9}, {
   3.8460704370347395`*^9, 3.846070455399172*^9}, {3.8460705633723164`*^9, 
   3.846070607320956*^9}, {3.8461357617580004`*^9, 3.84613576321036*^9}, {
   3.8461371780315437`*^9, 3.8461371794824996`*^9}, {3.846578893545618*^9, 
   3.8465789371578035`*^9}, {3.846579069704646*^9, 3.8465790701274323`*^9}, {
   3.846737145534981*^9, 3.846737164629548*^9}, {3.846755598107308*^9, 
   3.8467556087354326`*^9}, {3.846759888042096*^9, 3.846759896286005*^9}, {
   3.8467599385553436`*^9, 3.8467599421542425`*^9}, {3.8467604834169755`*^9, 
   3.8467604851386766`*^9}, {3.8467609263246174`*^9, 3.846760926478567*^9}, {
   3.846761476147117*^9, 3.8467614789751863`*^9}, {3.8468387665957375`*^9, 
   3.8468387816980734`*^9}, {3.8468427788829308`*^9, 
   3.8468427790168743`*^9}, {3.847277220387966*^9, 3.8472773673148804`*^9}, {
   3.8477898596589794`*^9, 3.847789876833465*^9}, {3.8478563017751393`*^9, 
   3.8478563188662643`*^9}, {3.8479662286057787`*^9, 3.847966240197607*^9}, {
   3.8479664567407155`*^9, 3.847966457909107*^9}, {3.847967542490487*^9, 
   3.8479675639557314`*^9}, {3.848039855485445*^9, 3.848039859594449*^9}, 
   3.848120190541051*^9, {3.9054959362666745`*^9, 3.9054959560897274`*^9}, {
   3.9054975650941095`*^9, 3.9054975678243*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"bf566bfa-53e3-4131-9fbd-16b8c7b203b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiScaleVesselnessExtReg2", "[", 
   RowBox[{
   "U_", ",", "Uboarder_", ",", "\[Xi]_", ",", "\[Zeta]_", ",", "\[Sigma]s_", 
    ",", "method_", ",", 
    RowBox[{"\[Sigma]sExt_", ":", "0"}], ",", 
    RowBox[{"\[Sigma]aExt_", ":", "0"}], ",", 
    RowBox[{"erosion_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vesselness", ",", "vesselnessBoarder", ",", "vesselnessfilterNoBoarder",
       ",", "vesselnessfilterNoBoarderErosion", ",", "newvesselnessfilter", 
      ",", 
      RowBox[{"vesselnessfilter", "=", 
       RowBox[{"{", "}"}]}], ",", "k", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "\[Sigma]s", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Select", " ", "the", " ", "spatial", " ", "scale", " ", "for", " ", 
         "the", " ", "specific", " ", "iteration"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"\[Sigma]s", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "of", " ", "the", 
          " ", "full", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselness", "=", 
         RowBox[{"CostFunctionVesselnessFilteringExtReg2", "[", 
          RowBox[{
          "U", ",", "\[Xi]", ",", "\[Zeta]", ",", "k", ",", "method", ",", 
           "k", ",", "\[Sigma]aExt"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "of", " ", "the", 
          " ", "boarder", " ", "of", " ", "the", " ", "image"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"vesselnessBoarder", "=", 
         RowBox[{"CostFunctionVesselnessFilteringExtReg", "[", 
          RowBox[{
          "Uboarder", ",", "\[Xi]", ",", "\[Zeta]", ",", "k", ",", "method", 
           ",", "k", ",", "\[Sigma]aExt"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "without", " ", 
          "the", " ", "boarder"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselnessfilterNoBoarder", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"UnitStep", "[", 
             RowBox[{"vesselnessBoarder", "-", "0.0001"}], "]"}]}], ")"}], 
          "*", "vesselness"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Boole", "[", 
               RowBox[{"#", "<", "0.0001"}], "]"}], "&"}], ",", 
             "vesselnessBoarder", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], "*", "vesselness"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Add", " ", "erosion", " ", "to", " ", "the", " ", "cost", " ", 
           "function"}], " ", "\[Rule]", " ", 
          RowBox[{
          "erosion", " ", "of", " ", "broad", " ", "angular", " ", 
           "boundaries"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselnessfilterNoBoarderErosion", "=", 
         RowBox[{"Erosion", "[", 
          RowBox[{"vesselnessfilterNoBoarder", ",", 
           RowBox[{"erosion", "*", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}], "}"}]}], ",", 
           RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Cut", " ", "off", " ", "the", " ", "upper", " ", "boarder", " ", 
          "which", " ", "influences", " ", "the", " ", "vesselness"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vesselnessfilterNoBoarderErosion", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "5"}], "]"}], "]"}], "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "Ny", ",", "No"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Cut", " ", "off", " ", "the", " ", "lower", " ", "boarder", " ", 
          "which", " ", "influences", " ", "the", " ", "vesselness"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vesselnessfilterNoBoarderErosion", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "5"}], ";;"}], "]"}], "]"}], "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "Ny", ",", "No"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"vesselnessfilterNoBoarderErosion2", "=", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "\[GreaterEqual]", "6"}], "]"}], "*", "#1"}], "&"}], ",", 
             "vesselnessfilterNoBoarderErosion", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], 
         RowBox[{"(*", 
          RowBox[{"Cut", " ", "off", " ", "upper", " ", "boarder"}], "*)"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"(*", 
          RowBox[{
          "Create", " ", "mobility", " ", "function", " ", "only", " ", 
           "containing", " ", "lifts", " ", "at", " ", "bifurcations"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"liftElevators", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"No", ",", "Nx", ",", "Ny"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"liftElevators", "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"ySelect", ",", "0"}], "}"}]}], ")"}]}]}], 
                  "\[RightDoubleBracket]"}], "=", "1"}], ";"}], "&"}], ",", 
              "seedsIndex"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"liftElevators", "=", 
             RowBox[{"GaussianFilter", "[", 
              RowBox[{"liftElevators", ",", "1.5"}], "]"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Combine", " ", "both", " ", "mobility", " ", "functions"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"newvesselnessfilter", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{
                  "Rescale", "[", "vesselnessfilterNoBoarderErosion2", 
                   "]"}]}], ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"Rescale", "[", "liftElevators", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "new", " ", "vesselness", " ", "to", " ", "the", " ", 
          "array", " ", "containing", " ", "vesselness", " ", "filters", " ", 
          "for", " ", "all", " ", "different", " ", "values", " ", "of", " ", 
          "\[Sigma]s"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "newvesselnessfilter", "=", "vesselnessfilterNoBoarderErosion"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"vesselnessfilter", ",", "newvesselnessfilter"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"vesselnessfilter", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"vesselnessfilter", ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "vesselnessfilter", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.846069290478445*^9, 3.846069320848277*^9}, {
   3.846069388578823*^9, 3.8460694136426706`*^9}, {3.8460698943625517`*^9, 
   3.8460699961806927`*^9}, {3.8460700607895765`*^9, 3.846070370519379*^9}, {
   3.8460704370347395`*^9, 3.846070455399172*^9}, {3.8460705633723164`*^9, 
   3.846070607320956*^9}, {3.8461357617580004`*^9, 3.84613576321036*^9}, {
   3.8461371780315437`*^9, 3.8461371794824996`*^9}, {3.846578893545618*^9, 
   3.8465789371578035`*^9}, {3.846579069704646*^9, 3.8465790701274323`*^9}, {
   3.846737145534981*^9, 3.846737164629548*^9}, {3.846755598107308*^9, 
   3.8467556087354326`*^9}, {3.846759888042096*^9, 3.846759896286005*^9}, {
   3.8467599385553436`*^9, 3.8467599421542425`*^9}, {3.8467604834169755`*^9, 
   3.8467604851386766`*^9}, {3.8467609263246174`*^9, 3.846760926478567*^9}, {
   3.846761476147117*^9, 3.8467614789751863`*^9}, {3.8468387665957375`*^9, 
   3.8468387816980734`*^9}, {3.8468427788829308`*^9, 
   3.8468427790168743`*^9}, {3.847277220387966*^9, 3.8472773673148804`*^9}, {
   3.8477898596589794`*^9, 3.847789876833465*^9}, {3.8478563017751393`*^9, 
   3.8478563188662643`*^9}, {3.8479662286057787`*^9, 3.847966240197607*^9}, {
   3.8479664567407155`*^9, 3.847966457909107*^9}, {3.847967542490487*^9, 
   3.8479675639557314`*^9}, {3.848039855485445*^9, 3.848039859594449*^9}, 
   3.848120190541051*^9, {3.9054959362666745`*^9, 3.9054959560897274`*^9}, {
   3.9054975650941095`*^9, 3.9054975678243*^9}, {3.9276048375295362`*^9, 
   3.927604841247712*^9}, 3.9276121965947943`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"57e8162f-8cf3-4b50-9305-3a25c892b4df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiScaleVesselnessExtRegErosion0", "[", 
   RowBox[{
   "U_", ",", "Uboarder_", ",", "\[Xi]_", ",", "\[Zeta]_", ",", "\[Sigma]s_", 
    ",", "method_", ",", 
    RowBox[{"\[Sigma]sExt_", ":", "0"}], ",", 
    RowBox[{"\[Sigma]aExt_", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vesselness", ",", "vesselnessBoarder", ",", "vesselnessfilterNoBoarder",
       ",", "vesselnessfilterNoBoarderErosion", ",", "newvesselnessfilter", 
      ",", 
      RowBox[{"vesselnessfilter", "=", 
       RowBox[{"{", "}"}]}], ",", "k", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "\[Sigma]s", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Select", " ", "the", " ", "spatial", " ", "scale", " ", "for", " ", 
         "the", " ", "specific", " ", "iteration"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"\[Sigma]s", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "of", " ", "the", 
          " ", "full", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselness", "=", 
         RowBox[{"CostFunctionVesselnessFilteringExtReg", "[", 
          RowBox[{
          "U", ",", "\[Xi]", ",", "\[Zeta]", ",", "k", ",", "method", ",", 
           "k", ",", "\[Sigma]aExt"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "of", " ", "the", 
          " ", "boarder", " ", "of", " ", "the", " ", "image"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"vesselnessBoarder", "=", 
         RowBox[{"CostFunctionVesselnessFilteringExtReg", "[", 
          RowBox[{
          "Uboarder", ",", "\[Xi]", ",", "\[Zeta]", ",", "k", ",", "method", 
           ",", "\[Sigma]sExt", ",", "\[Sigma]aExt"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "without", " ", 
          "the", " ", "boarder"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselnessfilterNoBoarder", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"UnitStep", "[", 
             RowBox[{"vesselnessBoarder", "-", "0.0001"}], "]"}]}], ")"}], 
          "*", "vesselness"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Boole", "[", 
               RowBox[{"#", "<", "0.0001"}], "]"}], "&"}], ",", 
             "vesselnessBoarder", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], "*", "vesselness"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Add", " ", "erosion", " ", "to", " ", "the", " ", "cost", " ", 
           "function"}], " ", "\[Rule]", " ", 
          RowBox[{
          "erosion", " ", "of", " ", "broad", " ", "angular", " ", 
           "boundaries"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "vesselnessfilterNoBoarderErosion", "=", 
         "vesselnessfilterNoBoarder"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Cut", " ", "off", " ", "the", " ", "upper", " ", "boarder", " ", 
          "which", " ", "influences", " ", "the", " ", "vesselness"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vesselnessfilterNoBoarderErosion", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "5"}], "]"}], "]"}], "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "Ny", ",", "No"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Cut", " ", "off", " ", "the", " ", "lower", " ", "boarder", " ", 
          "which", " ", "influences", " ", "the", " ", "vesselness"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vesselnessfilterNoBoarderErosion", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "5"}], ";;"}], "]"}], "]"}], "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "Ny", ",", "No"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"vesselnessfilterNoBoarderErosion2", "=", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "\[GreaterEqual]", "6"}], "]"}], "*", "#1"}], "&"}], ",", 
             "vesselnessfilterNoBoarderErosion", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], 
         RowBox[{"(*", 
          RowBox[{"Cut", " ", "off", " ", "upper", " ", "boarder"}], "*)"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"(*", 
          RowBox[{
          "Create", " ", "mobility", " ", "function", " ", "only", " ", 
           "containing", " ", "lifts", " ", "at", " ", "bifurcations"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"liftElevators", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"No", ",", "Nx", ",", "Ny"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"liftElevators", "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"ySelect", ",", "0"}], "}"}]}], ")"}]}]}], 
                  "\[RightDoubleBracket]"}], "=", "1"}], ";"}], "&"}], ",", 
              "seedsIndex"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"liftElevators", "=", 
             RowBox[{"GaussianFilter", "[", 
              RowBox[{"liftElevators", ",", "1.5"}], "]"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Combine", " ", "both", " ", "mobility", " ", "functions"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"newvesselnessfilter", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{
                  "Rescale", "[", "vesselnessfilterNoBoarderErosion2", 
                   "]"}]}], ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"Rescale", "[", "liftElevators", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "new", " ", "vesselness", " ", "to", " ", "the", " ", 
          "array", " ", "containing", " ", "vesselness", " ", "filters", " ", 
          "for", " ", "all", " ", "different", " ", "values", " ", "of", " ", 
          "\[Sigma]s"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "newvesselnessfilter", "=", "vesselnessfilterNoBoarderErosion"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"vesselnessfilter", ",", "newvesselnessfilter"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"vesselnessfilter", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"vesselnessfilter", ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "vesselnessfilter", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxTtIQlEYAGATEQqHzPKSWRBl0BSRhJBSpzTaNIkeIiRGomZcFxvDIaHE
wsqCHAxReuhUmogOld0k0jBoM8SlGuxGCA3R1PnP8PF1m2n9MpfD4Ugw2KHV
egqnLBLLOrbgtGdvF875kwGYHyw8w8oHTwUeVh+9w7chnaCIP5SGW2FenhWT
ayu98KSm1g97keLvE6/JWshWLoqz+IiTJiddFwvMGYsyAtkivOZL0fCXiCH7
uwaPhecsGpcFwrCQvgtL8LFNKgKX5xsyUvxPX2MWNt1P38A73wy5MrfK68Q3
OaNk9dLjCOzQlcgDVxtuOCOvkqeaX1QT+NBsahT+HTMOafBKr4mssPtm2mMs
cotqFtgodkVFcRZdx4MncP0p3SbHO9OvFOw17+ds+KKez8D1BFWFrZSK3HJZ
stjxhoN1GxzsySe28W+GjyT8D7uY3Fk=
  "],
 CellLabel->"In[19]:=",ExpressionUUID->"701ac80d-0526-4a5d-9504-385ea3956621"]
}, Closed]],

Cell[CellGroupData[{

Cell["External Regularization - No boarder", "Subsection",
 CellChangeTimes->{{3.846736828118457*^9, 3.8467368336747875`*^9}, {
  3.847354136324772*^9, 
  3.847354138393787*^9}},ExpressionUUID->"d8f97c37-c04e-46b7-9fa2-\
6d972ebe7fc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiScaleVesselnessExtRegNoBoarder", "[", 
   RowBox[{
   "U_", ",", "\[Xi]_", ",", "\[Zeta]_", ",", "\[Sigma]s_", ",", "method_", 
    ",", 
    RowBox[{"\[Sigma]sExt_", ":", "0"}], ",", 
    RowBox[{"\[Sigma]aExt_", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vesselness", ",", "vesselnessBoarder", ",", "vesselnessfilterNoBoarder",
       ",", "vesselnessfilterNoBoarderErosion", ",", "newvesselnessfilter", 
      ",", 
      RowBox[{"vesselnessfilter", "=", 
       RowBox[{"{", "}"}]}], ",", "k", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "\[Sigma]s", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Select", " ", "the", " ", "spatial", " ", "scale", " ", "for", " ", 
         "the", " ", "specific", " ", "iteration"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"\[Sigma]s", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Calculate", " ", "the", " ", "vesselness", " ", "of", " ", "the", 
          " ", "full", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselness", "=", 
         RowBox[{"CostFunctionVesselnessFilteringExtReg", "[", 
          RowBox[{
          "U", ",", "\[Xi]", ",", "\[Zeta]", ",", "k", ",", "method", ",", 
           "k", ",", "\[Sigma]aExt"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Add", " ", "erosion", " ", "to", " ", "the", " ", "cost", " ", 
           "function"}], " ", "\[Rule]", " ", 
          RowBox[{
          "erosion", " ", "of", " ", "broad", " ", "angular", " ", 
           "boundaries"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vesselness", "=", 
         RowBox[{"Erosion", "[", 
          RowBox[{"vesselness", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}], "}"}], ",", 
           RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Erosion", "[", 
              RowBox[{"#", ",", 
               RowBox[{"(*", "0.5", "*)"}], "1", ",", 
               RowBox[{"Padding", "\[Rule]", "\"\<Periodic\>\""}]}], "]"}], 
             "&"}], ",", "vesselnessfilterNoBoarder", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ";"}], "*)"}], " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"(*", 
          RowBox[{
          "Create", " ", "mobility", " ", "function", " ", "only", " ", 
           "containing", " ", "lifts", " ", "at", " ", "bifurcations"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"liftElevators", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"No", ",", "Nx", ",", "Ny"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"liftElevators", "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"ySelect", ",", "0"}], "}"}]}], ")"}]}]}], 
                  "\[RightDoubleBracket]"}], "=", "1"}], ";"}], "&"}], ",", 
              "seedsIndex"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"liftElevators", "=", 
             RowBox[{"GaussianFilter", "[", 
              RowBox[{"liftElevators", ",", "1.5"}], "]"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Combine", " ", "both", " ", "mobility", " ", "functions"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"newvesselnessfilter", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{
                  "Rescale", "[", "vesselnessfilterNoBoarderErosion2", 
                   "]"}]}], ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"Rescale", "[", "liftElevators", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "new", " ", "vesselness", " ", "to", " ", "the", " ", 
          "array", " ", "containing", " ", "vesselness", " ", "filters", " ", 
          "for", " ", "all", " ", "different", " ", "values", " ", "of", " ", 
          "\[Sigma]s"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newvesselnessfilter", "=", "vesselness"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"vesselnessfilter", ",", "newvesselnessfilter"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"vesselnessfilter", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"vesselnessfilter", ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "vesselnessfilter", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.846069290478445*^9, 3.846069320848277*^9}, {
   3.846069388578823*^9, 3.8460694136426706`*^9}, {3.8460698943625517`*^9, 
   3.8460699961806927`*^9}, {3.8460700607895765`*^9, 3.846070370519379*^9}, {
   3.8460704370347395`*^9, 3.846070455399172*^9}, {3.8460705633723164`*^9, 
   3.846070607320956*^9}, {3.8461357617580004`*^9, 3.84613576321036*^9}, {
   3.8461371780315437`*^9, 3.8461371794824996`*^9}, {3.846578893545618*^9, 
   3.8465789371578035`*^9}, {3.846579069704646*^9, 3.8465790701274323`*^9}, {
   3.846737145534981*^9, 3.846737164629548*^9}, {3.846755598107308*^9, 
   3.8467556087354326`*^9}, {3.846759888042096*^9, 3.846759896286005*^9}, {
   3.8467599385553436`*^9, 3.8467599421542425`*^9}, {3.8467604834169755`*^9, 
   3.8467604851386766`*^9}, {3.8467609263246174`*^9, 3.846760926478567*^9}, {
   3.846761476147117*^9, 3.8467614789751863`*^9}, {3.8468387665957375`*^9, 
   3.8468387816980734`*^9}, {3.8468427788829308`*^9, 
   3.8468427790168743`*^9}, {3.847277220387966*^9, 3.8472773673148804`*^9}, {
   3.8473541629695444`*^9, 3.847354195249935*^9}, 3.848040834461649*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"7d410c18-dc97-4e07-9207-eee81814a759"]
}, Closed]],

Cell[CellGroupData[{

Cell["Add lifts to cost function", "Subsection",
 CellChangeTimes->{{3.8468394957920785`*^9, 3.846839497832074*^9}, {
  3.8713756985233936`*^9, 
  3.8713757007370853`*^9}},ExpressionUUID->"9c822d5e-81fa-450c-9fab-\
f7096b357395"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddLifts", "[", 
   RowBox[{"vesselness_", ",", "seedsIndex_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"liftElevators", ",", "newvesselnessfilter"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"liftElevators", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"No", ",", "Nx", ",", "Ny"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"liftElevators", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", "#", ")"}]}]}], "\[RightDoubleBracket]"}], "=", 
          "1"}], ";"}], "&"}], ",", "seedsIndex"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"liftElevators", "=", 
      RowBox[{"GaussianFilter", "[", 
       RowBox[{"liftElevators", ",", "1.5"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Combine", " ", "both", " ", "mobility", " ", "functions"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newvesselnessfilter", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"4", "*", 
             RowBox[{"Rescale", "[", "vesselness", "]"}]}], ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"Rescale", "[", "liftElevators", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newvesselnessfilter", "=", 
      RowBox[{"newvesselnessfilter", "/", 
       RowBox[{"Max", "[", "newvesselnessfilter", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "newvesselnessfilter", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8468394992372694`*^9, 3.8468396468033724`*^9}, 
   3.846841208450967*^9, {3.8468420895555043`*^9, 3.846842089834281*^9}, 
   3.8468423468577747`*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"c3cc28ea-24c2-4fee-b90d-4395efb15945"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rescaling cost function", "Subsection",
 CellChangeTimes->{{3.8479447175456133`*^9, 
  3.8479447288831964`*^9}},ExpressionUUID->"a95c6130-72fd-4a92-9df7-\
ebca3ed64023"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostFunction2", "[", 
   RowBox[{"oc_", ",", 
    RowBox[{"{", 
     RowBox[{"g0_", ",", "g1_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cost", ",", "ocg0", ",", "ocg1", ",", "ocg"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ocg0", "=", 
      RowBox[{"oc", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"g0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"g0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
        "g0", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ocg1", "=", 
      RowBox[{"oc", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"g1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"g1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
        "g1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ocg", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"ocg1", ",", "ocg0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"ocg", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ocg0", "+", "ocg1"}], ")"}], "/", "2"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"Ramp", "[", 
         RowBox[{"oc", "-", "ocg"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "cost", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"b3e0461f-bcd2-4551-a1a9-1adb1f6a4f75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToContinuousAngle", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "\[Theta]d_"}], "}"}], ",", "s\[Theta]_"}],
    "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Theta]d", "-", "1"}], ")"}], "s\[Theta]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToDiscreteAngle", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "\[Theta]c_"}], "}"}], ",", "s\[Theta]_"}],
    "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y", ",", 
    RowBox[{
     RowBox[{"\[Theta]c", "/", "s\[Theta]"}], "+", "1"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.797068872444806*^9, 3.7970689682551284`*^9}, {
  3.8477709300985203`*^9, 3.847770931063661*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"15ead49b-71f9-4088-9076-e8f56b73b4a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddObstaclesCrossings", "[", 
   RowBox[{
   "cost_", ",", "obstacleCenter_", ",", "obstacleWidth_", ",", 
    "obstacleHeight_", ",", "Nx_", ",", 
    RowBox[{"scaling_", ":", "10"}], ",", 
    RowBox[{"grayValueCriteria_", ":", ".8"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newcost", ",", "xmin", ",", "xmax", ",", "ymin", ",", "ymax", ",", 
      "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newcost", "=", "cost"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "obstacleCenter", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xmin", "=", 
         RowBox[{"Round", "[", 
          RowBox[{"Nx", "-", 
           RowBox[{"obstacleCenter", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
           RowBox[{"obstacleHeight", "/", "2"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xmax", "=", 
         RowBox[{"Round", "[", 
          RowBox[{"Nx", "-", 
           RowBox[{"obstacleCenter", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"obstacleHeight", "/", "2"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ymin", "=", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"obstacleCenter", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
           RowBox[{"obstacleWidth", "/", "2"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ymax", "=", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"obstacleCenter", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"obstacleWidth", "/", "2"}]}], "]"}]}], ";", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"{", 
            RowBox[{"xmin", ",", "xmax", ",", "ymin", ",", "ymax"}], "}"}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newcost", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"xmin", ";;", "xmax"}], ",", 
            RowBox[{"ymin", ";;", "ymax"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Clip", "[", 
             RowBox[{
              RowBox[{"cost", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"xmin", ";;", "xmax"}], ",", 
                 RowBox[{"ymin", ";;", "ymax"}]}], "]"}], "]"}], "/", 
              "grayValueCriteria"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"x_", "/;", 
              RowBox[{"x", "==", "1"}]}], "\[Rule]", "scaling"}]}], ")"}], 
          "*", "grayValueCriteria"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "newcost", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8582335225335665`*^9, 3.8582336216298285`*^9}, {
   3.8582336542935967`*^9, 3.858233744879365*^9}, {3.858233940013635*^9, 
   3.8582340294253044`*^9}, {3.8582341334636493`*^9, 3.858234139214013*^9}, {
   3.85823429485408*^9, 3.8582343147253714`*^9}, {3.8582343796541233`*^9, 
   3.8582344290743575`*^9}, 3.8582350510146756`*^9, {3.858235273535246*^9, 
   3.858235286184969*^9}, {3.8582356842557554`*^9, 3.8582356860655136`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"afe599e2-5340-4632-9a19-d301a3d41ac9"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Orientation Score transform", "Section",
 CellChangeTimes->{{3.6361799360061083`*^9, 
  3.636179938720508*^9}},ExpressionUUID->"eecdece1-910f-44e4-9306-\
eba9d653b292"],

Cell[CellGroupData[{

Cell["Orientation score transform", "Subsection",
 CellChangeTimes->{{3.6283308046688805`*^9, 3.6283308128694572`*^9}, {
  3.669950051521691*^9, 
  3.669950082508013*^9}},ExpressionUUID->"f6b16b30-d579-4b8b-b932-\
7b197d5d0218"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CakeWaveletStack", "::", "usage"}], "=", 
    "\"\<CakeWaveletStack[size,s\[CurlyPhi]] returns the set \n\tof rotated \
wavelets with standard paramters (see Options[CakeWaveletStack]).\n\tThe \
kernel stack has dimensions No x size x size, where No = \
\\!\\(\\*FractionBox[\\(s\[CurlyPhi]\\), \\(periodicity\\)]\\). \n\tBy \
default periodicity = \[Pi], meaning that the wavelets are constructed \n\t\
from 0 to \[Pi]. Parameter s\[CurlyPhi] specifies the angular resolution: \n\t\
the number of kernels per \[Pi] radians. \n\nOther parameters can be adjusted \
through the options or by calling the function \n\tas follows:\n \n\
CakeWaveletStack[size,s\[CurlyPhi],kSpline,q,periodicity,\[Rho]Inflection,kMn,\
\[Sigma]s,matrixCoordinatesQ].\>\""}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaborWaveletStack", "::", "usage"}], "=", 
    "\"\<GaborWaveletStack[a,s\[CurlyPhi]] returns the set \n\tof rotated \
Gabor wavelets at scale a, with standard paramters (see \
Options[GaborWaveletStack]).\n\tThe kernel stack has dimensions No x size x \
size, where No = \\!\\(\\*FractionBox[\\(s\[CurlyPhi]\\), \
\\(periodicity\\)]\\),\n\tand where size = 8*a*Sqrt[\[Epsilon]]. By default \
periodicity = \[Pi], meaning that \n\tthe wavelets are constructed from 0 to \
\[Pi]. Parameter s\[CurlyPhi] specifies \n\tthe angular resolution: the \
number of kernels per \[Pi] radians.\>\""}], ";"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WaveletTransform2DErik", "::", "usage"}], "=", 
    "\"\<WaveletTransform2DErik[kernelStack,im] correlates each \n\tkernel \
with the image. If the kernel dimensions and image dimensions \n\tcoincide, \
correlation is done using (conjugate) Fourier multiplication, else\n\t it is \
done using correlation.\>\""}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrientationScoreTransform", "::", "usage"}], "=", 
    "\"\<OrientationScoreTransform[image, s\[CurlyPhi]] \n\tconstructs an \
orientation score from the image using cake wavelets with \n\tdefault \
paramters (see Options[OrientationScoreTransform] and \n\t?CakeWaveletStack). \
By default this is done through Fourier domain \n\tmultiplication, unless it \
is specified (by using the options) otherwise.\>\""}], ";"}], 
  "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", "******************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "Begin"}], " ", "Private"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", "**********************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**"}], "*", 
    "CakeWaveletStack", " ", "Private", " ", "Functions"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "PolarCoordinateGridRadial", " ", "returns", " ", "a", " ", "matrix", " ", 
    "in", " ", "which", " ", "each", " ", "element", " ", "gives", " ", "the",
     " ", "corresponding", " ", "radial", " ", "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "with", " ", "the", " ", "origin", " ", "in", " ", "the", " ", "center", 
      " ", "of", " ", "the", " ", "matrix"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolarCoordinateGridRadial", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"size", ",", "_Integer"}], "}"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"x", "^", "2"}], "+", 
          RowBox[{"y", "^", "2"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "table"}], "*)"}], "\[IndentingNewLine]",
      "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"End", " ", "of", " ", "compile"}], "*)"}], "\[IndentingNewLine]", 
  "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "PolarCoordinateGridRadial", " ", "returns", " ", "a", " ", "matrix", " ", 
    "in", " ", "which", " ", "each", " ", "element", " ", "gives", " ", "the",
     " ", "corresponding", " ", "radial", " ", "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "with", " ", "the", " ", "origin", " ", "in", " ", "the", " ", "center", 
      " ", "of", " ", "the", " ", "matrix"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolarCoordinateGridAngular", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"size", ",", "_Integer"}], "}"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Arg", "[", 
         RowBox[{"x", "+", 
          RowBox[{"I", " ", "y"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "table"}], "*)"}], "\[IndentingNewLine]",
      "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"End", " ", "of", " ", "compile"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "MnWindow", " ", "gives", " ", "the", " ", "radial", " ", "windowing", " ",
     "matrix", " ", "for", " ", "sampling", " ", "the", " ", "fourier", " ", 
    "domain"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MnWindow", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"size", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Rho]inflection", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "{", "\[IndentingNewLine]", "\[Rho]Matrix", "\[IndentingNewLine]", 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Rho]Matrix", "=", 
          RowBox[{"$MachineEpsilon", "+", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "*", 
                 RowBox[{"\[Rho]inflection", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"2", " ", "n"}]}], ")"}]}], "]"}]}], " ", 
            RowBox[{"PolarCoordinateGridRadial", "[", "size", "]"}]}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Total", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"E", "^", 
              RowBox[{"-", 
               RowBox[{"\[Rho]Matrix", "^", "2"}]}]}], "*", 
             RowBox[{
              RowBox[{"\[Rho]Matrix", "^", 
               RowBox[{"(", 
                RowBox[{"2", "k"}], ")"}]}], "/", 
              RowBox[{"k", "!"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", 
       RowBox[{"End", " ", "of", " ", "Module"}], "*)"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k", "!"}], ",", "_Real"}], "}"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"End", " ", "of", " ", "compile"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "BSplineScalarFunc", " ", "is", " ", "a", " ", "compile", " ", "spline", 
     " ", "basis", " ", "function", " ", "of", " ", "arbitrary", " ", 
     RowBox[{"order", ".", "The"}], " ", "function", " ", "is", " ", 
     "defined", " ", "for", " ", "scalars"}], ",", 
    RowBox[{
    "list", " ", "and", " ", "2", "D", " ", "matrix", " ", "objects"}]}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BSplineScalarFunc", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"function", ",", "\[IndentingNewLine]", "intervalCheck"}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"function", "=", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"2", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1", "-", "1"}], ")"}], "!"}]}], ")"}]}],
               " ", 
              RowBox[{"Total", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Binomial", "[", 
                   RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                    ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}]}], " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "k"}], " ", 
                  RowBox[{"Sign", "[", 
                   RowBox[{"i", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                   "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "0", ",", 
                   RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"intervalCheck", "=", 
             RowBox[{"Round", "[", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1", "-", "1"}], ")"}], "/", "2"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"x", "-", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], ")"}]}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"x", "-", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}], "-", "$MachineEpsilon"}], 
                    ")"}]}], ")"}]}], "]"}]}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"function", "*", "intervalCheck"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "n", "-", "1"}], ")"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1", "+", "1"}], ")"}], "/", "2"}]}], 
            "}"}]}], "\[IndentingNewLine]", "]"}], 
         RowBox[{"(*", 
          RowBox[{"End", " ", "of", " ", "Table"}], "*)"}], 
         "\[IndentingNewLine]", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{"End", " ", "of", " ", "Total"}], "*)"}], 
       "\[IndentingNewLine]", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "Module"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"End", " ", "of", " ", "Compile"}], "*)"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BSplineListFunc", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"function", ",", "\[IndentingNewLine]", "intervalCheck"}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"function", "=", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"2", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1", "-", "1"}], ")"}], "!"}]}], ")"}]}],
               " ", 
              RowBox[{"Total", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Binomial", "[", 
                   RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                    ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}]}], " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "k"}], " ", 
                  RowBox[{"Sign", "[", 
                   RowBox[{"i", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                   "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "0", ",", 
                   RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"intervalCheck", "=", 
             RowBox[{"Round", "[", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1", "-", "1"}], ")"}], "/", "2"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"x", "-", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], ")"}]}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"x", "-", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}], "-", "$MachineEpsilon"}], 
                    ")"}]}], ")"}]}], "]"}]}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"function", "*", "intervalCheck"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "n", "-", "1"}], ")"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1", "+", "1"}], ")"}], "/", "2"}]}], 
            "}"}]}], "\[IndentingNewLine]", "]"}], 
         RowBox[{"(*", 
          RowBox[{"End", " ", "of", " ", "Table"}], "*)"}], 
         "\[IndentingNewLine]", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{"ENd", " ", "of", " ", "Total"}], "*)"}], 
       "\[IndentingNewLine]", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "Module"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"ENd", " ", "of", " ", "Compile"}], "*)"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BSplineMatrixFunc", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"function", ",", "\[IndentingNewLine]", "intervalCheck"}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"function", "=", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"2", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1", "-", "1"}], ")"}], "!"}]}], ")"}]}],
               " ", 
              RowBox[{"Total", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Binomial", "[", 
                   RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                    ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}]}], " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "k"}], " ", 
                  RowBox[{"Sign", "[", 
                   RowBox[{"i", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                   "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "0", ",", 
                   RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"intervalCheck", "=", 
             RowBox[{"Round", "[", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1", "-", "1"}], ")"}], "/", "2"}]}], 
                ",", 
                RowBox[{
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"x", "-", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], ")"}]}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"x", "-", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                 RowBox[{"UnitStep", "[", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}], "-", "$MachineEpsilon"}], 
                    ")"}]}], ")"}]}], "]"}]}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"function", "*", "intervalCheck"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "n", "-", "1"}], ")"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1", "+", "1"}], ")"}], "/", "2"}]}], 
            "}"}]}], "\[IndentingNewLine]", "]"}], 
         RowBox[{"(*", 
          RowBox[{"End", " ", "of", " ", "Table"}], "*)"}], 
         "\[IndentingNewLine]", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{"End", " ", "of", " ", "Total"}], "*)"}], 
       "\[IndentingNewLine]", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "Module"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"End", " ", "of", " ", "Compile"}], "*)"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "WindowGauss", " ", "retuns", " ", "the", " ", "spatial", " ", "Gauss", 
    " ", "envelope"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WindowGauss", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"size", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]s", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"E", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", 
                RowBox[{"\[Sigma]s", "^", "2"}]}], ")"}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"y", "^", "2"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", 
              RowBox[{"\[Sigma]s", "^", "2"}]}], ")"}]}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
            "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "Table"}], "*)"}], "\[IndentingNewLine]",
      "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"End", " ", "of", " ", "Compile"}], "*)"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "CakeWaveletStackFourier", " ", "constructs", " ", "the", " ", "cake", " ",
     "wavelets", " ", "in", " ", "the", " ", "Fourier", " ", "domain", " ", 
    RowBox[{"(", 
     RowBox[{
     "note", " ", "that", " ", "windowing", " ", "in", " ", "the", " ", 
      "spatial", " ", "domain", " ", "is", " ", "still", " ", "required", " ",
       "after", " ", "this"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CakeWaveletStackFourier", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"size", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s\[CurlyPhi]", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"kspline", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Rho]Inflection", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"kMn", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"matrixCoordinatesQ", ",", 
          RowBox[{"True", "|", "False"}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"mnWindow", ",", "\[IndentingNewLine]", "angleGrid"}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mnWindow", "=", 
          RowBox[{"MnWindow", "[", 
           RowBox[{"size", ",", "kMn", ",", "\[Rho]Inflection"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"angleGrid", "=", 
          RowBox[{"PolarCoordinateGridAngular", "[", "size", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mnWindow", "*", 
            RowBox[{"BSplineMatrixFunc", "[", 
             RowBox[{"kspline", ",", 
              RowBox[{"If", "[", 
               RowBox[{"matrixCoordinatesQ", ",", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"angleGrid", "-", "\[Theta]", "-", 
                    RowBox[{"\[Pi]", "/", "2"}]}], ",", 
                   RowBox[{"2", "\[Pi]"}], ",", 
                   RowBox[{"-", "\[Pi]"}]}], "]"}], "/", "s\[CurlyPhi]"}], 
                ",", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"angleGrid", "+", "\[Theta]", "+", "\[Pi]"}], ",", 
                   RowBox[{"2", "\[Pi]"}], ",", 
                   RowBox[{"-", "\[Pi]"}]}], "]"}], "/", "s\[CurlyPhi]"}]}], 
               "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "\[Pi]", ",", 
             RowBox[{
              RowBox[{"2", "\[Pi]"}], "-", 
              RowBox[{"s\[CurlyPhi]", "/", "q"}]}], ",", 
             RowBox[{"(", 
              RowBox[{"s\[CurlyPhi]", "/", "q"}], ")"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"End", " ", "of", " ", "Table"}], "*)"}], 
       "\[IndentingNewLine]", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "Module"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"End", " ", "of", " ", "Compile"}], "*)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "ErfSet", " ", "retuns", " ", "a", " ", "set", " ", "of", " ", "2", "D", 
    " ", "error", " ", 
    RowBox[{"functions", ".", "This"}], " ", "function", " ", "is", " ", 
    "used", " ", "to", " ", "cut", " ", "the", " ", "wavelets", " ", "in", 
    " ", "two", " ", 
    RowBox[{"(", 
     RowBox[{"in", " ", "the", " ", "spatial", " ", "domain"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ErfSet", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"size", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"No", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "{", "\[IndentingNewLine]", "d\[Theta]", "\[IndentingNewLine]", "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Erf", "[", 
                RowBox[{
                 RowBox[{"x", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "i"}], ")"}], " ", "\[Pi]"}], 
                    ")"}], "/", "No"}], "]"}]}], "+", 
                 RowBox[{"y", " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "i"}], ")"}], " ", "\[Pi]"}], 
                    ")"}], "/", "No"}], "]"}]}]}], "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], 
               "-", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
                "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
                "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], 
               "-", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
                "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
                "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"End", " ", "of", " ", "Table", " ", "x"}], ",", "y"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "No"}], "}"}]}], "\[IndentingNewLine]",
          "]"}]}], 
       RowBox[{"(*", 
        RowBox[{"End", " ", "of", " ", "Table", " ", "theta"}], "*)"}], 
       "\[IndentingNewLine]", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "Module"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"End", " ", "of", " ", "Compile"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "**********************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**"}], "*", 
    "CakeWaveletStack"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "CakeWaveletStack", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<SplineOrder\>\"", "\[Rule]", "3"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<AngularSubSampleRate\>\"", "\[Rule]", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Periodicity\>\"", "\[Rule]", "\[Pi]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<InflectionPoint\>\"", "\[Rule]", "\"\<Automatic\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<MnOrder\>\"", "\[Rule]", "8"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<GaussianWindowSigma\>\"", "\[Rule]", "\"\<Automatic\>\""}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<InflectionPoint\>\"", "\[Rule]", "\"\<Automatic\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<CoordinateSystem\>\"", "\[Rule]", "\"\<Matrix\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<SingleVsDoubleSided\>\"", "\[Rule]", "\"\<Double\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "definition", " ", "for", " ", "direct", " ", "options", 
    " ", "input"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CakeWaveletStack", "[", 
     RowBox[{
     "size_", ",", "s\[CurlyPhi]_", ",", "kSpline_", ",", "q_", ",", 
      "periodicity_", ",", "\[Rho]Inflection_", ",", "kMn_", ",", 
      "\[Sigma]s_", ",", "matrixCoordinatesQ_", ",", "singleOrDouble_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "cakeF", ",", "cakeIF", ",", "\[IndentingNewLine]", "window", ",", 
        "\[IndentingNewLine]", "cake"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cakeF", "=", 
        RowBox[{"CakeWaveletStackFourier", "[", 
         RowBox[{
         "size", ",", "s\[CurlyPhi]", ",", "kSpline", ",", "q", ",", 
          "\[Rho]Inflection", ",", "kMn", ",", "matrixCoordinatesQ"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"cakeF", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
              "2"}], ",", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
              "2"}]}], "]"}], "]"}], "="}], ";", 
         RowBox[{"0", "*", 
          RowBox[{"s\[CurlyPhi]", "/", "periodicity"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "The", " ", "central", " ", "frequency", " ", "overlaps", " ", 
           "with", " ", "all", " ", "rotated", " ", "kernels"}], ",", 
          RowBox[{
          "it", " ", "should", " ", "still", " ", "ad", " ", "up", " ", "to", 
           " ", "1"}]}], "*)"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"s", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cakeF", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
             "1", "-", "s"}], ";;", 
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
             "1", "+", "s"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
             "1", "-", "s"}], ";;", 
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
             "1", "+", "s"}]}]}], "]"}], "]"}], "=", 
        RowBox[{"s\[CurlyPhi]", "/", "periodicity"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "central", " ", "frequency", " ", "overlaps", " ", 
          "with", " ", "all", " ", "rotated", " ", "kernels"}], ",", 
         RowBox[{
         "it", " ", "should", " ", "still", " ", "ad", " ", "up", " ", "to", 
          " ", "1"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Inverse", " ", 
         RowBox[{"(", "centered", ")"}], " ", "Fourier", " ", "transform"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cakeIF", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"RotateRight", "[", 
           RowBox[{
            RowBox[{"InverseFourier", "[", 
             RowBox[{"RotateLeft", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"size", ",", "size"}], "}"}], "/", "2"}], "]"}]}], 
              "]"}], "]"}], ",", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"size", ",", "size"}], "}"}], "/", "2"}], "]"}]}], 
           "]"}], "&"}], "/@", "cakeF"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"window", "=", 
        RowBox[{"WindowGauss", "[", 
         RowBox[{"size", ",", "\[Sigma]s"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cake", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"window", "*", "#"}], "&"}], "/@", "cakeIF"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"periodicity", "\[Equal]", 
          RowBox[{"2", "\[Pi]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cake", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"cake", ",", 
               RowBox[{"Conjugate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Reverse", "[", 
                   RowBox[{"Reverse", "[", "#", "]"}], "]"}], "&"}], "/@", 
                 "cake"}], "]"}]}], "}"}], ",", "1"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"singleOrDouble", "\[Equal]", "\"\<Single\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cake", "=", 
           RowBox[{"cake", "*", 
            RowBox[{"ErfSet", "[", 
             RowBox[{"size", ",", 
              RowBox[{"q", "*", 
               RowBox[{"periodicity", "/", "s\[CurlyPhi]"}]}]}], "]"}]}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cake", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"End", " ", "of", " ", "Module"}], "*)"}], "\[IndentingNewLine]", 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "definition", " ", "that", " ", "uses", " ", "the", " ", 
    "OptionsPattern"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CakeWaveletStack", "[", 
     RowBox[{"size_", ",", "s\[CurlyPhi]_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "kSpline", ",", "\[IndentingNewLine]", "q", ",", "\[IndentingNewLine]",
         "periodicity", ",", "\[IndentingNewLine]", "\[Rho]Inflection", ",", 
        "\[IndentingNewLine]", "kMn", ",", "\[IndentingNewLine]", "\[Sigma]s",
         ",", "\[IndentingNewLine]", "matrixCoordinatesQ", ",", 
        "\[IndentingNewLine]", "cakeStack", ",", "\[IndentingNewLine]", 
        "singleOrDouble"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "***************************)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**", "**", "Check"}], " ", "Parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kSpline", "=", 
        RowBox[{"OptionValue", "[", "\"\<SplineOrder\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"OptionValue", "[", "\"\<AngularSubSampleRate\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"periodicity", "=", 
        RowBox[{"OptionValue", "[", "\"\<Periodicity\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<InflectionPoint\>\"", "]"}], 
         "\[IndentingNewLine]", ",", "\"\<Automatic\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Rho]Inflection", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], " ", "0.8"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"\[Rho]Inflection", "=", 
          RowBox[{"OptionValue", "[", "\"\<InflectionPoint\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"kMn", "=", 
        RowBox[{"OptionValue", "[", "\"\<MnOrder\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<GaussianWindowSigma\>\"", "]"}], 
         "\[IndentingNewLine]", ",", "\"\<Automatic\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Sigma]s", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"size", "-", "1"}], ")"}], "/", "4"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"\[Sigma]s", "=", 
          RowBox[{
          "OptionValue", "[", "\"\<GaussianWindowSigma\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<CoordinateSystem\>\"", "]"}], 
          "\[Equal]", "\"\<Matrix\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{"matrixCoordinatesQ", "=", "True"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"matrixCoordinatesQ", "=", "False"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"singleOrDouble", "=", 
        RowBox[{"OptionValue", "[", "\"\<SingleVsDoubleSided\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "**************************)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"**", "**", "**", "**", "**", "Construct"}], " ", "Stack"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cakeStack", "=", 
        RowBox[{"CakeWaveletStack", "[", 
         RowBox[{
         "size", ",", "s\[CurlyPhi]", ",", "kSpline", ",", "q", ",", 
          "periodicity", ",", "\[Rho]Inflection", ",", "kMn", ",", 
          "\[Sigma]s", ",", "matrixCoordinatesQ", ",", "singleOrDouble"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cakeStack", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "**********************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**"}], "*", 
    "GaborWaveletStack"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "GaborWaveletStack", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<\[Epsilon]\>\"", "\[Rule]", "4"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<KernelSize\>\"", "\[Rule]", "\"\<Automatic\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<k0\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "3"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Periodicity\>\"", "\[Rule]", "\[Pi]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<SingleVsDoubleSided\>\"", "\[Rule]", "\"\<Double\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<CoordinateSystem\>\"", "\[Rule]", "\"\<Matrix\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaborWaveletStack", "[", 
     RowBox[{"a_", ",", "s\[CurlyPhi]_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "\[Epsilon]", ",", "\[IndentingNewLine]", "A", ",", 
        "\[IndentingNewLine]", "k0", ",", "\[IndentingNewLine]", "size", ",", 
        "\[IndentingNewLine]", "periodicity", ",", "\[IndentingNewLine]", 
        "stack", ",", "\[IndentingNewLine]", "singleOrDouble", ",", 
        "\[IndentingNewLine]", "matrixCoordinatesQ"}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Parameters", ":"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Epsilon]", "=", 
        RowBox[{"OptionValue", "[", "\"\<\[Epsilon]\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", "=", 
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Epsilon]", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], ")"}]}], ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"k0", "=", 
        RowBox[{"OptionValue", "[", "\"\<k0\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<KernelSize\>\"", "]"}], 
         "\[IndentingNewLine]", ",", "\"\<Automatic\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"size", "=", 
          RowBox[{"Floor", "[", 
           RowBox[{"8", "*", 
            RowBox[{"Sqrt", "[", "\[Epsilon]", "]"}], "*", "a"}], "]"}]}], 
         "\[IndentingNewLine]", ",", "_Integer", ",", "\[IndentingNewLine]", 
         RowBox[{"size", "=", 
          RowBox[{"OptionValue", "[", "\"\<KernelSize\>\"", "]"}]}], 
         "\[IndentingNewLine]", ",", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"size", "=", 
          RowBox[{"Floor", "[", 
           RowBox[{"8", "*", 
            RowBox[{"Sqrt", "[", "\[Epsilon]", "]"}], "*", "a"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "size", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"size", "=", 
          RowBox[{"size", "+", "1"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"periodicity", "=", 
        RowBox[{"OptionValue", "[", "\"\<Periodicity\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"singleOrDouble", "=", 
        RowBox[{"OptionValue", "[", "\"\<SingleVsDoubleSided\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"matrixCoordinatesQ", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<CoordinateSystem\>\"", "]"}], 
         "\[Equal]", "\"\<Matrix\>\""}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"The", " ", 
         RowBox[{"stack", ":"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"stack", "=", 
        RowBox[{"GenerateKernelSetGabor", "[", 
         RowBox[{"A", ",", "k0", ",", "a", ",", 
          RowBox[{"Round", "[", 
           RowBox[{"\[Pi]", "/", "s\[CurlyPhi]"}], "]"}], ",", "size", ",", 
          "matrixCoordinatesQ"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"periodicity", "\[Equal]", 
          RowBox[{"2", " ", "\[Pi]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"stack", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"stack", ",", 
               RowBox[{"Conjugate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Reverse", "[", 
                   RowBox[{"Reverse", "[", "#", "]"}], "]"}], "&"}], "/@", 
                 "stack"}], "]"}]}], "}"}], ",", "1"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"singleOrDouble", "\[Equal]", "\"\<Single\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"stack", "=", 
           RowBox[{"stack", "*", 
            RowBox[{"ErfSet", "[", 
             RowBox[{"size", ",", 
              RowBox[{"periodicity", "/", "s\[CurlyPhi]"}]}], "]"}]}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "stack", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateKernelSetGabor", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", "_Real", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k0", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n\[Theta]", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"matQ", ",", 
          RowBox[{"True", "|", "False"}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "{", "\[IndentingNewLine]", "d\[Theta]", "\[IndentingNewLine]", "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d\[Theta]", "=", 
          RowBox[{
           RowBox[{"(", "\[Pi]", ")"}], "/", "n\[Theta]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"0.00000000001", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", " ", "a", " ", "\[Pi]"}], ")"}], "/", 
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{"9", "/", "2"}], ")"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "a"}], ")"}], "*", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"xx", "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Theta]"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Theta]"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}]}], "}"}], ".", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"yy", "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Theta]"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Theta]"}], "+", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "}"}], ".", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}]}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"I", " ", 
                    RowBox[{"(", 
                    RowBox[{"k0", ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"yy", ",", "xx"}], "}"}], "/", "a"}], ")"}]}], 
                    ")"}]}], "]"}], 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}]}], " ", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"(", 
                    RowBox[{"A", ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"yy", ",", "xx"}], "}"}], "/", "a"}], ")"}]}], 
                    ")"}], "]"}], "^", "2"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"(*", 
                RowBox[{"End", " ", "of", " ", "With"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"-", 
                  RowBox[{"Floor", "[", 
                   RowBox[{"dim", "/", "2"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Floor", "[", 
                   RowBox[{"dim", "/", "2"}], "]"}], "-", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"dim", "/", "2"}], ",", "1"}], "]"}]}]}], 
                   ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{"-", 
                  RowBox[{"Floor", "[", 
                   RowBox[{"dim", "/", "2"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Floor", "[", 
                   RowBox[{"dim", "/", "2"}], "]"}], "-", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"dim", "/", "2"}], ",", "1"}], "]"}]}]}], 
                   ")"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"End", " ", "of", " ", "Table", " ", "x"}], ",", "y"}],
               "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", 
               RowBox[{"If", "[", 
                RowBox[{"matQ", ",", "\[Pi]", ",", 
                 RowBox[{"\[Pi]", "+", 
                  RowBox[{"\[Pi]", "/", "2"}]}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{"matQ", ",", 
                 RowBox[{
                  RowBox[{"2", "*", "\[Pi]"}], "-", "d\[Theta]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"+", "\[Pi]"}], "/", "2"}], "+", "d\[Theta]"}]}], 
                "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{"matQ", ",", "d\[Theta]", ",", 
                 RowBox[{"-", "d\[Theta]"}]}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}]}]}], 
       RowBox[{"(*", 
        RowBox[{"End", " ", "of", " ", "Table", " ", "theta"}], "*)"}], 
       "\[IndentingNewLine]", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "Module"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"End", " ", "of", " ", "Compile"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "**********************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**"}], "*", 
    "WaveletTransform2D"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WaveletTransform2DErik", "[", 
     RowBox[{"kernels_", ",", "im_", ",", 
      RowBox[{"fourierQ_", ":", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "imF", ",", "\[IndentingNewLine]", "kernelsF", ",", 
        "\[IndentingNewLine]", "os", ",", "\[IndentingNewLine]", 
        "dimkernelx1", ",", "\[IndentingNewLine]", "dimkernely1", ",", 
        "\[IndentingNewLine]", "dimkernelx2", ",", "\[IndentingNewLine]", 
        "dimkernely2"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "kernels", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "2"}], ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "\[Equal]", 
           RowBox[{"Dimensions", "[", "im", "]"}]}], "&&", 
          RowBox[{"fourierQ", "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Using", " ", "the", " ", "Fourier", " ", "transform"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"imF", "=", 
           RowBox[{"Fourier", "[", "im", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"kernelsF", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Fourier", "[", 
              RowBox[{"Reverse", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "&"}], "/@", 
            "kernels"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"os", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"RotateRight", "[", 
              RowBox[{
               RowBox[{"InverseFourier", "[", 
                RowBox[{"#", "*", "imF"}], "]"}], ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{"0.1", "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "im", "]"}], "/", "2"}]}], 
                "]"}]}], "]"}], "&"}], "/@", "kernelsF"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Using", " ", "Correlation"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dimkernelx1", ",", "dimkernely1"}], "}"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"kernels", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}], "//", 
            "Ceiling"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dimkernelx2", ",", "dimkernely2"}], "}"}], "=", 
           RowBox[{"Dimensions", "[", 
            RowBox[{"kernels", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "dimkernelx2", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"dimkernelx2", "=", 
             RowBox[{
              RowBox[{"dimkernelx2", "/", "2"}], "+", "1"}]}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"dimkernelx2", "=", 
             RowBox[{
              RowBox[{"dimkernelx2", "/", "2"}], "//", "Ceiling"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "dimkernely2", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"dimkernely2", "=", 
             RowBox[{
              RowBox[{"dimkernely2", "/", "2"}], "+", "1"}]}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"dimkernely2", "=", 
             RowBox[{
              RowBox[{"dimkernely2", "/", "2"}], "//", "Ceiling"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"os", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ListCorrelate", "[", 
              RowBox[{
               RowBox[{"kernels", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "im", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "dimkernelx1"}], ",", 
                   RowBox[{"-", "dimkernely1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"dimkernelx2", ",", "dimkernely2"}], "}"}]}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "kernels", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "os", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "**********************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**"}], "*", 
    "WaveletTransform2D"}], "*)"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "OrientationScoreTransform", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<WaveletSize\>\"", "\[Rule]", "151"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<SplineOrder\>\"", "\[Rule]", "3"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<AngularSubSampleRate\>\"", "\[Rule]", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Periodicity\>\"", "\[Rule]", "\[Pi]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<InflectionPoint\>\"", "\[Rule]", "\"\<Automatic\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<MnOrder\>\"", "\[Rule]", "8"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<GaussianWindowSigma\>\"", "\[Rule]", "\"\<Automatic\>\""}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<InflectionPoint\>\"", "\[Rule]", "\"\<Automatic\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<CoordinateSystem\>\"", "\[Rule]", "\"\<Matrix\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<SingleVsDoubleSided\>\"", "\[Rule]", "\"\<Double\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Method\>\"", "\[Rule]", "\"\<SpatialConvolution\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"OrientationScoreTransform", "::", "dim"}], "=", 
   "\"\<Warning! Method \\\"Fourier\\\" can not be used if the image \
dimensions are not equal. Convolution based method with kernel size `1`x`1` \
used instead.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrientationScoreTransform", "::", "size"}], "=", 
    "\"\<Warning! Wavelet size can not be specified with method \\\"Fourier\\\
\", size is set equal to the image size.\>\""}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrientationScoreTransform", "[", 
     RowBox[{"im_", ",", "s\[CurlyPhi]_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "dimx", ",", "dimy", ",", "\[IndentingNewLine]", "size", ",", 
        "\[IndentingNewLine]", "kSpline", ",", "\[IndentingNewLine]", "q", 
        ",", "\[IndentingNewLine]", "periodicity", ",", "\[IndentingNewLine]",
         "\[Rho]Inflection", ",", "\[IndentingNewLine]", "kMn", ",", 
        "\[IndentingNewLine]", "\[Sigma]s", ",", "\[IndentingNewLine]", 
        "matrixCoordinatesQ", ",", "\[IndentingNewLine]", "cakeStack", ",", 
        "\[IndentingNewLine]", "os", ",", "\[IndentingNewLine]", 
        "singleOrDouble"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "***************************)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**", "**", "Check"}], " ", "Parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dimx", ",", "dimy"}], "}"}], "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "im", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Method\>\"", "]"}], "\[Equal]", 
          "\"\<Fourier\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dimx", "\[NotEqual]", "dimy"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"OrientationScoreTransform", "::", "dim"}], ",", 
              RowBox[{"OptionValue", "[", "\"\<WaveletSize\>\"", "]"}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"size", "=", 
             RowBox[{"OptionValue", "[", "\"\<WaveletSize\>\"", "]"}]}], 
            ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"OptionValue", "[", "\"\<WaveletSize\>\"", "]"}], 
               "\[NotEqual]", 
               RowBox[{
                RowBox[{"Options", "[", 
                 RowBox[{
                 "OrientationScoreTransform", ",", "\"\<WaveletSize\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Message", "[", 
                RowBox[{"OrientationScoreTransform", "::", "size"}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"size", "=", "dimx"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"size", "=", 
          RowBox[{"OptionValue", "[", "\"\<WaveletSize\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"kSpline", "=", 
        RowBox[{"OptionValue", "[", "\"\<SplineOrder\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"OptionValue", "[", "\"\<AngularSubSampleRate\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"periodicity", "=", 
        RowBox[{"OptionValue", "[", "\"\<Periodicity\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<InflectionPoint\>\"", "]"}], 
         "\[IndentingNewLine]", ",", "\"\<Automatic\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Rho]Inflection", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], " ", "0.8"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"\[Rho]Inflection", "=", 
          RowBox[{"OptionValue", "[", "\"\<InflectionPoint\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"kMn", "=", 
        RowBox[{"OptionValue", "[", "\"\<MnOrder\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<GaussianWindowSigma\>\"", "]"}], 
         "\[IndentingNewLine]", ",", "\"\<Automatic\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Sigma]s", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"size", "-", "1"}], ")"}], "/", "4"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"\[Sigma]s", "=", 
          RowBox[{
          "OptionValue", "[", "\"\<GaussianWindowSigma\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<CoordinateSystem\>\"", "]"}], 
          "\[Equal]", "\"\<Matrix\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{"matrixCoordinatesQ", "=", "True"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"matrixCoordinatesQ", "=", "False"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"singleOrDouble", "=", 
        RowBox[{"OptionValue", "[", "\"\<SingleVsDoubleSided\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "**************************)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"**", "**", "**", "**", "**", "Construct"}], " ", "Stack"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cakeStack", "=", 
        RowBox[{"CakeWaveletStack", "[", 
         RowBox[{
         "size", ",", "s\[CurlyPhi]", ",", "kSpline", ",", "q", ",", 
          "periodicity", ",", "\[Rho]Inflection", ",", "kMn", ",", 
          "\[Sigma]s", ",", "matrixCoordinatesQ", ",", "singleOrDouble"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"os", "=", 
        RowBox[{"WaveletTransform2DErik", "[", 
         RowBox[{"cakeStack", ",", "im", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<Method\>\"", "]"}], "\[Equal]", 
             "\"\<Fourier\>\""}], ",", "1", ",", "0"}], "]"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "os", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "******************************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "End"}], " ", 
    "Private"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6283308413389482`*^9, 3.6283308429780636`*^9}, {
  3.6361849439838905`*^9, 3.636184981626449*^9}, {3.6361977951105614`*^9, 
  3.636197800991724*^9}, {3.6699500992912636`*^9, 3.6699501307559533`*^9}, {
  3.6699502683595686`*^9, 3.6699504120313597`*^9}, {3.6699505325045457`*^9, 
  3.6699516199709225`*^9}, {3.906097846827426*^9, 3.906097870368034*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"b8b6b901-30e3-44bd-84fc-bb4e11d9c60e"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Load Images", "Chapter",
 CellChangeTimes->{{3.8713709923185797`*^9, 
  3.8713709944375134`*^9}},ExpressionUUID->"e3d614c7-a321-493e-b9de-\
8c298e25bd2c"],

Cell["\<\
The annotations of the images are not always fully correct (relations between \
parent and child vessels, and directions of vessels may be incorrect for some \
images).\
\>", "Text",
 CellChangeTimes->{{3.871371837217696*^9, 
  3.8713719006621995`*^9}},ExpressionUUID->"16f5e194-3e94-476b-aac1-\
b0be1cad1755"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"directory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<IOSTAR_Shuhe\\\\IOSTAR\\\\Train\\\\images\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filesIM", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.png\>\"", ",", "directory"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filesJSON", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"FileNames", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FileBaseName", "[", "#", "]"}], "<>", 
          "\"\<_Merged.json\>\""}], ",", "directory"}], "]"}], ",", "#"}], 
      "]"}], "&"}], "/@", "filesIM"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filesIMor", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"FileNames", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FileBaseName", "[", "#", "]"}], "<>", "\"\<.jpg\>\""}], 
         ",", "directory"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
    "filesIM"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6321104764003205`*^9, 3.632110714784951*^9}, {
   3.63211959709842*^9, 3.632119600379729*^9}, {3.6321199442302475`*^9, 
   3.6321199468396807`*^9}, {3.632120363524599*^9, 3.632120367509011*^9}, 
   3.63212040377491*^9, 3.6321204502699223`*^9, {3.6321207747376804`*^9, 
   3.6321208270347404`*^9}, {3.6321268055047607`*^9, 3.63212681140135*^9}, {
   3.632139864226648*^9, 3.6321398862226477`*^9}, {3.6321401601742477`*^9, 
   3.6321401616874475`*^9}, {3.632201551756397*^9, 3.632201556538875*^9}, {
   3.634356640149673*^9, 3.6343566794155087`*^9}, {3.6363456535650477`*^9, 
   3.636345684555705*^9}, {3.6363552519235287`*^9, 3.6363552521110687`*^9}, {
   3.63644695266846*^9, 3.636446997559087*^9}, {3.637563983851345*^9, 
   3.637563985865958*^9}, {3.9058393298315797`*^9, 3.905839342800129*^9}, {
   3.9058394246308994`*^9, 3.9058394358312607`*^9}, 3.9058395879304256`*^9, 
   3.905839780445999*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"e63c50f6-8c77-494f-8c4c-e5054fd0725b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"directoryMask", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<IOSTAR_Shuhe\\\\IOSTAR\\\\Train\\\\mask\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filesIMMask", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.tif\>\"", ",", "directoryMask"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8733660245703354`*^9, 3.873366068036478*^9}, {
  3.873366195208381*^9, 3.8733662288402967`*^9}, {3.8750679516897593`*^9, 
  3.875067952777704*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"d8a36c1a-bfa1-408d-be05-a9f667281c4b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Select Image and Annotations", "Chapter",
 CellChangeTimes->{{3.871370998987939*^9, 3.871371001628995*^9}, {
  3.871371941307643*^9, 
  3.8713719442895346`*^9}},ExpressionUUID->"453c3ba5-2e53-4b22-ae6a-\
b12e6f12af03"],

Cell[CellGroupData[{

Cell["Load image and annotations", "Section",
 CellChangeTimes->{{3.631418976560703*^9, 
  3.6314189813211336`*^9}},ExpressionUUID->"f5b68bac-f174-4172-8a20-\
b793bc0f73f0"],

Cell["\<\
Vessel trees are not always correctly annotated in the .json-file. Therefore, \
we grouped vessels belonging to the same vessel tree, their start vessels and \
end vessels. In addition to that, we selected the rows that are in the \
considered half of the image (in this case the upper half).\
\>", "Text",
 CellChangeTimes->{{3.8713720042011843`*^9, 
  3.871372130779111*^9}},ExpressionUUID->"516df055-a022-4fe9-bdee-\
2ed5ecd53668"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VesselTrees", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
       "8", ",", "9", ",", "10", ",", "11", ",", "12", ",", "13", ",", "14", 
       ",", "15", ",", "16", ",", "40", ",", "41", ",", "42", ",", "43", ",", 
       "44", ",", "45", ",", "46", ",", "47", ",", "48", ",", "49", ",", "50",
        ",", "51", ",", "52", ",", "53", ",", "54", ",", "55", ",", "56", ",",
        "57", ",", "58", ",", "59"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "17", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "18", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "19", ",", "26", ",", "27", ",", "28", ",", "29", ",", "61", ",", "66", 
       ",", "68", ",", "71", ",", "72"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "20", ",", "21", ",", "22", ",", "23", ",", "24", ",", "25", ",", "60", 
       ",", "62", ",", "63", ",", "64", ",", "65", ",", "67", ",", "69", ",", 
       "70"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"30", ",", "31", ",", "32"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "33", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "34", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "35", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "36", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "39", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rowSelection", "=", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4", ",", "5", ",", "6", ",", "7"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"startVesselsNames", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "17", "}"}], ",", 
     RowBox[{"{", "18", "}"}], ",", 
     RowBox[{"{", "19", "}"}], ",", 
     RowBox[{"{", "20", "}"}], ",", 
     RowBox[{"{", "30", "}"}], ",", 
     RowBox[{"{", "33", "}"}], ",", 
     RowBox[{"{", "34", "}"}], ",", 
     RowBox[{"{", "35", "}"}], ",", 
     RowBox[{"{", "36", "}"}], ",", 
     RowBox[{"{", "39", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endVesselsNames", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "2", ",", "3", ",", "4", ",", "8", ",", "9", ",", "12", ",", "13", ",", 
       "15", ",", "16", ",", "40", ",", "41", ",", "42", ",", "44", ",", "45",
        ",", "46", ",", "47", ",", "48", ",", "49", ",", "50", ",", "51", ",",
        "52", ",", "53", ",", "54", ",", "55", ",", "56", ",", "57", ",", 
       "58", ",", "59"}], "}"}], ",", 
     RowBox[{"{", "17", "}"}], ",", 
     RowBox[{"{", "18", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "26", ",", "28", ",", "29", ",", "61", ",", "66", ",", "68", ",", "71", 
       ",", "72"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "21", ",", "23", ",", "25", ",", "60", ",", "62", ",", "63", ",", "64", 
       ",", "65", ",", "67", ",", "69", ",", "70"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "32"}], "}"}], ",", 
     RowBox[{"{", "33", "}"}], ",", 
     RowBox[{"{", "34", "}"}], ",", 
     RowBox[{"{", "35", "}"}], ",", 
     RowBox[{"{", "36", "}"}], ",", 
     RowBox[{"{", "39", "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8486718343475485`*^9, 3.848671839877495*^9}, {
   3.8489220527358637`*^9, 3.8489220632545977`*^9}, 3.848922563916769*^9, {
   3.848928904309311*^9, 3.8489289178190536`*^9}, {3.8489291478345165`*^9, 
   3.848929157522023*^9}, {3.848929193969455*^9, 3.848929194642145*^9}, {
   3.848929684509836*^9, 3.8489296943473687`*^9}, {3.848930029994684*^9, 
   3.848930030858785*^9}, {3.848930139485019*^9, 3.848930140070019*^9}, {
   3.8489303056182346`*^9, 3.848931067163562*^9}, {3.8489312548594685`*^9, 
   3.8489313143927336`*^9}, {3.8489315942714233`*^9, 3.848931628250991*^9}, {
   3.8489316609690475`*^9, 3.8489317104599566`*^9}, {3.8489318798399715`*^9, 
   3.848932582922557*^9}, {3.8489326426267214`*^9, 3.8489327517786064`*^9}, {
   3.8489328506727247`*^9, 3.8489328509632254`*^9}, {3.8489330076662855`*^9, 
   3.848933017133898*^9}, {3.8489331257842407`*^9, 3.8489331571419954`*^9}, {
   3.8489333054908533`*^9, 3.848933324318695*^9}, {3.8489334538978877`*^9, 
   3.8489334608501844`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"2fd91371-8666-4a50-8e6a-f0e8dd8efe3b"],

Cell["We select image 18 and import its corresponding annotations.", "Text",
 CellChangeTimes->{{3.8713721360839324`*^9, 
  3.871372157027299*^9}},ExpressionUUID->"2cd5c294-1395-4c05-bf49-\
dedcca015114"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"imNr", "=", "9"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"imNr", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"File", " ", "names"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNameImage", "=", 
   RowBox[{
   "filesIM", "\[LeftDoubleBracket]", "imNr", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fNameAnnotation", "=", 
   RowBox[{"First", "[", 
    RowBox[{
    "filesJSON", "\[LeftDoubleBracket]", "imNr", "\[RightDoubleBracket]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fNameMask", "=", 
    RowBox[{
    "filesIMMask", "\[LeftDoubleBracket]", "imNr", 
     "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Import", " ", "data"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"im", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"fNameImage", ",", "\"\<Data\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Dimensions", "[", "im", "]"}], "]"}], ">", "2"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"im", "=", 
      RowBox[{"im", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
     ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"im", "=", "im"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"im", "=", 
    RowBox[{"Rescale", "[", "im", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Import", " ", "vessel", " ", "annotations"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allAnnotations", "=", 
   RowBox[{"Import", "[", "fNameAnnotation", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vesselAnnotations", "=", 
    RowBox[{"\"\<vessels\>\"", "/.", "allAnnotations"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"First", "[", "vesselAnnotationsData", "]"}], "]"}], 
      "\[Equal]", "\"\<vessels\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vesselAnnotations", "=", "allAnnotations"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Show", " ", "data"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image", "[", "im", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{"Green", ",", 
         RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
         RowBox[{"Arrow", "/@", 
          RowBox[{"Transpose", "/@", 
           RowBox[{"(", 
            RowBox[{"\"\<firstWall\>\"", "/.", "vesselAnnotations"}], 
            ")"}]}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{"Green", ",", 
         RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
         RowBox[{"Arrow", "/@", 
          RowBox[{"Transpose", "/@", 
           RowBox[{"(", 
            RowBox[{"\"\<secondWall\>\"", "/.", "vesselAnnotations"}], 
            ")"}]}]}]}], "}"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", ",", 
   RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6321107202386723`*^9, 3.6321107400492725`*^9}, {
   3.6321110363934007`*^9, 3.6321110527020636`*^9}, {3.632119697993126*^9, 
   3.632119721838453*^9}, {3.632119752464096*^9, 3.6321197531360035`*^9}, 
   3.6321199625431676`*^9, {3.632120062138629*^9, 3.632120080993882*^9}, {
   3.6321201879330893`*^9, 3.6321202088239717`*^9}, {3.6321202388557425`*^9, 
   3.632120272992379*^9}, {3.632120305883421*^9, 3.6321203101021757`*^9}, {
   3.632120346352559*^9, 3.6321203466650057`*^9}, {3.632120434332717*^9, 
   3.6321204436450577`*^9}, {3.6363579481806107`*^9, 3.6363579547361045`*^9}, 
   3.636365196435877*^9, {3.6363676748027787`*^9, 3.6363677069765224`*^9}, {
   3.63636800334501*^9, 3.63636800954123*^9}, {3.636430382291294*^9, 
   3.636430428592563*^9}, {3.637666477872963*^9, 3.6376664792986507`*^9}, 
   3.6379004059015694`*^9, {3.665125608863834*^9, 3.665125609066967*^9}, {
   3.665125662627514*^9, 3.665125682076186*^9}, {3.665125772847412*^9, 
   3.6651257965531583`*^9}, 3.845537672127635*^9, {3.8455377176182575`*^9, 
   3.8455377572339897`*^9}, {3.845713000561839*^9, 3.845713000691499*^9}, 
   3.8457157274657288`*^9, 3.845719485329923*^9, {3.845955767473254*^9, 
   3.845955767808876*^9}, {3.845958907334997*^9, 3.845958907513612*^9}, 
   3.845961890953102*^9, {3.8459688693668933`*^9, 3.8459688702286186`*^9}, 
   3.846558985239467*^9, {3.84779140436685*^9, 3.847791418672674*^9}, {
   3.847791461200805*^9, 3.8477914814151506`*^9}, {3.848054492960129*^9, 
   3.848054513703916*^9}, {3.8480546092236004`*^9, 3.848054656456555*^9}, 
   3.8480547293085775`*^9, {3.852218653563259*^9, 3.85221865389946*^9}, {
   3.905588088824956*^9, 3.9055880991846247`*^9}, {3.905839630430546*^9, 
   3.905839630580475*^9}, 3.90583973799671*^9, {3.905842087591161*^9, 
   3.9058420903530273`*^9}, {3.9285625416736765`*^9, 3.9285625440016556`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"93a570aa-ccbf-4d7d-a124-4f2ad8658084"],

Cell[CellGroupData[{

Cell["Mask", "Subsection",
 CellChangeTimes->{{3.6376471349422803`*^9, 
  3.637647136271988*^9}},ExpressionUUID->"6a89fb72-7f3c-465e-b676-\
ef05e5a602c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Import", " ", "data"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"mask", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"fNameMask", ",", "\"\<Data\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Dimensions", "[", "mask", "]"}], "]"}], ">", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mask", "=", 
        RowBox[{"mask", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
       ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mask", "=", "mask"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"mask", "=", 
     RowBox[{"Rescale", "[", "mask", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HighlightImage", "[", 
       RowBox[{
        RowBox[{"ImageAdjust", "[", 
         RowBox[{"Image", "[", "im", "]"}], "]"}], ",", 
        RowBox[{"Image", "[", "mask", "]"}]}], "]"}], ",", 
      RowBox[{"Image", "[", "mask", "]"}]}], "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8733661214506407`*^9, 3.873366143694336*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"4032094c-a6f1-4ada-b5d6-54959890ba8d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Downsample image and annotated data
\t(Warning: this overwrites im and vesselAnnotations defined in previous cell)\
\>", "Section",
 CellChangeTimes->{{3.6363552990972195`*^9, 3.6363553092971845`*^9}, {
  3.6364304594823036`*^9, 
  3.6364304877818336`*^9}},ExpressionUUID->"3735de6c-fb93-4c4c-8242-\
a512849ff2a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Downsample", " ", "by", " ", "factor", " ", "ds"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ds", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ds", "=", "2"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"im", "=", 
     RowBox[{"ImageData", "[", 
      RowBox[{"ImageResize", "[", 
       RowBox[{
        RowBox[{"Image", "[", "im", "]"}], ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Dimensions", "[", "im", "]"}], "]"}], "/", "ds"}], 
         "]"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mask", "=", 
     RowBox[{"ImageData", "[", 
      RowBox[{"ImageResize", "[", 
       RowBox[{
        RowBox[{"Image", "[", "mask", "]"}], ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Dimensions", "[", "mask", "]"}], "]"}], "/", "ds"}], 
         "]"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vesselAnnotations", "=", 
     RowBox[{"vesselAnnotations", "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<secondWall\>\"", "\[Rule]", "x_"}], ")"}], "->", 
       RowBox[{"(", 
        RowBox[{"\"\<secondWall\>\"", "\[Rule]", 
         RowBox[{"x", "/", "ds"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vesselAnnotations", "=", 
     RowBox[{"vesselAnnotations", "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<firstWall\>\"", "\[Rule]", "x_"}], ")"}], "->", 
       RowBox[{"(", 
        RowBox[{"\"\<firstWall\>\"", "\[Rule]", 
         RowBox[{"x", "/", "ds"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vesselAnnotationsData", "=", 
     RowBox[{"vesselAnnotations", "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<firstWall\>\"", "\[Rule]", "x_"}], ")"}], "->", 
       RowBox[{"(", 
        RowBox[{"\"\<firstWall\>\"", "\[Rule]", 
         RowBox[{"Hold", "[", 
          RowBox[{"Transpose", "@", 
           RowBox[{"graphicsToImageCoordinates", "[", 
            RowBox[{
             RowBox[{"Dimensions", "[", "im", "]"}], ",", 
             RowBox[{"Transpose", "@", "x"}]}], "]"}]}], "]"}]}], ")"}]}]}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vesselAnnotationsData", "=", 
     RowBox[{"vesselAnnotationsData", "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<secondWall\>\"", "\[Rule]", "x_"}], ")"}], "->", 
       RowBox[{"(", 
        RowBox[{"\"\<secondWall\>\"", "\[Rule]", 
         RowBox[{"Hold", "[", 
          RowBox[{"Transpose", "@", 
           RowBox[{"graphicsToImageCoordinates", "[", 
            RowBox[{
             RowBox[{"Dimensions", "[", "im", "]"}], ",", 
             RowBox[{"Transpose", "@", "x"}]}], "]"}]}], "]"}]}], ")"}]}]}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vesselAnnotationsData", "=", 
     RowBox[{"vesselAnnotationsData", "//", "ReleaseHold"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ImageAdjust", "[", 
      RowBox[{"Image", "[", "im", "]"}], "]"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{"Green", ",", 
         RowBox[{"Line", "/@", 
          RowBox[{"Transpose", "/@", 
           RowBox[{"(", 
            RowBox[{"\"\<firstWall\>\"", "/.", 
             RowBox[{"Select", "[", 
              RowBox[{"vesselAnnotations", ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "@", 
                   RowBox[{"Part", "[", 
                    RowBox[{"VesselTrees", ",", "rowSelection"}], "]"}]}], 
                  ",", 
                  RowBox[{"\"\<name\>\"", "/.", "#"}]}], "]"}], "&"}]}], 
              "]"}]}], ")"}]}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{"Green", ",", 
         RowBox[{"Line", "/@", 
          RowBox[{"Transpose", "/@", 
           RowBox[{"(", 
            RowBox[{"\"\<secondWall\>\"", "/.", 
             RowBox[{"Select", "[", 
              RowBox[{"vesselAnnotations", ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "@", 
                   RowBox[{"Part", "[", 
                    RowBox[{"VesselTrees", ",", "rowSelection"}], "]"}]}], 
                  ",", 
                  RowBox[{"\"\<name\>\"", "/.", "#"}]}], "]"}], "&"}]}], 
              "]"}]}], ")"}]}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.636355318406521*^9, 3.636355349164131*^9}, {
   3.6363554698248262`*^9, 3.636355491654749*^9}, {3.6363725867583313`*^9, 
   3.6363726013208914`*^9}, 3.6363774643521256`*^9, 3.6363780216915283`*^9, {
   3.6364304439847364`*^9, 3.6364304502977943`*^9}, {3.6375745760000887`*^9, 
   3.6375745860450387`*^9}, {3.637647626108798*^9, 3.637647641443409*^9}, {
   3.6376478227745934`*^9, 3.637647823036603*^9}, {3.6376478694577856`*^9, 
   3.637647870273777*^9}, {3.6376480592724824`*^9, 3.6376480767178745`*^9}, 
   3.6376664943201127`*^9, {3.637667931920068*^9, 3.6376679342667074`*^9}, {
   3.6651249892361064`*^9, 3.6651250572696037`*^9}, {3.665125103245185*^9, 
   3.6651251126906586`*^9}, {3.665125153075572*^9, 3.6651252078403435`*^9}, {
   3.6651252614910035`*^9, 3.66512528849964*^9}, {3.665125349421134*^9, 
   3.66512535355113*^9}, 3.665125460411048*^9, {3.665125723368497*^9, 
   3.6651257564741354`*^9}, {3.665127657212329*^9, 3.6651276574623733`*^9}, {
   3.665127695633624*^9, 3.6651277135252595`*^9}, 3.8281522099635496`*^9, 
   3.828156900410407*^9, {3.846042026166813*^9, 3.8460420857957773`*^9}, 
   3.8460422202388754`*^9, {3.8460423315986958`*^9, 3.8460423542523303`*^9}, {
   3.846559037393387*^9, 3.8465590400093875`*^9}, {3.8465591897861156`*^9, 
   3.8465591927254877`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"efa9673d-f94d-4fde-8f99-a5a90711c788"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"endVessels", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"vesselAnnotationsData", ",", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Part", "[", 
           RowBox[{"endVesselsNames", ",", "rowSelection"}], "]"}]}]}], ",", 
        RowBox[{"\"\<name\>\"", "/.", "#"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ends", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{".5", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<firstWall\>\"", "/.", "#"}], ")"}], "\[Transpose]"}],
           "]"}], "+", 
         RowBox[{"Last", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<secondWall\>\"", "/.", "#"}], ")"}], 
           "\[Transpose]"}], "]"}]}], ")"}]}], "&"}], ",", "endVessels"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startVessels", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"vesselAnnotationsData", ",", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Part", "[", 
           RowBox[{"startVesselsNames", ",", "rowSelection"}], "]"}]}]}], ",", 
        RowBox[{"\"\<name\>\"", "/.", "#"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"starts", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{".5", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<firstWall\>\"", "/.", "#"}], ")"}], "\[Transpose]"}],
           "]"}], "+", 
         RowBox[{"First", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<secondWall\>\"", "/.", "#"}], ")"}], 
           "\[Transpose]"}], "]"}]}], ")"}]}], "&"}], ",", "startVessels"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seedVessels", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"vesselAnnotationsData", ",", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"Part", "[", 
          RowBox[{"VesselTrees", ",", "rowSelection"}], "]"}]}], ",", 
        RowBox[{"\"\<name\>\"", "/.", "#"}]}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seeds", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{".5", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<firstWall\>\"", "/.", "#"}], ")"}], "\[Transpose]"}],
           "]"}], "+", 
         RowBox[{"First", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<secondWall\>\"", "/.", "#"}], ")"}], 
           "\[Transpose]"}], "]"}]}], ")"}]}], "&"}], ",", "seedVessels"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.846041410933591*^9, 3.846041419446633*^9}, {
  3.846041468015699*^9, 3.8460414802706733`*^9}, {3.846041929513918*^9, 
  3.8460419801719055`*^9}, {3.846042050661799*^9, 3.8460420516035166`*^9}, {
  3.8460425382399797`*^9, 3.8460426436073947`*^9}, {3.846060321716936*^9, 
  3.8460603307009325`*^9}, {3.846559175066594*^9, 3.8465591819578776`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"a2a642aa-096e-47f0-a317-7358e4fc44a2"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImageAdjust", "[", 
       RowBox[{"Image", "[", "im", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", ".012", "]"}], ",", "Green", ",", 
         RowBox[{"PointImageCoordinates", "[", 
          RowBox[{"im", ",", "seeds"}], "]"}], ",", "Red", ",", 
         RowBox[{"PointImageCoordinates", "[", 
          RowBox[{"im", ",", "ends"}], "]"}]}], "}"}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImageAdjust", "[", 
       RowBox[{"Image", "[", "im", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", ".012", "]"}], ",", "Green", ",", 
         RowBox[{"PointImageCoordinates", "[", 
          RowBox[{"im", ",", "starts"}], "]"}], ",", "Red", ",", 
         RowBox[{"PointImageCoordinates", "[", 
          RowBox[{"im", ",", "ends"}], "]"}]}], "}"}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImageAdjust", "[", 
       RowBox[{"Image", "[", "im", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", ".012", "]"}], ",", "Green", ",", 
         RowBox[{"PointImageCoordinates", "[", 
          RowBox[{"im", ",", "starts"}], "]"}], ",", "Red", ",", 
         RowBox[{"PointImageCoordinates", "[", 
          RowBox[{"im", ",", "ends"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{"Green", ",", 
          RowBox[{"Line", "/@", 
           RowBox[{"Transpose", "/@", 
            RowBox[{"(", 
             RowBox[{"\"\<firstWall\>\"", "/.", "vesselAnnotations"}], 
             ")"}]}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{"Green", ",", 
          RowBox[{"Line", "/@", 
           RowBox[{"Transpose", "/@", 
            RowBox[{"(", 
             RowBox[{"\"\<secondWall\>\"", "/.", "vesselAnnotations"}], 
             ")"}]}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6375643210909867`*^9, 3.637564372086564*^9}, {
   3.6375645399144735`*^9, 3.637564553910674*^9}, {3.6375646188390436`*^9, 
   3.6375647266739073`*^9}, 3.637662434206366*^9, {3.637662488296561*^9, 
   3.637662518494814*^9}, {3.6651254054734664`*^9, 3.665125417760874*^9}, {
   3.6651274454681606`*^9, 3.665127462490714*^9}, {3.665132246173501*^9, 
   3.6651322753192806`*^9}, {3.8456379275593476`*^9, 3.845637942309226*^9}, {
   3.8456382551096888`*^9, 3.8456383502265387`*^9}, 3.8457109531281986`*^9},
 CellLabel->"In[92]:=",ExpressionUUID->"92847ee9-84ec-45e4-8786-b61aea887986"],

Cell[BoxData[
 RowBox[{"Image", "[", 
  RowBox[{"Show", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"Image", "[", "im", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "[", ".012", "]"}], ",", "Green", ",", 
       RowBox[{"PointImageCoordinates", "[", 
        RowBox[{"im", ",", "seeds"}], "]"}], ",", "Red", ",", 
       RowBox[{"PointImageCoordinates", "[", 
        RowBox[{"im", ",", "ends"}], "]"}]}], "}"}], "]"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"ImageSize", "\[Rule]", "512"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.845630378823061*^9, 3.845630380282443*^9}, {
  3.8456304887522087`*^9, 3.8456304902662606`*^9}, {3.845631347269568*^9, 
  3.8456313487907457`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"19916438-e529-484b-a336-0da868ff7988"],

Cell[CellGroupData[{

Cell["Determine centerline and orientation", "Subsection",
 CellChangeTimes->{{3.637662589973176*^9, 
  3.6376625969929295`*^9}},ExpressionUUID->"790a77c5-0dba-4a30-8761-\
212df252c596"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nrOfAveragePoints", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startAndBifurcationPoints", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Select", " ", "first", " ", "and", " ", "second", " ", "wall"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"trackFirstWall", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"\"\<firstWall\>\"", "/.", "#"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"trackSecondWall", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"\"\<secondWall\>\"", "/.", "#"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Average", " ", "both", " ", "walls", " ", "to", " ", "obtain", " ", 
          "center", " ", "points"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Make", " ", "a", " ", "list", " ", "of", " ", "the", " ", "first", 
          " ", "nrOfAveragePoints", " ", "center", " ", 
          RowBox[{"points", ":"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"centerPointList", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mean", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"First", "[", 
                 RowBox[{"Nearest", "[", 
                  RowBox[{"trackSecondWall", ",", "#"}], "]"}], "]"}]}], 
               "}"}], "]"}], "&"}], "@", 
            RowBox[{
            "trackFirstWall", "\[LeftDoubleBracket]", "pointNr", 
             "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"pointNr", ",", "1", ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Length", "[", "trackFirstWall", "]"}], ",", 
               "nrOfAveragePoints"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "From", " ", "this", " ", "list", " ", "compute", " ", "the", " ", 
           "average", " ", "direction", " ", "vector"}], ",", " ", 
          RowBox[{"and", " ", "corresponding", " ", "angle"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"averageVector", "=", 
         RowBox[{"Normalize", "@", 
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{"centerPointList", "\[LeftDoubleBracket]", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "-", 
            RowBox[{"centerPointList", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"averageAngle", "=", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
           "averageVector", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "averageVector", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Output", " ", "start", " ", "point"}], ",", " ", 
          RowBox[{"direction", " ", "vector", " ", "and", " ", "angle"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "centerPointList", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", "averageVector", ",", 
          "averageAngle"}], "}"}]}], ")"}], "&"}], ",", 
     "vesselAnnotationsData"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.637571376722161*^9, 3.6375714391064887`*^9}, {
   3.637572083999985*^9, 3.637572088769514*^9}, {3.637662151448311*^9, 
   3.637662153882971*^9}, 3.6651257693629274`*^9, {3.665133482924532*^9, 
   3.6651334839216113`*^9}, {3.8465592371607714`*^9, 3.846559238811222*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"24910327-fd9b-4064-80c8-d7684dd8cc2d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nrOfAveragePoints", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endPoints", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Select", " ", "first", " ", "and", " ", "second", " ", "wall"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"trackFirstWall", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"\"\<firstWall\>\"", "/.", "#"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"trackSecondWall", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"\"\<secondWall\>\"", "/.", "#"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Average", " ", "both", " ", "walls", " ", "to", " ", "obtain", " ", 
          "center", " ", "points"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Make", " ", "a", " ", "list", " ", "of", " ", "the", " ", "first", 
          " ", "nrOfAveragePoints", " ", "center", " ", 
          RowBox[{"points", ":"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"centerPointList", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mean", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"First", "[", 
                 RowBox[{"Nearest", "[", 
                  RowBox[{"trackSecondWall", ",", "#"}], "]"}], "]"}]}], 
               "}"}], "]"}], "&"}], "@", 
            RowBox[{
            "trackFirstWall", "\[LeftDoubleBracket]", "pointNr", 
             "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"pointNr", ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "trackFirstWall", "]"}], "-", 
                "nrOfAveragePoints", "+", "1"}], ",", "1"}], "]"}], ",", 
             RowBox[{"Length", "[", "trackFirstWall", "]"}], ",", "1"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "From", " ", "this", " ", "list", " ", "compute", " ", "the", " ", 
           "average", " ", "direction", " ", "vector"}], ",", " ", 
          RowBox[{"and", " ", "corresponding", " ", "angle"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"averageVector", "=", 
         RowBox[{"Normalize", "@", 
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{"centerPointList", "\[LeftDoubleBracket]", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "-", 
            RowBox[{"centerPointList", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"averageAngle", "=", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
           "averageVector", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "averageVector", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Output", " ", "start", " ", "point"}], ",", " ", 
          RowBox[{"direction", " ", "vector", " ", "and", " ", "angle"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"centerPointList", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
          "averageVector", ",", "averageAngle"}], "}"}]}], ")"}], "&"}], ",", 
     "endVessels"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.637571376722161*^9, 3.6375714391064887`*^9}, {
   3.6375714970443068`*^9, 3.637571510733118*^9}, 3.6375715541069317`*^9, 
   3.637571869331643*^9, {3.637571904850258*^9, 3.6375719098608217`*^9}, {
   3.637572073906564*^9, 3.6375720788098755`*^9}, {3.665133479661851*^9, 
   3.6651334810574455`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"e93cd8d6-977f-4869-b461-cf169e9e5158"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nrOfAveragePoints", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startPoints", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Select", " ", "first", " ", "and", " ", "second", " ", "wall"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"trackFirstWall", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"\"\<firstWall\>\"", "/.", "#"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"trackSecondWall", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"\"\<secondWall\>\"", "/.", "#"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Average", " ", "both", " ", "walls", " ", "to", " ", "obtain", " ", 
          "center", " ", "points"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Make", " ", "a", " ", "list", " ", "of", " ", "the", " ", "first", 
          " ", "nrOfAveragePoints", " ", "center", " ", 
          RowBox[{"points", ":"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"centerPointList", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mean", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"First", "[", 
                 RowBox[{"Nearest", "[", 
                  RowBox[{"trackSecondWall", ",", "#"}], "]"}], "]"}]}], 
               "}"}], "]"}], "&"}], "@", 
            RowBox[{
            "trackFirstWall", "\[LeftDoubleBracket]", "pointNr", 
             "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"pointNr", ",", "1", ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Length", "[", "trackFirstWall", "]"}], ",", 
               "nrOfAveragePoints"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "From", " ", "this", " ", "list", " ", "compute", " ", "the", " ", 
           "average", " ", "direction", " ", "vector"}], ",", " ", 
          RowBox[{"and", " ", "corresponding", " ", "angle"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"averageVector", "=", 
         RowBox[{"Normalize", "@", 
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{"centerPointList", "\[LeftDoubleBracket]", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "-", 
            RowBox[{"centerPointList", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"averageAngle", "=", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
           "averageVector", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "averageVector", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Output", " ", "start", " ", "point"}], ",", " ", 
          RowBox[{"direction", " ", "vector", " ", "and", " ", "angle"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "centerPointList", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", "averageVector", ",", 
          "averageAngle"}], "}"}]}], ")"}], "&"}], ",", "startVessels"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.637571376722161*^9, 3.6375714391064887`*^9}, {
  3.637572083999985*^9, 3.637572088769514*^9}, {3.637576301651916*^9, 
  3.637576303482267*^9}, {3.6651334758047094`*^9, 3.665133476842558*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"240eeb6f-7f2e-4d41-91d0-45cb7c9e2a09"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image", "[", "im", "]"}], "]"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
       RowBox[{"Arrow", "/@", 
        RowBox[{"Transpose", "/@", 
         RowBox[{"(", 
          RowBox[{"\"\<firstWall\>\"", "/.", "vesselAnnotations"}], 
          ")"}]}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
       RowBox[{"Arrow", "/@", 
        RowBox[{"Transpose", "/@", 
         RowBox[{"(", 
          RowBox[{"\"\<secondWall\>\"", "/.", "vesselAnnotations"}], 
          ")"}]}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.845635891540373*^9, 3.845635898255678*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"6cb53c12-6799-497d-8286-8cdfadc79b6a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Select upper half", "Section",
 CellChangeTimes->{{3.631418976560703*^9, 3.6314189813211336`*^9}, {
  3.665124670482873*^9, 3.665124677875822*^9}, {3.84597013150245*^9, 
  3.8459701320488524`*^9}, {3.846731501374965*^9, 3.8467315019407263`*^9}, {
  3.847791613317197*^9, 3.8477916136896114`*^9}, {3.871372119059407*^9, 
  3.8713721195452366`*^9}},ExpressionUUID->"942f5a5e-1754-422d-b548-\
57b081bfa039"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ySelect", "=", 
   RowBox[{"560", "/", "ds"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imhalf", "=", 
   RowBox[{"im", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", 
     RowBox[{";;", "ySelect"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maskhalf", "=", 
    RowBox[{"mask", "\[LeftDoubleBracket]", 
     RowBox[{";;", ",", 
      RowBox[{";;", "ySelect"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image", "[", "imhalf", "]"}], "]"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PlotVessel", "[", 
          RowBox[{"imhalf", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{"vesselAnnotationsData", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"Part", "[", 
               RowBox[{"VesselTrees", ",", "rowSelection"}], "]"}]}], ",", 
             RowBox[{"\"\<name\>\"", "/.", "#"}]}], "]"}], "&"}]}], "]"}]}]}],
       "}"}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
   RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.636355318406521*^9, 3.636355349164131*^9}, {
   3.6363554698248262`*^9, 3.636355491654749*^9}, {3.6363725867583313`*^9, 
   3.6363726013208914`*^9}, 3.6363774643521256`*^9, 3.6363780216915283`*^9, {
   3.6364304439847364`*^9, 3.6364304502977943`*^9}, {3.6375745760000887`*^9, 
   3.6375745860450387`*^9}, {3.637647626108798*^9, 3.637647641443409*^9}, {
   3.6376478227745934`*^9, 3.637647823036603*^9}, {3.6376478694577856`*^9, 
   3.637647870273777*^9}, {3.6376480592724824`*^9, 3.6376480767178745`*^9}, 
   3.6376664943201127`*^9, {3.637667931920068*^9, 3.6376679342667074`*^9}, {
   3.6651247418473225`*^9, 3.665124864065896*^9}, {3.665125769941083*^9, 
   3.665125770112968*^9}, {3.665133034537816*^9, 3.6651330749348125`*^9}, {
   3.828152243678896*^9, 3.828152243860917*^9}, {3.828152292828909*^9, 
   3.8281522953188434`*^9}, {3.828152340859226*^9, 3.8281523836736603`*^9}, {
   3.8281569299595327`*^9, 3.828156938150872*^9}, {3.8459696976236677`*^9, 
   3.8459697151597433`*^9}, {3.845969897680904*^9, 3.8459699048373733`*^9}, {
   3.845970140509101*^9, 3.845970149439086*^9}, {3.845970305003894*^9, 
   3.8459703339559317`*^9}, {3.8459708182524786`*^9, 3.845970845738792*^9}, {
   3.8459712287023745`*^9, 3.8459712542850013`*^9}, {3.8459716336025505`*^9, 
   3.8459716365321894`*^9}, {3.8459716727853374`*^9, 3.845971686331584*^9}, {
   3.8459841480134172`*^9, 3.8459841485300927`*^9}, {3.8459842623788676`*^9, 
   3.8459842749509273`*^9}, {3.846559310298853*^9, 3.846559348059552*^9}, {
   3.8465593916919117`*^9, 3.8465594233018193`*^9}, {3.847791609214791*^9, 
   3.847791630838023*^9}, {3.8477916801439595`*^9, 3.847791703399186*^9}, {
   3.8477922619918194`*^9, 3.8477922848453164`*^9}, {3.8522188158830657`*^9, 
   3.8522188335242834`*^9}, {3.9285668364295664`*^9, 
   3.9285668408847027`*^9}, {3.9285669105959387`*^9, 3.9285669255521765`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"67d94281-ed8f-4e2c-abeb-6cdadf1294d0"],

Cell[CellGroupData[{

Cell["Select seeds and end points", "Subsubsection",
 CellChangeTimes->{{3.6364354641650286`*^9, 3.636435466540027*^9}, {
  3.66513312005836*^9, 
  3.665133124464814*^9}},ExpressionUUID->"3b09db15-73bd-4f9c-b6dc-\
bee5c741d4fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"startAndBifurcationPoints", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"startAndBifurcationPoints", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "<=", "ySelect"}],
       "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startPoints", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"startPoints", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "<=", "ySelect"}],
       "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endPoints", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"endPoints", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "<=", "ySelect"}],
       "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6651331639992104`*^9, 3.6651332051617856`*^9}, {
  3.665133271614626*^9, 3.6651332727709093`*^9}, {3.6651333039379983`*^9, 
  3.6651333293099594`*^9}, {3.665133384391384*^9, 3.665133397285434*^9}, {
  3.6651334423014145`*^9, 3.6651334523676195`*^9}, {3.665133606935688*^9, 
  3.6651336143043256`*^9}, {3.845971700456517*^9, 3.845971709038146*^9}, {
  3.846559690045394*^9, 3.846559699067399*^9}, {3.847791712870341*^9, 
  3.847791719158642*^9}, {3.852218846881046*^9, 3.852218859067288*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"d201e261-6747-42b9-bf19-a0a591f664f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Show seeds", "Subsubsection",
 CellChangeTimes->{{3.6364354641650286`*^9, 
  3.636435466540027*^9}},ExpressionUUID->"d794eb85-9445-42f2-871d-\
e3804b665244"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotVessel", "[", 
   RowBox[{"im_", ",", "vessel_"}], "]"}], ":=", "\n", 
  RowBox[{"{", "\n", 
   RowBox[{
    RowBox[{"LineImageCoordinates", "[", 
     RowBox[{"im", ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"\"\<firstWall\>\"", "/.", "vessel"}], "]"}]}], "]"}], ",", 
    "\n", 
    RowBox[{"LineImageCoordinates", "[", 
     RowBox[{"im", ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"\"\<secondWall\>\"", "/.", "vessel"}], "]"}]}], "]"}]}], "\n",
    "}"}]}]], "Code",
 CellChangeTimes->{{3.665132626752398*^9, 3.665132638564038*^9}, {
  3.6651326952949867`*^9, 3.665132752191538*^9}, {3.6651328334133463`*^9, 
  3.665132843059987*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"15c2e4b1-98ff-4ef8-8ce8-de8399bcc584"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"seedsPointFig1", "=", 
   RowBox[{"{", 
    RowBox[{"Green", ",", 
     RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
     RowBox[{"PointImageCoordinates", "[", 
      RowBox[{"imhalf", ",", 
       RowBox[{"startAndBifurcationPoints", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seedsArrowFig1", "=", 
   RowBox[{"{", 
    RowBox[{"Green", ",", 
     RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
     RowBox[{"ArrowImageCoordinates", "[", 
      RowBox[{"imhalf", ",", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"startAndBifurcationPoints", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"startAndBifurcationPoints", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
           RowBox[{"10", "*", 
            RowBox[{"startAndBifurcationPoints", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}]}], 
         "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seedsPointFig2", "=", 
   RowBox[{"{", 
    RowBox[{"Green", ",", 
     RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
     RowBox[{"PointImageCoordinates", "[", 
      RowBox[{"imhalf", ",", 
       RowBox[{"startPoints", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seedsArrowFig2", "=", 
   RowBox[{"{", 
    RowBox[{"Green", ",", 
     RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
     RowBox[{"ArrowImageCoordinates", "[", 
      RowBox[{"imhalf", ",", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"startPoints", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"startPoints", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
           RowBox[{"10", "*", 
            RowBox[{"startPoints", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}]}], 
         "}"}]}]}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endsPointFig", "=", 
   RowBox[{"{", 
    RowBox[{"Red", ",", 
     RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
     RowBox[{"PointImageCoordinates", "[", 
      RowBox[{"imhalf", ",", 
       RowBox[{"endPoints", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"endsArrowFig", "=", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
      RowBox[{"ArrowImageCoordinates", "[", 
       RowBox[{"imhalf", ",", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"endPoints", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{"endPoints", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
            RowBox[{"10", "*", 
             RowBox[{"endPoints", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}]}], 
          "}"}]}]}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endVesselsFig", "=", 
   RowBox[{"{", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PlotVessel", "[", 
          RowBox[{"imhalf", ",", "#"}], "]"}], "&"}], "/@", "endVessels"}]}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vesselTreeFig", "=", 
   RowBox[{"{", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PlotVessel", "[", 
          RowBox[{"imhalf", ",", "#"}], "]"}], "&"}], "/@", 
        "vesselAnnotationsData"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6375733776930532`*^9, 3.6375733990538235`*^9}, {
   3.637573438748947*^9, 3.637573513384824*^9}, {3.6375739127589364`*^9, 
   3.6375739367832603`*^9}, {3.6375741156089892`*^9, 3.637574117987109*^9}, {
   3.637577757838523*^9, 3.6375777592760987`*^9}, 3.637647069102641*^9, {
   3.6376622145779233`*^9, 3.637662226233616*^9}, {3.637662688118195*^9, 
   3.6376627319202833`*^9}, {3.6376632397342668`*^9, 
   3.6376632409254665`*^9}, {3.665125769566063*^9, 3.6651257697535744`*^9}, {
   3.6651277884740453`*^9, 3.6651278594471617`*^9}, {3.665128055585786*^9, 
   3.665128059679647*^9}, {3.665128262043105*^9, 3.6651282835605736`*^9}, {
   3.665128350634693*^9, 3.6651284269356985`*^9}, {3.665128525495489*^9, 
   3.6651285713734837`*^9}, {3.6651323517010307`*^9, 3.665132508457713*^9}, {
   3.665132576212057*^9, 3.66513258850613*^9}, {3.6651326653865037`*^9, 
   3.6651326712932367`*^9}, {3.665132761758466*^9, 3.665132804195445*^9}, {
   3.665133635754176*^9, 3.665133710251813*^9}, {3.665133740869279*^9, 
   3.665133746311638*^9}, {3.8459717180748453`*^9, 3.845971734611884*^9}, {
   3.84597181069174*^9, 3.8459718399438057`*^9}, {3.8465594550559206`*^9, 
   3.8465594953194714`*^9}, {3.8477917551028943`*^9, 
   3.8477917661352243`*^9}, {3.8522188704621296`*^9, 3.852218883961944*^9}, {
   3.852221866919012*^9, 3.852221867563288*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"adc7ab47-dc60-4e91-b247-624b83d20aa7"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Image", "@", "imhalf"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
        "seedsPointFig1", ",", "seedsArrowFig1", ",", "endsPointFig", ",", 
         "endsArrowFig"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Image", "@", "imhalf"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
        "seedsPointFig2", ",", "seedsArrowFig2", ",", "endsPointFig", ",", 
         "endsArrowFig"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.637662696832557*^9, 3.6376626989471416`*^9}, {
  3.6376627426761923`*^9, 3.6376627565291605`*^9}, {3.6376632464549217`*^9, 
  3.6376632614114428`*^9}, {3.6651337260462713`*^9, 3.665133732119521*^9}, {
  3.8477917691905913`*^9, 3.8477917704455757`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"66f1bc5b-7568-4819-b647-7f037447da0b"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Image", "@", "imhalf"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"seedsPointFig1", ",", "seedsArrowFig1", ",", 
        RowBox[{"{", 
         RowBox[{"Cyan", ",", 
          RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{
             "seedsArrowFig1", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "seedsArrowFig2", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}]}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Cyan", ",", 
          RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"seedsPointFig1", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"seedsPointFig2", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}]}], "}"}], ",", "endsPointFig", ",", "endsArrowFig"}], "}"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8273953187454414`*^9, 3.8273953192966185`*^9}, {
  3.827395450367279*^9, 3.8273954505091033`*^9}, {3.827395561342625*^9, 
  3.827395569712604*^9}, {3.8273956184391727`*^9, 3.8273956844167695`*^9}, {
  3.827395725555234*^9, 3.827395794105155*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"a0f05e28-3db4-46a8-a302-903cf794a3a6"],

Cell[BoxData[
 RowBox[{"Image", "[", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Image", "@", "imhalf"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{"seedsPointFig1", ",", "seedsArrowFig1", ",", 
       RowBox[{"{", 
        RowBox[{"Cyan", ",", 
         RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{
            "seedsArrowFig1", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "seedsArrowFig2", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}]}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Cyan", ",", 
         RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"seedsPointFig1", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"seedsPointFig2", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
          "]"}]}], "}"}], ",", "endsPointFig", ",", "endsArrowFig"}], "}"}], 
     "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.928218735056015*^9, 3.9282187903882923`*^9}, 
   3.92855508859243*^9},
 CellLabel->
  "In[119]:=",ExpressionUUID->"d4c1ead0-b320-455f-bb5d-2302d55e2a28"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "imhalf", "]"}]], "Input",
 CellChangeTimes->{{3.928555344709578*^9, 3.928555349396022*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"6b560edf-3d4d-481b-ba11-a6616e35d97b"],

Cell[BoxData[
 RowBox[{"seedsNew", "=", 
  RowBox[{"Round", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "394"}], ")"}], "*", 
         RowBox[{
          RowBox[{"Dimensions", "[", "imhalf", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "720"}], ")"}], "*", 
         RowBox[{
          RowBox[{"Dimensions", "[", "imhalf", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"334", ",", "337"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"335", ",", "234"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"323", ",", "398"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"137", ",", "323"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"260", ",", "589"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"242", ",", "465"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"297", ",", "467"}], "}"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.928553860316137*^9, 3.9285538651435738`*^9}, {
   3.9285539292801228`*^9, 3.928553930383192*^9}, {3.9285541018250723`*^9, 
   3.9285541244784594`*^9}, 3.9285548313103113`*^9, {3.92855491988529*^9, 
   3.928554976583796*^9}, 3.9285552418571167`*^9, {3.928555595560065*^9, 
   3.9285556537985725`*^9}, {3.928555746903765*^9, 3.9285557576848283`*^9}, {
   3.9285558318048873`*^9, 3.9285558403863416`*^9}, {3.9285558934636745`*^9, 
   3.9285559033144627`*^9}, {3.9285563988817654`*^9, 3.928556402831438*^9}, 
   3.9285569614207926`*^9, {3.9285570720457306`*^9, 3.928557108380904*^9}, 
   3.9285574186408405`*^9, 3.9289858873860645`*^9, {3.928985940264618*^9, 
   3.928985950626294*^9}, {3.928994221700835*^9, 3.928994226112187*^9}, {
   3.928994351403162*^9, 3.928994365048978*^9}, {3.928994399206731*^9, 
   3.928994401567133*^9}, {3.928994483472516*^9, 3.9289944837832375`*^9}, {
   3.9289947124373045`*^9, 3.928994736060422*^9}, 3.9289948693362083`*^9, 
   3.9289949030603104`*^9, 3.9289952713674655`*^9, {3.9289954205419607`*^9, 
   3.92899542241302*^9}, 3.928995621682766*^9},
 CellLabel->
  "In[121]:=",ExpressionUUID->"b4a85317-1932-4494-ba03-550192634d4d"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Image", "@", "imhalf"}], ",", " ", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", " ", 
      RowBox[{"PointSize", "[", "0.01", "]"}], ",", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Dimensions", "[", "imhalf", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], "&"}], ",", 
        " ", "seedsNew"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.928554440450533*^9, 3.9285545332071505`*^9}, 
   3.9285546108961353`*^9, {3.928555933717395*^9, 3.9285559617483864`*^9}, {
   3.928556030780195*^9, 3.9285560354925013`*^9}, {3.9285562750589066`*^9, 
   3.9285562752120075`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"2b1b404e-e478-42b9-99cf-ac4548605851"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters", "Chapter",
 CellChangeTimes->{{3.871371970116836*^9, 
  3.871371971297967*^9}},ExpressionUUID->"34a4ddeb-8738-40df-aa4a-\
9710b6868cf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Metric", ":"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Mu]", " ", "=", " ", ".05"}], ";"}], "       ", 
   RowBox[{"(*", 
    RowBox[{"Stiffness", " ", "parameter"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[Epsilon]", "=", "10."}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"Anisotropy", " ", "parameter", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"for", " ", "sub"}], "-", 
        RowBox[{"Riemannian", " ", "case"}]}], ",", 
       RowBox[{"epsilon", "\[Rule]", "infty"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"beta", "-"}], ")"}], "isotropic", " ", "Riemannian", " ", 
         "case", " ", "epsilon"}], "=", "1"}]}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Volume", "/", "Image"}], " ", "dimensions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"No", " ", "=", " ", "32"}], ";"}], "         ", 
   RowBox[{"(*", 
    RowBox[{
    "Number", " ", "of", " ", "orientations", " ", "from", " ", "0", " ", 
     "to", " ", "periodicity"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"No", "=", "32"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"No", " ", "=", " ", "16"}], ";"}], "         ", 
    RowBox[{"(*", 
     RowBox[{
     "Number", " ", "of", " ", "orientations", " ", "from", " ", "0", " ", 
      "to", " ", "periodicity"}], "*)"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Nx", ",", "Ny"}], "}"}], "=", 
     RowBox[{"Dimensions", "[", "im", "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "Number", " ", "of", " ", "pixels", " ", "in", " ", "x", " ", "and", " ", 
     "y", " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Resolution", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"periodicity", " ", "=", " ", 
     RowBox[{"2", "Pi"}]}], ";"}], "           ", 
   RowBox[{"(*", 
    RowBox[{"Periodicity", ",", " ", 
     RowBox[{"=", 
      RowBox[{"Pi", " ", 
       RowBox[{"(", 
        RowBox[{
        "for", " ", "theta", " ", "from", " ", "0", " ", "to", " ", "1", " ", 
         "Pi"}], ")"}]}]}], ",", " ", 
     RowBox[{"or", " ", "=", 
      RowBox[{"2", "Pi", " ", 
       RowBox[{"(", 
        RowBox[{
        "for", " ", "theta", " ", "from", " ", "0", " ", "to", " ", "2", " ", 
         "Pi"}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s\[Theta]", " ", "=", " ", 
     RowBox[{"periodicity", "/", "No"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"Angular", " ", "resolution"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"sx", " ", "=", " ", "1"}], ";"}], "          ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Spatial", " ", "resolution"}], ",", " ", 
     StyleBox[
      RowBox[{"not", " ", "used", " ", "in", " ", "this", " ", "notebook"}],
      FontColor->RGBColor[0.6, 0.4, 0.2]], 
     StyleBox[",",
      FontColor->RGBColor[0.6, 0.4, 0.2]], 
     StyleBox[" ",
      FontColor->RGBColor[0.6, 0.4, 0.2]], 
     StyleBox[
      RowBox[{
       RowBox[{"every", " ", "sx"}], "=", 
       RowBox[{"1", " ", "is", " ", "assumed"}]}],
      FontColor->RGBColor[0.6, 0.4, 0.2]]}], "*)"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Set", " ", "Options"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"SE2FiniteDifferences", ",", 
      RowBox[{"\"\<Periodicity\>\"", "->", " ", 
       RowBox[{"(", "periodicity", ")"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"os", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"No", ",", "ySelect", ",", "Ny"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.624945131553623*^9, 3.6249451319208727`*^9}, {
   3.624945161985224*^9, 3.6249451653214817`*^9}, 3.624949614870289*^9, 
   3.624949740445407*^9, {3.624950364090351*^9, 3.6249503898908143`*^9}, 
   3.624950448650448*^9, {3.624950495165639*^9, 3.624950495217674*^9}, 
   3.6249508409889708`*^9, 3.6249513022397013`*^9, 3.624954676615217*^9, 
   3.624954748031515*^9, 3.6249693732948637`*^9, 3.6249694658379197`*^9, {
   3.6250317012872024`*^9, 3.6250317257559805`*^9}, 3.6250318301436987`*^9, 
   3.625040271516988*^9, 3.6251176337634983`*^9, 3.6252147537220798`*^9, 
   3.6252169915145626`*^9, 3.625218649872223*^9, {3.6252195690869074`*^9, 
   3.625219569182971*^9}, 3.6252203329985323`*^9, {3.625222628031225*^9, 
   3.625222632710331*^9}, 3.625222986312934*^9, {3.6252249799362917`*^9, 
   3.625225002900473*^9}, 3.6252257342036953`*^9, 3.625228907361856*^9, 
   3.625231694897396*^9, {3.6252821840401955`*^9, 3.625282185422537*^9}, {
   3.625315802167776*^9, 3.625315802402194*^9}, {3.62531829713197*^9, 
   3.6253182972100706`*^9}, {3.62531993484264*^9, 3.6253199349363937`*^9}, 
   3.6253323826524377`*^9, {3.625366737346525*^9, 3.6253667379559355`*^9}, {
   3.6253712732587986`*^9, 3.62537128107899*^9}, 3.625372707968023*^9, 
   3.6253730341067*^9, {3.6253734033956156`*^9, 3.625373411256999*^9}, 
   3.6253741062261734`*^9, 3.625374385428779*^9, {3.625374567222395*^9, 
   3.6253745857149935`*^9}, 3.625374672888541*^9, {3.6253780802830095`*^9, 
   3.625378084841679*^9}, {3.6254039987916765`*^9, 3.625404079486368*^9}, {
   3.6254619483342047`*^9, 3.6254619804620404`*^9}, {3.6254629383582172`*^9, 
   3.625462940037594*^9}, {3.6254631896831427`*^9, 3.6254632078090363`*^9}, {
   3.625463281825509*^9, 3.625463292732304*^9}, 3.6254696802733526`*^9, {
   3.6254697138537893`*^9, 3.625469725713749*^9}, {3.625469797811081*^9, 
   3.6254697993267794`*^9}, 3.625470239100869*^9, 3.625478532675105*^9, {
   3.625478683778561*^9, 3.6254786838566647`*^9}, 3.6254788103501225`*^9, {
   3.6254789061159143`*^9, 3.625478908303775*^9}, 3.6254794202212963`*^9, 
   3.6254891519277*^9, 3.6254892740287657`*^9, {3.6255497394376564`*^9, 
   3.625549739884958*^9}, {3.6255499669171844`*^9, 3.6255499669802265`*^9}, 
   3.6255502590342693`*^9, {3.625550405024269*^9, 3.6255504080562844`*^9}, 
   3.62598559597268*^9, 3.6260713353133307`*^9, 3.6260720756429687`*^9, 
   3.626072819563247*^9, 3.62607881727878*^9, {3.6260789303922963`*^9, 
   3.6260789304704213`*^9}, {3.626079705711183*^9, 3.626079706711237*^9}, {
   3.6260803562298074`*^9, 3.626080369714921*^9}, {3.6260806031712523`*^9, 
   3.6260806037494555`*^9}, {3.6260823824095097`*^9, 3.62608238598782*^9}, {
   3.626093124928266*^9, 3.626093125615822*^9}, {3.626096489332111*^9, 
   3.626096490550897*^9}, {3.6260971478535967`*^9, 3.6260971484786463`*^9}, 
   3.626582258752741*^9, 3.6265824941337414`*^9, 3.6266116310346603`*^9, {
   3.6266658553890424`*^9, 3.6266658554610424`*^9}, 3.6266661871520424`*^9, {
   3.626666975102042*^9, 3.626666975885042*^9}, {3.628321858397415*^9, 
   3.628321891301302*^9}, {3.628326418056525*^9, 3.6283264181503043`*^9}, 
   3.6283281212149243`*^9, {3.634569243861385*^9, 3.6345692449406004`*^9}, 
   3.6352394908693237`*^9, {3.635244735846283*^9, 3.63524474114318*^9}, {
   3.6352448562852387`*^9, 3.6352449382764854`*^9}, {3.6352449755115004`*^9, 
   3.635245061105542*^9}, {3.635245331811201*^9, 3.6352453319205775`*^9}, {
   3.635246850280826*^9, 3.6352468503433237`*^9}, {3.6352468866090317`*^9, 
   3.6352468866715317`*^9}, {3.6352485344825935`*^9, 3.635248535388919*^9}, {
   3.6352511711630383`*^9, 3.635251171241164*^9}, {3.635251305310001*^9, 
   3.6352513088725133`*^9}, 3.63525353712506*^9, {3.6352543950282993`*^9, 
   3.6352543953095503`*^9}, 3.635254901968296*^9, {3.635255177782792*^9, 
   3.635255177845235*^9}, 3.635481310074271*^9, {3.636180012859438*^9, 
   3.6361800190836782`*^9}, 3.636182433469011*^9, {3.636182680495011*^9, 
   3.6361826805730104`*^9}, 3.6361829477542105`*^9, {3.63618312329648*^9, 
   3.6361831254023585`*^9}, {3.6361899350223627`*^9, 3.6361899363015547`*^9}, 
   3.636193066507264*^9, {3.6362667641064386`*^9, 3.6362667675908422`*^9}, {
   3.636266803520385*^9, 3.6362668035359435`*^9}, 3.636268192702372*^9, {
   3.636363668059152*^9, 3.636363668106043*^9}, {3.6363774501299086`*^9, 
   3.636377451009323*^9}, {3.827550779430331*^9, 3.8275507829448967`*^9}, {
   3.827640573599739*^9, 3.8276405749658613`*^9}, {3.827811047316004*^9, 
   3.8278110483047514`*^9}, {3.828152456307746*^9, 3.828152467898822*^9}, {
   3.8281569880972915`*^9, 3.8281569918671074`*^9}, {3.8286055872485504`*^9, 
   3.82860558968379*^9}, {3.8319944814955378`*^9, 3.8319944894840555`*^9}, {
   3.871374355389465*^9, 3.871374373192091*^9}, {3.8714658019157953`*^9, 
   3.871465802299467*^9}, 3.8714658378159704`*^9, {3.8714659243158965`*^9, 
   3.871465925495992*^9}, 3.8714659845191936`*^9, {3.871466177579902*^9, 
   3.8714661786383853`*^9}, {3.927612942791539*^9, 3.9276129877480073`*^9}, {
   3.928217697319748*^9, 3.9282176985303526`*^9}, {3.9285696037219315`*^9, 
   3.928569604323822*^9}, {3.9285702104662232`*^9, 3.928570210751706*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"5f75c1d1-87f1-4506-b00d-9f4d6ad9527b"]
}, Closed]],

Cell[CellGroupData[{

Cell["From end points to start points on lifted vessel trees", "Chapter",
 CellChangeTimes->{{3.8713742882773046`*^9, 
  3.8713743127096663`*^9}},ExpressionUUID->"f2cf6634-0cb7-43dc-b16f-\
e6b62cf551f3"],

Cell[CellGroupData[{

Cell["Coordinate conversion", "Subsection",
 CellChangeTimes->{{3.6364356019938498`*^9, 
  3.6364356064314165`*^9}},ExpressionUUID->"1d24b0c7-bf80-4a41-a197-\
d54e551aab3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedPointConversionGraphicsToArray", "[", 
   RowBox[{
   "g0_", ",", "Nx_", ",", "Ny_", ",", "s\[Theta]_", ",", "periodicity_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"periodicity", "/", "s\[Theta]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", "Nx", ",", "1"}], "]"}], ",", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ",", "Ny", ",", "1"}], "]"}]}], "}"}], "&"}], "@", 
   RowBox[{"Round", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g0", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
          ")"}], "/", "s\[Theta]"}], "+", "1"}], ",", 
      RowBox[{"g0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"g0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     "}"}]}]}]}]], "Code",
 CellChangeTimes->{{3.6364337668468122`*^9, 3.636433835249631*^9}, {
  3.6651356369876966`*^9, 3.6651356444869556`*^9}, {3.6651356962560973`*^9, 
  3.665135696927986*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"a2413ffe-6e3c-4240-be97-8324c1a98fa2"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "startAndBifurcationPoints", "]"}]], "Input",
 CellChangeTimes->{{3.665135443960734*^9, 3.665135445152845*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"69f14586-f522-4d94-bb71-a269bc245a4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g0ListStartAndBifurcation", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Flatten", ",", 
     RowBox[{"startAndBifurcationPoints", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g1ListEnd", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Flatten", ",", 
      RowBox[{"endPoints", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g0dListStartAndBifurcation", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SeedPointConversionGraphicsToArray", "[", 
       RowBox[{
       "#", ",", "Nx", ",", "Ny", ",", "s\[Theta]", ",", "periodicity"}], 
       "]"}], "&"}], ",", "g0ListStartAndBifurcation", ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g1dListEnd", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SeedPointConversionGraphicsToArray", "[", 
       RowBox[{
       "#", ",", "Nx", ",", "Ny", ",", "s\[Theta]", ",", "periodicity"}], 
       "]"}], "&"}], ",", "g1ListEnd", ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.636433652329668*^9, 3.636433694002096*^9}, {
  3.63643373233078*^9, 3.6364337491903777`*^9}, {3.6376618496451197`*^9, 
  3.637661885017646*^9}, {3.6376626272726645`*^9, 3.637662628227087*^9}, {
  3.6376629292713966`*^9, 3.6376629296435785`*^9}, {3.665133786113971*^9, 
  3.6651337867051764`*^9}, {3.665133824789706*^9, 3.6651338295961237`*^9}, {
  3.6651338740696697`*^9, 3.6651338996257715`*^9}, {3.6651339826886*^9, 
  3.6651339864148445`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"0f80ebb3-33e1-44c0-ac4d-a9d4a9693b45"],

Cell[CellGroupData[{

Cell["Determine centerline and orientations of centerline", "Subsubsection",
 CellChangeTimes->{{3.6379164064157114`*^9, 
  3.6379164144033766`*^9}},ExpressionUUID->"6c918c77-536a-40c4-99df-\
1a4d1bfec620"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nrOfAveragePoints", "=", "8"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"should", " ", "be", " ", "even"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"centerlinesAndAngles", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Select", " ", "first", " ", "and", " ", "second", " ", "wall"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"trackFirstWall", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"\"\<firstWall\>\"", "/.", "#"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"trackSecondWall", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"\"\<secondWall\>\"", "/.", "#"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Average", " ", "both", " ", "walls", " ", "to", " ", "obtain", " ", 
          "center", " ", "points"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Make", " ", "a", " ", "list", " ", "of", " ", "the", " ", "center", 
          " ", 
          RowBox[{"points", ":"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"centerPointList", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mean", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"First", "[", 
                 RowBox[{"Nearest", "[", 
                  RowBox[{"trackSecondWall", ",", "#"}], "]"}], "]"}]}], 
               "}"}], "]"}], "&"}], "@", 
            RowBox[{
            "trackFirstWall", "\[LeftDoubleBracket]", "pointNr", 
             "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"pointNr", ",", "1", ",", 
             RowBox[{"Length", "[", "trackFirstWall", "]"}], ",", "1"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "From", " ", "this", " ", "list", " ", "compute", " ", "the", " ", 
           "average", " ", "direction", " ", "vector"}], ",", " ", 
          RowBox[{"and", " ", "corresponding", " ", "angle"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "centerPointList", "]"}], "<", 
           "nrOfAveragePoints"}], ",", "\[IndentingNewLine]", 
          RowBox[{"averageVectors", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"Normalize", "[", 
              RowBox[{
               RowBox[{
               "centerPointList", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "-", 
               RowBox[{"centerPointList", "\[LeftDoubleBracket]", 
                RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
             RowBox[{"Length", "[", "centerPointList", "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"averageVectors", "=", 
            RowBox[{"Normalize", "/@", 
             RowBox[{"ListConvolve", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 FractionBox[
                  RowBox[{"{", "1", "}"}], "nrOfAveragePoints"], ",", 
                 RowBox[{"{", "nrOfAveragePoints", "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"centerPointList", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ";;", 
                  RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "-", 
                RowBox[{"centerPointList", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ";;", 
                  RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}]}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"averageVectors", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                "averageVectors", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Floor", "[", 
                  FractionBox["nrOfAveragePoints", "2"], "]"}], "}"}]}], 
               "]"}], ",", "averageVectors", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"averageVectors", "\[LeftDoubleBracket]", 
                 RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Floor", "[", 
                  FractionBox["nrOfAveragePoints", "2"], "]"}], "}"}]}], 
               "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"averageAngle", "=", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{"averageVectors", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"averageVectors", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Output", " ", "start", " ", "point"}], ",", " ", 
          RowBox[{"direction", " ", "vector", " ", "and", " ", "angle"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Flatten", "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"centerPointList", ",", "averageAngle"}], "}"}], "]"}]}]}],
        ")"}], "&"}], ",", "vesselAnnotationsData"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.637571376722161*^9, 3.6375714391064887`*^9}, {
   3.6375714970443068`*^9, 3.637571510733118*^9}, 3.6375715541069317`*^9, 
   3.637571869331643*^9, {3.637571904850258*^9, 3.6375719098608217`*^9}, {
   3.637572073906564*^9, 3.6375720788098755`*^9}, {3.637649949821848*^9, 
   3.6376499886374035`*^9}, {3.6376501731113033`*^9, 3.637650371667511*^9}, 
   3.6376504619003067`*^9, {3.6376505202390757`*^9, 3.6376505399124737`*^9}, {
   3.6376507972493343`*^9, 3.6376508146234455`*^9}, {3.6376508941010833`*^9, 
   3.6376508942972355`*^9}, {3.6376509250776167`*^9, 3.637650926084341*^9}, {
   3.6376510252590656`*^9, 3.6376510387065787`*^9}, {3.637651071317529*^9, 
   3.6376511324717064`*^9}, {3.637651199479637*^9, 3.6376512458124204`*^9}, {
   3.6376515352181773`*^9, 3.6376515401685133`*^9}, {3.6376516982364764`*^9, 
   3.6376517393934407`*^9}, 3.665125770316044*^9, 3.66513429040596*^9, {
   3.6651355573653545`*^9, 3.6651355584122887`*^9}, {3.66513561904144*^9, 
   3.6651356198383427`*^9}, 3.852219377530529*^9, 3.85221951072491*^9},
 CellLabel->
  "In[138]:=",ExpressionUUID->"c828423d-759c-4cfc-8b59-c102cc844862"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"centerlinesAndAngles", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SeedPointConversionGraphicsToArray", "[", 
       RowBox[{
       "#", ",", "Nx", ",", "Ny", ",", "s\[Theta]", ",", "periodicity"}], 
       "]"}], "&"}], ",", "centerlinesAndAngles", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"seedsIndex", "=", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SeedPointConversionGraphicsToArray", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], ",", "Nx", ",", "Ny", ",", 
          "s\[Theta]", ",", "periodicity"}], "]"}], "&"}], ",", "seeds"}], 
      "]"}], "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", 
      RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"centerlinesAndAngles", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "<", "ySelect"}], "&"}]}], "]"}], "&"}], "/@", 
    "centerlinesAndAngles"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seedsIndex", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"seedsIndex", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "<", "ySelect"}], "&"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.637651834673237*^9, 3.6376518392465067`*^9}, {
   3.637661485392063*^9, 3.637661537733298*^9}, {3.6376615722566257`*^9, 
   3.63766157381209*^9}, {3.6651343275260973`*^9, 3.6651343378583746`*^9}, {
   3.6651343744392853`*^9, 3.6651344484344425`*^9}, 3.6651346359545555`*^9, {
   3.8459724418731155`*^9, 3.845972448989989*^9}, {3.8459724999003706`*^9, 
   3.845972506186886*^9}, {3.845972594987457*^9, 3.8459725975180984`*^9}, {
   3.845972786544052*^9, 3.8459727878267417`*^9}, {3.8459728836310854`*^9, 
   3.8459728850268545`*^9}, {3.846559845241331*^9, 3.846559847583546*^9}, {
   3.84779201476608*^9, 3.8477920167012525`*^9}, {3.852218955991128*^9, 
   3.852218963882434*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"21efcc76-89bd-4a76-ab8f-a3437d6e67b7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Select points", "Subsection",
 CellChangeTimes->{{3.637657683292612*^9, 
  3.6376576855526075`*^9}},ExpressionUUID->"447d80d8-c07a-46b5-8d46-\
fe5c1b1c4916"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g0ListTiers", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Flatten", ",", 
     RowBox[{"startPoints", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g1ListTiers", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Flatten", ",", 
     RowBox[{"endPoints", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.636433652329668*^9, 3.636433694002096*^9}, {
  3.63643373233078*^9, 3.6364337491903777`*^9}, {3.6651337903040724`*^9, 
  3.6651337909447775`*^9}, {3.6651345458192797`*^9, 3.6651345622340174`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"c280649e-db11-43bb-a61a-5f2edaae149e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g0dListTiers", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SeedPointConversionGraphicsToArray", "[", 
       RowBox[{
       "#", ",", "Nx", ",", "Ny", ",", "s\[Theta]", ",", "periodicity"}], 
       "]"}], "&"}], ",", "g0ListTiers"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g1dListTiers", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SeedPointConversionGraphicsToArray", "[", 
       RowBox[{
       "#", ",", "Nx", ",", "Ny", ",", "s\[Theta]", ",", "periodicity"}], 
       "]"}], "&"}], ",", "g1ListTiers"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6364338419527936`*^9, 3.636433871640727*^9}, {
  3.6651345502023077`*^9, 3.665134555374387*^9}, {3.6651357204043593`*^9, 
  3.6651357210137515`*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"5f4c821f-5ce2-4f78-8263-b952988c68f9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculate Ground Truth Cost Function", "Chapter",
 CellChangeTimes->{{3.87137192293781*^9, 3.8713719274337025`*^9}, {
  3.8713736891815443`*^9, 
  3.8713736930868835`*^9}},ExpressionUUID->"185074f2-58aa-4893-abbc-\
576795ecb0c9"],

Cell[CellGroupData[{

Cell["\<\
Create lift by placing delta peaks at the centerline position and orientation\
\>", "Section",
 CellChangeTimes->{{3.6379164064157114`*^9, 3.637916458682798*^9}, {
  3.637987042429432*^9, 
  3.63798704457016*^9}},ExpressionUUID->"23acdb82-1568-468e-8f62-\
37a8a5c1c479"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"radiusBlurFilter", "=", "2"}], 
  RowBox[{"(*", "2", "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lift", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"No", ",", "Nx", ",", "Ny"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"lift", "\[LeftDoubleBracket]", 
         RowBox[{"Sequence", "@@", "#"}], "\[RightDoubleBracket]"}], "=", 
        "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "<=", 
          FractionBox["No", "2"]}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"lift", "\[LeftDoubleBracket]", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{"#", "+", 
               RowBox[{"{", 
                RowBox[{
                 FractionBox["No", "2"], ",", "0", ",", "0"}], "}"}]}], 
              ")"}]}], "\[RightDoubleBracket]"}], "=", "1"}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"lift", "\[LeftDoubleBracket]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{"#", "-", 
              RowBox[{"{", 
               RowBox[{
                FractionBox["No", "2"], ",", "0", ",", "0"}], "}"}]}], 
             ")"}]}], "\[RightDoubleBracket]"}], "=", "1"}]}], "]"}]}], ")"}],
      "&"}], ",", "\[IndentingNewLine]", "centerlinesAndAngles", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"lift", "=", 
     RowBox[{"GaussianFilter", "[", 
      RowBox[{"lift", ",", "radiusBlurFilter"}], "]"}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6376505703874693`*^9, 3.6376505929318256`*^9}, {
   3.637650677855898*^9, 3.6376507235525694`*^9}, {3.6376513060220947`*^9, 
   3.637651347187981*^9}, 3.637651847137966*^9, {3.6376518977843504`*^9, 
   3.637651909873603*^9}, {3.637657211868204*^9, 3.637657226071316*^9}, {
   3.637657590400847*^9, 3.6376575925459037`*^9}, {3.637667637908661*^9, 
   3.6376676518378325`*^9}, {3.637916393679236*^9, 3.6379164221609726`*^9}, {
   3.637987126745903*^9, 3.6379871444498625`*^9}, 3.82781109452129*^9, {
   3.8278111317119875`*^9, 3.82781113279117*^9}, {3.827813661850422*^9, 
   3.827813662308159*^9}, 3.828152563199275*^9, 3.828605620229334*^9, {
   3.9104244937605543`*^9, 3.9104245018195763`*^9}, 3.9104283021906815`*^9, 
   3.910430451913012*^9, {3.9108519888344927`*^9, 3.9108519899980693`*^9}, {
   3.9229555761248035`*^9, 3.922955581414219*^9}, 3.9276163509700937`*^9},
 CellLabel->
  "In[148]:=",ExpressionUUID->"a50e7429-70b8-4266-9496-7966f2eaf57b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"liftElevator", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"No", ",", "Nx", ",", "Ny"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"liftElevator", "\[LeftDoubleBracket]", 
         RowBox[{"Sequence", "@@", "#"}], "\[RightDoubleBracket]"}], "=", 
        "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "<=", 
          RowBox[{"No", "/", "2"}]}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"liftElevator", "\[LeftDoubleBracket]", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{"#", "+", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"No", "/", "2"}], ",", "0", ",", "0"}], "}"}]}], 
              ")"}]}], "\[RightDoubleBracket]"}], "=", "1"}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"liftElevator", "\[LeftDoubleBracket]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{"#", "-", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"No", "/", "2"}], ",", "0", ",", "0"}], "}"}]}], 
             ")"}]}], "\[RightDoubleBracket]"}], "=", "1"}]}], "]"}]}], ")"}],
      "&"}], ",", "\[IndentingNewLine]", "centerlinesAndAngles", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"liftElevator", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{"Sequence", "@@", "#"}]}], "\[RightDoubleBracket]"}], "=", 
       "1"}], ";"}], "&"}], ",", "seedsIndex"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"liftElevator", "=", 
     RowBox[{"GaussianFilter", "[", 
      RowBox[{"liftElevator", ",", "radiusBlurFilter"}], "]"}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6376505703874693`*^9, 3.6376505929318256`*^9}, {
   3.637650677855898*^9, 3.6376507235525694`*^9}, {3.6376513060220947`*^9, 
   3.637651347187981*^9}, 3.637651847137966*^9, {3.6376518977843504`*^9, 
   3.637651909873603*^9}, {3.637657211868204*^9, 3.637657226071316*^9}, {
   3.637657590400847*^9, 3.6376575925459037`*^9}, {3.637661451590773*^9, 
   3.6376614752931576`*^9}, {3.6376615440990224`*^9, 3.637661544629841*^9}, {
   3.6376615763082895`*^9, 3.637661598405514*^9}, {3.637666652553603*^9, 
   3.637666652678602*^9}, {3.6376673936491594`*^9, 3.637667493914549*^9}, {
   3.6376675560524125`*^9, 3.6376675656726313`*^9}, 3.6376676152477036`*^9, {
   3.637987123386367*^9, 3.637987147387498*^9}, 3.910424523736122*^9, 
   3.927616354054573*^9},
 CellLabel->
  "In[151]:=",ExpressionUUID->"d3ff47c3-ceec-49c1-b315-66458e7d9f18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"liftElevatorBifurcations", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"No", ",", "Nx", ",", "Ny"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"liftElevatorBifurcations", "\[LeftDoubleBracket]", 
         RowBox[{"Sequence", "@@", "#"}], "\[RightDoubleBracket]"}], "=", 
        "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "<=", 
          RowBox[{"No", "/", "2"}]}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"liftElevatorBifurcations", "\[LeftDoubleBracket]", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{"#", "+", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"No", "/", "2"}], ",", "0", ",", "0"}], "}"}]}], 
              ")"}]}], "\[RightDoubleBracket]"}], "=", "1"}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"liftElevatorBifurcations", "\[LeftDoubleBracket]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{"#", "-", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"No", "/", "2"}], ",", "0", ",", "0"}], "}"}]}], 
             ")"}]}], "\[RightDoubleBracket]"}], "=", "1"}]}], "]"}]}], ")"}],
      "&"}], ",", "\[IndentingNewLine]", "centerlinesAndAngles", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"liftElevatorBifurcations", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{"Sequence", "@@", "#"}]}], "\[RightDoubleBracket]"}], "=", 
       "2"}], ";"}], "&"}], ",", "seedsIndex"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"liftElevatorBifurcations", "=", 
     RowBox[{"Rescale", "[", 
      RowBox[{"GaussianFilter", "[", 
       RowBox[{"liftElevatorBifurcations", ",", "radiusBlurFilter"}], "]"}], 
      "]"}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6376505703874693`*^9, 3.6376505929318256`*^9}, {
   3.637650677855898*^9, 3.6376507235525694`*^9}, {3.6376513060220947`*^9, 
   3.637651347187981*^9}, 3.637651847137966*^9, {3.6376518977843504`*^9, 
   3.637651909873603*^9}, {3.637657211868204*^9, 3.637657226071316*^9}, {
   3.637657590400847*^9, 3.6376575925459037`*^9}, {3.637661451590773*^9, 
   3.6376614752931576`*^9}, {3.6376615440990224`*^9, 3.637661544629841*^9}, {
   3.6376615763082895`*^9, 3.637661598405514*^9}, {3.637666652553603*^9, 
   3.637666652678602*^9}, {3.6376673936491594`*^9, 3.637667493914549*^9}, {
   3.6376675560524125`*^9, 3.6376675656726313`*^9}, 3.6376676152477036`*^9, {
   3.637987123386367*^9, 3.637987147387498*^9}, {3.831568414886436*^9, 
   3.83156843402491*^9}, {3.83156850196632*^9, 3.8315685177867603`*^9}, {
   3.8315685634704256`*^9, 3.8315685968756104`*^9}, 3.91042453245315*^9, 
   3.92761636037718*^9},
 CellLabel->
  "In[154]:=",ExpressionUUID->"fc6afbf8-5d07-43f5-b391-305f75ba7be5"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Image3D", "[", 
      RowBox[{"lift", ",", 
       RowBox[{"BoxRatios", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "0.5"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"Image3D", "[", 
      RowBox[{"liftElevator", ",", 
       RowBox[{"BoxRatios", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "0.5"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"Image3D", "[", 
      RowBox[{"liftElevatorBifurcations", ",", 
       RowBox[{"BoxRatios", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "0.5"}], "}"}]}]}], "]"}]}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", "300"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.637657268821263*^9, {3.6376573236261787`*^9, 3.6376573522007265`*^9}, {
   3.637661613446001*^9, 3.637661616023898*^9}, {3.6379870625866203`*^9, 
   3.637987093134943*^9}, {3.637987222640225*^9, 3.637987225577823*^9}, {
   3.6379872853923063`*^9, 3.6379872880330753`*^9}, {3.6651232231491547`*^9, 
   3.6651232236803875`*^9}, {3.8315684439637895`*^9, 3.831568448536682*^9}, {
   3.8316334769349704`*^9, 3.8316334821598387`*^9}, 3.856494293040949*^9},
 CellLabel->
  "In[157]:=",ExpressionUUID->"d2949db6-008f-4fd9-94d3-5796e6307c1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct cost", "Section",
 CellChangeTimes->{{3.637916481561216*^9, 
  3.6379164833499985`*^9}},ExpressionUUID->"f6ef710c-a3c1-4bc2-bc79-\
c2a0235ae6dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]", "=", "400"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"Rescale", "[", "lift", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costLift", "=", 
   FractionBox["1", 
    RowBox[{"1", "+", 
     RowBox[{"\[Lambda]", " ", 
      SuperscriptBox["V", 
       RowBox[{"p", " "}]]}]}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.637657513369492*^9, 3.637657529720753*^9}, {
  3.6376584133584585`*^9, 3.637658413576046*^9}, {3.6376584862070875`*^9, 
  3.637658488992645*^9}, {3.8275503555082564`*^9, 3.82755035555513*^9}, {
  3.827550518073368*^9, 3.827550518113578*^9}, {3.8280657089371815`*^9, 
  3.8280657095065513`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"b0081a05-ff0e-4057-9075-6dfd4928739f"],

Cell[BoxData[
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"Image", "[", 
      RowBox[{"imhalf", ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ",", 
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"Image", "[", 
      RowBox[{
       RowBox[{
       "costLift", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ",", 
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"Image", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Min", ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"costLift", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ",", 
    RowBox[{"Image3D", "[", 
     RowBox[{
      RowBox[{"Rescale", "[", 
       RowBox[{"-", "costLift"}], "]"}], ",", 
      RowBox[{"BoxRatios", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0.5"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.637657555299677*^9, 3.6376575653436995`*^9}, {
  3.6376578507257237`*^9, 3.637657853445543*^9}, {3.665134471977529*^9, 
  3.665134472477547*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"fd7726dd-b980-4d64-98bc-6283c9f61c6e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]", "=", "400"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"Rescale", "[", "liftElevator", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costLiftElevator", "=", 
   FractionBox["1", 
    RowBox[{"1", "+", 
     RowBox[{"\[Lambda]", " ", 
      SuperscriptBox["V", 
       RowBox[{"p", " "}]]}]}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.637657513369492*^9, 3.637657529720753*^9}, {
   3.6376584133584585`*^9, 3.637658413576046*^9}, {3.6376584862070875`*^9, 
   3.637658488992645*^9}, {3.637661639989121*^9, 3.6376616460463066`*^9}, {
   3.8275506064411526`*^9, 3.8275506094663534`*^9}, 3.8275506953651385`*^9, {
   3.8275509202371597`*^9, 3.8275509210903344`*^9}, 3.8275831660718727`*^9},
 CellLabel->
  "In[163]:=",ExpressionUUID->"c1b44ee4-025f-4de6-9350-29518cf00814"],

Cell[BoxData[
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"Image", "[", 
      RowBox[{"imhalf", ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ",", 
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"Image", "[", 
      RowBox[{
       RowBox[{
       "costLiftElevator", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ",", 
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"Image", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Min", ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"costLiftElevator", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ",", 
    RowBox[{"Image3D", "[", 
     RowBox[{
      RowBox[{"Rescale", "[", 
       RowBox[{"-", "costLiftElevator"}], "]"}], ",", 
      RowBox[{"BoxRatios", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "0.2"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.637657555299677*^9, 3.6376575653436995`*^9}, {
  3.6376578507257237`*^9, 3.637657853445543*^9}, {3.63766166225002*^9, 
  3.6376616732018642`*^9}, {3.665134479552128*^9, 3.6651344805052376`*^9}, {
  3.8281517333281717`*^9, 3.828151746690529*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"600ff998-a388-47fd-989e-1c6a2c8f73c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]", "=", "400"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"Rescale", "[", "liftElevatorBifurcations", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costLiftElevatorBifurcations", "=", 
   FractionBox["1", 
    RowBox[{"1", "+", 
     RowBox[{"\[Lambda]", " ", 
      SuperscriptBox["V", 
       RowBox[{"p", " "}]]}]}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.637657513369492*^9, 3.637657529720753*^9}, {
   3.6376584133584585`*^9, 3.637658413576046*^9}, {3.6376584862070875`*^9, 
   3.637658488992645*^9}, {3.637661639989121*^9, 3.6376616460463066`*^9}, {
   3.8275506064411526`*^9, 3.8275506094663534`*^9}, 3.8275506953651385`*^9, {
   3.8275509202371597`*^9, 3.8275509210903344`*^9}, 3.8275831660718727`*^9, {
   3.831568622625779*^9, 3.8315686279917107`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"df766053-ac38-4675-9af9-19acf8602648"],

Cell[BoxData[
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"Image", "[", 
      RowBox[{"imhalf", ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ",", 
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"Image", "[", 
      RowBox[{
       RowBox[{
       "costLiftElevatorBifurcations", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ",", 
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"Image", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Min", ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"costLiftElevatorBifurcations", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ",", 
    RowBox[{"Image3D", "[", 
     RowBox[{
      RowBox[{"Rescale", "[", 
       RowBox[{"-", "costLiftElevatorBifurcations"}], "]"}], ",", 
      RowBox[{"BoxRatios", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "0.2"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.637657555299677*^9, 3.6376575653436995`*^9}, {
  3.6376578507257237`*^9, 3.637657853445543*^9}, {3.63766166225002*^9, 
  3.6376616732018642`*^9}, {3.665134479552128*^9, 3.6651344805052376`*^9}, {
  3.8281517333281717`*^9, 3.828151746690529*^9}, {3.831568636519785*^9, 
  3.8315686460385942`*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"4d9278e5-c563-4f97-808c-676ae31dea89"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Orientation Scores", "Chapter",
 CellChangeTimes->{{3.90558826270372*^9, 
  3.9055882649837255`*^9}},ExpressionUUID->"98c5111d-6504-4a9b-b163-\
ac3009843f20"],

Cell[CellGroupData[{

Cell["Cakewavelets", "Section",
 CellChangeTimes->{{3.905494011342417*^9, 
  3.9054940136158934`*^9}},ExpressionUUID->"5ffa6200-b0b5-45fd-baec-\
02c2af4c8a7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Size", ":"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"size", "=", "301"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sTheta", "=", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "No"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"periodicity", "=", 
     RowBox[{"2", "\[Pi]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "In", " ", "Mathematica", " ", "you", " ", "can", " ", "type", " ", 
     "\"\<Pi\>\"", " ", "or", " ", "\"\<[esc]pi[esc]\>\""}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"assr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cws", "=", 
     RowBox[{"CakeWaveletStack", "[", 
      RowBox[{"size", ",", "sTheta", ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<InflectionPoint\>\"", "\[Rule]", "100"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "this", " ", "is", " ", "the", " ", "radius", " ", "of", " ", "the", 
          " ", "disk", " ", "in", " ", "the", " ", "fourier", " ", "domain"}],
          ",", " ", 
         RowBox[{
         "lowering", " ", "this", " ", "removes", " ", "more", " ", "high", 
          " ", "frequencies"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<AngularSubSampleRate\>\"", "\[Rule]", "assr"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "With", " ", "this", " ", "parameter", " ", "the", " ", "wavelets", 
          " ", "still", " ", "have", " ", "an", " ", "angular", " ", "width", 
          " ", 
          RowBox[{"(", 
           RowBox[{"in", " ", "Fourier", " ", "domain"}], ")"}], " ", "of", 
          " ", "sTheta"}], ",", " ", 
         RowBox[{
         "but", " ", "more", " ", "wavelets", " ", "are", " ", "used", " ", 
          "to", " ", "cover", " ", "the", " ", "domain", " ", "0", " ", "to", 
          " ", "periodicity", " ", 
          RowBox[{"(", 
           RowBox[{
           "there", " ", "is", " ", "overlap", " ", "of", " ", "the", " ", 
            "cakes"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<Periodicity\>\"", "\[Rule]", "periodicity"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6699516456007147`*^9, 3.669951716839571*^9}, {
   3.669954029206094*^9, 3.669954095047618*^9}, {3.6699541264757414`*^9, 
   3.669954290227112*^9}, {3.90549433159899*^9, 3.905494331787574*^9}, {
   3.905496322076161*^9, 3.9054963252512093`*^9}, {3.905496379340312*^9, 
   3.905496381549016*^9}, {3.905496636932788*^9, 3.9054966375820837`*^9}, {
   3.9054967056812515`*^9, 3.9054967058072186`*^9}, 3.9054970226740136`*^9, {
   3.9054970564625998`*^9, 3.9054970650677795`*^9}, {3.9285723677302246`*^9, 
   3.9285723688520823`*^9}, 3.928572603998156*^9},
 CellLabel->
  "In[173]:=",ExpressionUUID->"828d8904-ccce-4f57-aa86-b950a9e61aac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Sigma]kernel", " ", "=", " ", "0.7"}], ";"}]], "Input",
 CellChangeTimes->{{3.9088615483886538`*^9, 3.908861555496591*^9}, {
   3.908875666014227*^9, 3.9088756661862974`*^9}, {3.9088757283584986`*^9, 
   3.908875728941682*^9}, {3.9088758924540825`*^9, 3.90887590053234*^9}, {
   3.9088759746783915`*^9, 3.9088759747773128`*^9}, {3.9088784236013775`*^9, 
   3.90887842389153*^9}, {3.90887853126437*^9, 3.908878532684826*^9}, {
   3.9100694856294527`*^9, 3.9100695687359*^9}, {3.9100699316518955`*^9, 
   3.9100699321253133`*^9}, 3.9121478760102453`*^9, {3.9121505503188505`*^9, 
   3.912150550574852*^9}, 3.9121507085672827`*^9, 3.912153459048007*^9, {
   3.913195783397916*^9, 3.913195793533033*^9}, 3.928572705204071*^9, 
   3.9285728262081175`*^9, {3.9285731978648577`*^9, 3.9285731983143625`*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"634f3b58-91cd-4611-80bb-a9bf75556456"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussianWindowFunction", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], 
        RowBox[{"2", "*", 
         SuperscriptBox["\[Sigma]kernel", "2"]}]]}]], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", 
       RowBox[{"Subdivide", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"size", "-", "1"}]}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"y", ",", " ", 
       RowBox[{"Subdivide", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"size", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQvcJLo7FH/q1j3tm9zSBaKWvqZBDdVaM9BUTLCM6e
BaKrNHWXgeg1bEs3geh13fdOgej4a4evg+i0KYE3QHSP2vU7IHrerZyHIFrv
mfxLED3lk9I7sP7vyp9A9N59q76A6DlFzgy9QLo2Wp4FRKetruEA0afqwrlA
9J9TDwVAtKWpiiCIFkv2DATRMexvgkD03lK/BBD95OO1RBDdlPq/oh9I1yhq
VoLoR+krWkD01sDDYPrG22/nQLSBsOh5EH3H4uEbXoW3jos0S96B6KL1Pw7x
Kr91PBdtdRxEa4UsPOmu/dYx0O0omOaw80jVcH3rOFvmaSaIBgD4gpuB
  "],
 CellLabel->
  "In[179]:=",ExpressionUUID->"6e27b9af-c421-49b2-a9f8-216949ea791e"],

Cell[BoxData[
 RowBox[{"Image", "[", 
  RowBox[{
   RowBox[{"Rescale", "[", 
    RowBox[{"Re", "[", 
     RowBox[{"GaussianWindowFunction", "*", 
      RowBox[{"cws", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
   RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9088556688490925`*^9, 3.9088558221182704`*^9}, 
   3.9088559310863576`*^9, {3.910692485277734*^9, 3.9106924862128077`*^9}, {
   3.9285727295867805`*^9, 3.9285728140008893`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"9fb61981-2aa6-4237-bcf5-724cfdc85681"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"cws", " ", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"GaussianWindowFunction", "*", "#"}], "&"}], ",", " ", "cws"}],
      "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.908855653189907*^9, 3.9088556573373327`*^9}, {
   3.9088560245100565`*^9, 3.9088560830473585`*^9}, {3.9088615989837227`*^9, 
   3.9088616036168633`*^9}, 3.9100696127415285`*^9, {3.9106921544874697`*^9, 
   3.9106921684644012`*^9}, {3.910692414636731*^9, 3.910692419984312*^9}, {
   3.914916504159584*^9, 3.914916506851309*^9}, {3.915005506808489*^9, 
   3.915005532480932*^9}, {3.9285727653150887`*^9, 3.9285727676425667`*^9}, {
   3.9285728216057205`*^9, 3.9285728222550197`*^9}, 3.928573525990352*^9},
 CellLabel->
  "In[181]:=",ExpressionUUID->"d2353441-16b6-4723-82cf-df58a1374ba1"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
   "Usually", " ", "we", " ", "remove", " ", "the", " ", "lower", " ", 
    "frequencies", " ", "in", " ", "the", " ", "image"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"imHP", "=", 
     RowBox[{"imhalf", "-", 
      RowBox[{"GaussianFilter", "[", 
       RowBox[{"imhalf", ",", "32"}], "]"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"HP", ":", " ", "\"\<High-Pass\>\""}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image", "[", "imHP", "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.905494062860077*^9, 3.9054940643078623`*^9}, {
  3.9055886729905825`*^9, 3.905588677581869*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"a1a7f697-e933-4b1d-9242-719a8982a571"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
   "Usually", " ", "we", " ", "remove", " ", "the", " ", "lower", " ", 
    "frequencies", " ", "in", " ", "the", " ", "image"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"maskHP", "=", 
     RowBox[{"maskhalf", "-", 
      RowBox[{"GaussianFilter", "[", 
       RowBox[{"maskhalf", ",", "32"}], "]"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"HP", ":", " ", "\"\<High-Pass\>\""}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image", "[", "maskHP", "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9054946981573553`*^9, 3.9054947266446304`*^9}, {
  3.905588708821539*^9, 3.9055887129796576`*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"5125239e-319f-435b-9e7b-8a81566b0ae4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Orientation Scores", "Section",
 CellChangeTimes->{{3.9035247466768227`*^9, 
  3.9035247504145436`*^9}},ExpressionUUID->"3527b40f-68dd-4436-89c8-\
a53596ea29b6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"osErik", "=", 
    RowBox[{"WaveletTransform2DErik", "[", 
     RowBox[{"cws", ",", "imHP"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9054945083550663`*^9, 3.905494535380582*^9}, {
   3.9060054519015837`*^9, 3.906005452424637*^9}, 3.906097874717969*^9},
 CellLabel->
  "In[184]:=",ExpressionUUID->"92619747-15e0-42cd-8dfa-05349e1a7365"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Denoising", "Chapter",
 CellChangeTimes->{{3.8733666985866876`*^9, 
  3.8733666996800737`*^9}},ExpressionUUID->"b6dc5ffb-df49-448c-96a5-\
3891d17c8709"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DoLeftTVF", "[", 
    RowBox[{
    "os_", ",", "\[Alpha]_", ",", " ", "t_", ",", " ", "dt_", ",", " ", "Ds_",
      ",", " ", "Da_", ",", " ", "source_", ",", " ", 
     RowBox[{"\[Kappa]_", ":", "1"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"out", " ", "=", "os"}], ",", " ", 
       RowBox[{"progress", "=", "0.0"}], ",", " ", "diff", ",", " ", "grad", 
       ",", " ", "grad1", ",", " ", "grad2", ",", " ", "grad3", ",", " ", 
       "gradNorm", ",", " ", "gradGN1", ",", " ", "gradGN2", ",", " ", 
       "gradGN3", ",", " ", "gradGN", ",", 
       RowBox[{"\[Lambda]", "=", "50"}], ",", " ", "L1", ",", " ", "L2", ",", 
       " ", "img"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"img", "=", 
       RowBox[{"InverseOrientationScoreTransform", "[", "out", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"L1", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"ImageDistance", "[", 
            RowBox[{"source", ",", " ", "img", ",", " ", 
             RowBox[{"DistanceFunction", "\[Rule]", "ManhattanDistance"}]}], 
            "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"L2", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"ImageDistance", "[", 
            RowBox[{"source", ",", " ", "img", ",", " ", 
             RowBox[{"DistanceFunction", "\[Rule]", "EuclideanDistance"}]}], 
            "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"out", " ", "=", " ", 
          RowBox[{"Affix", "[", 
           RowBox[{"out", ",", " ", 
            RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
             RowBox[{"\[Lambda]", " ", "*", " ", 
              RowBox[{"out", "[", "\"\<Data\>\"", "]"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"grad", " ", "=", " ", 
             RowBox[{
              RowBox[{"OrientationScoreTensor", "[", 
               RowBox[{"out", ",", " ", "\"\<Gradient\>\""}], "]"}], "[", 
              "\"\<Data\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"grad1", " ", "=", " ", 
             RowBox[{"Ds", "*", 
              RowBox[{"grad", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "All", ",", "All", ",", "1"}], 
               "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"grad2", " ", "=", " ", 
             RowBox[{"Ds", "*", 
              RowBox[{"\[Kappa]", "^", "2"}], "*", 
              RowBox[{"grad", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "All", ",", "All", ",", "2"}], 
               "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"grad3", " ", "=", " ", 
             RowBox[{"Da", "*", 
              RowBox[{"grad", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "All", ",", "All", ",", "3"}], 
               "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"gradNorm", " ", "=", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"grad1", "^", "2"}], "/", "Ds"}], "+", 
               RowBox[{
                RowBox[{"grad2", "^", "2"}], "/", 
                RowBox[{"(", 
                 RowBox[{"Ds", "*", 
                  RowBox[{"\[Kappa]", "^", "2"}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"grad3", "^", "2"}], "/", "Da"}], "+", 
               RowBox[{"0.001", "^", "2"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"gradNorm", " ", "=", " ", 
             RowBox[{"GaussianFilter", "[", 
              RowBox[{"gradNorm", ",", " ", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0"}], "}"}], "}"}], ",", " ", 
               RowBox[{"Padding", "\[Rule]", "\"\<Fixed\>\""}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"gradNorm", " ", "=", " ", 
             RowBox[{"GaussianFilter", "[", 
              RowBox[{"gradNorm", ",", " ", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"1", "/", "2"}]}], "}"}], "}"}], ",", " ", 
               RowBox[{"Padding", "\[Rule]", " ", "\"\<Periodic\>\""}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"gradGN1", " ", "=", " ", 
             RowBox[{
              RowBox[{"OrientationScoreTensor", "[", 
               RowBox[{
                RowBox[{"Affix", "[", 
                 RowBox[{"out", ",", " ", 
                  RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
                   RowBox[{"grad1", "/", "gradNorm"}]}]}], "]"}], ",", " ", 
                "\"\<Gradient\>\""}], "]"}], "[", "\"\<Data\>\"", "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"gradGN2", " ", "=", " ", 
             RowBox[{
              RowBox[{"OrientationScoreTensor", "[", 
               RowBox[{
                RowBox[{"Affix", "[", 
                 RowBox[{"out", ",", " ", 
                  RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
                   RowBox[{"grad2", "/", "gradNorm"}]}]}], "]"}], ",", " ", 
                "\"\<Gradient\>\""}], "]"}], "[", "\"\<Data\>\"", "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"gradGN3", " ", "=", " ", 
             RowBox[{
              RowBox[{"OrientationScoreTensor", "[", 
               RowBox[{
                RowBox[{"Affix", "[", 
                 RowBox[{"out", ",", " ", 
                  RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
                   RowBox[{"grad3", "/", "gradNorm"}]}]}], "]"}], ",", " ", 
                "\"\<Gradient\>\""}], "]"}], "[", "\"\<Data\>\"", "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"gradGN", " ", "=", " ", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"gradGN1", ",", " ", "gradGN2", ",", " ", "gradGN3"}],
                 "}"}], ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"diff", " ", "=", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"gradGN", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "All", ",", "All", ",", "1", ",", "1"}], 
                "\[RightDoubleBracket]"}], "\[IndentingNewLine]", "+", 
               RowBox[{"\[Alpha]", "*", 
                RowBox[{"gradGN", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "All", ",", "All", ",", "2", ",", "2"}], 
                 "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{"\[Alpha]", "*", 
                RowBox[{"gradGN", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "All", ",", "All", ",", "3", ",", "3"}], 
                 "\[RightDoubleBracket]"}]}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"out", " ", "=", " ", 
             RowBox[{"Affix", "[", 
              RowBox[{"out", ",", " ", 
               RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
                RowBox[{
                 RowBox[{"out", "[", "\"\<Data\>\"", "]"}], " ", "+", " ", 
                 RowBox[{"dt", "*", "diff"}]}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"img", " ", "=", " ", 
             RowBox[{"InverseOrientationScoreTransform", "[", 
              RowBox[{"Affix", "[", 
               RowBox[{"out", ",", " ", 
                RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"out", "[", "\"\<Data\>\"", "]"}], "/", 
                   "\[Lambda]"}], ")"}]}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"L1", ",", " ", 
              RowBox[{"ImageDistance", "[", 
               RowBox[{"source", ",", " ", "img", ",", " ", 
                RowBox[{
                "DistanceFunction", "\[Rule]", "ManhattanDistance"}]}], 
               "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"L2", ",", " ", 
              RowBox[{"ImageDistance", "[", 
               RowBox[{"source", ",", " ", "img", ",", " ", 
                RowBox[{
                "DistanceFunction", "\[Rule]", "EuclideanDistance"}]}], 
               "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"progress", " ", "+=", " ", 
             RowBox[{"dt", "/", "t"}]}], ";"}], "\[IndentingNewLine]", ",", 
           " ", 
           RowBox[{"Round", "[", 
            RowBox[{"t", "/", "dt"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}], "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ProgressIndicator", "[", "progress", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Image", "[", 
           RowBox[{"img", ",", " ", 
            RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Affix", "[", 
          RowBox[{"out", ",", " ", 
           RowBox[{"\"\<Data\>\"", "\[Rule]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"out", "[", "\"\<Data\>\"", "]"}], "/", "\[Lambda]"}], 
             ")"}]}]}], "]"}], ",", "L1", ",", "L2"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQHaW80OjNt9eOru84bUD0BN+oUBD94p5vJIj+f/hh
HIjeIDgrHURPmvOoCkQfm8dWDaLvZ36bDKL1rC9PAdHXfKXngOh1y1XANENS
5RoQ3aDdBaZfTPffBaLXf+wA0yICwo9BNNfiUDC97YLUaxD9b70ymJbJ1H7w
CUh/EzQD0yHxhnyfgXTzMS8w/SE4f+k3IC1V8mglmJ5+fx2I/nnKcRuIntLr
aVH0/bWjf/laSxB9UOtdGIg2KPkFpquaYqe7/3jtWGL7fxaIniIXJi7z67Vj
96crciB60Y7Hr9N53jg6F2/6BKI5ZjtKZQLpbVYBYFrrbt3xOiDttm8JmD5Q
av2rEUhzhXuB6SWhEzg3AOni3PfcIPrZoSUi5yXfOjrd75ME0U/WVaaD6Mc9
i8A0AAq06ms=
  "],
 CellLabel->
  "In[185]:=",ExpressionUUID->"9269c7e6-4d85-4f8e-9893-5ddd1803d827"],

Cell[BoxData[
 RowBox[{"<<", "LieAnalysis`"}]], "Input",
 CellChangeTimes->{{3.9061095144191217`*^9, 3.9061095194663815`*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"3f0396d5-4971-4328-865d-cb4cd9473c5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"os", " ", "=", " ", 
   RowBox[{"OrientationScoreTransform", "[", 
    RowBox[{"imhalf", ",", " ", 
     RowBox[{"\"\<Orientations\>\"", "\[Rule]", " ", "No"}], ",", " ", 
     RowBox[{"\"\<WaveletSize\>\"", "\[Rule]", " ", "75"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.753334599245699*^9, 3.753334641122751*^9}, {
  3.873430206835767*^9, 3.8734302297517986`*^9}, {3.8739447914886894`*^9, 
  3.873944791562791*^9}, {3.873982551410702*^9, 3.8739825515090094`*^9}, {
  3.8746435388680897`*^9, 3.8746435397510147`*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"ca48192d-95a1-41bb-9453-6ec614425b3e"],

Cell[BoxData[
 RowBox[{"Dimensions", "@", 
  RowBox[{"os", "[", "\"\<FullData\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.9060053454003754`*^9, 3.9060053840249076`*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"a83e04cd-daf2-4e6b-a958-91942e91d782"],

Cell[BoxData[
 RowBox[{
  RowBox[{"osGFBoarder", " ", "=", " ", 
   RowBox[{"OrientationScoreTransform", "[", 
    RowBox[{"maskhalf", ",", " ", 
     RowBox[{"\"\<Orientations\>\"", "\[Rule]", " ", "No"}], ",", " ", 
     RowBox[{"\"\<WaveletSize\>\"", "\[Rule]", " ", "75"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9058462170129795`*^9, 3.9058462217248073`*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"3a01e780-c39d-48cd-9167-cebabe59b589"],

Cell[BoxData[
 RowBox[{"Dimensions", "@", 
  RowBox[{"Transpose", "[", 
   RowBox[{"os", ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.905845464814905*^9, 3.905845472564751*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"5a81461c-c46a-45ca-acbc-33f67bd35b18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ds", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Da", " ", "=", " ", 
   RowBox[{"1", "/", "100"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"leftTVF", ",", " ", "leftTVFL1", ",", " ", "leftTVFL2"}], "}"}], 
   "=", 
   RowBox[{"DoLeftTVF", "[", 
    RowBox[{
    "os", ",", "1", ",", " ", "t", ",", " ", "dt", ",", " ", "Ds", ",", " ", 
     "Da", ",", " ", 
     RowBox[{"Image", "@", "imhalf"}], ",", " ", "1"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.753337328541938*^9, 3.7533373343324633`*^9}, {
   3.753337532110751*^9, 3.753337552895181*^9}, {3.753338329020829*^9, 
   3.753338333053053*^9}, {3.753338500700077*^9, 3.753338502418478*^9}, {
   3.7533386426835184`*^9, 3.753338645235691*^9}, {3.7533387192977076`*^9, 
   3.7533387211866274`*^9}, {3.7533587836387696`*^9, 
   3.7533588006063156`*^9}, {3.753769439960661*^9, 3.753769442991378*^9}, {
   3.7537757517861605`*^9, 3.7537757547854548`*^9}, 3.7540488566959996`*^9, {
   3.7646007335395985`*^9, 3.764600735252639*^9}, {3.7646540383561325`*^9, 
   3.7646540384761324`*^9}, {3.764748733966696*^9, 3.7647487348774395`*^9}, {
   3.7647495320930595`*^9, 3.76474953508317*^9}, {3.7647517072205105`*^9, 
   3.7647517102253685`*^9}, {3.764766438222141*^9, 3.7647664397591033`*^9}, {
   3.764772648333692*^9, 3.76477265180711*^9}, {3.7647727328929806`*^9, 
   3.764772733242981*^9}, {3.8734303465113554`*^9, 3.8734303771129904`*^9}, {
   3.8734312040955815`*^9, 3.87343120526328*^9}, {3.874035337231275*^9, 
   3.8740353389747396`*^9}, {3.875183468269189*^9, 3.875183469948228*^9}, {
   3.905844171279709*^9, 3.9058441724514904`*^9}, 3.905845481315114*^9, {
   3.9058457356465096`*^9, 3.905845737108096*^9}, {3.9058457772472467`*^9, 
   3.9058457784197693`*^9}, {3.9058459810133667`*^9, 3.9058460091476884`*^9}, 
   3.905846119748084*^9},
 CellLabel->
  "In[191]:=",ExpressionUUID->"c463a3ea-f1d3-4ae5-b7ad-1a2c0fd82899"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imgLeftTVF", " ", "=", " ", 
   RowBox[{"ImageClip", "[", 
    RowBox[{"InverseOrientationScoreTransform", "[", "leftTVF", "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Image", "[", 
  RowBox[{"imgLeftTVF", ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"Scaled", "[", "0.5", "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.753337458408743*^9, 3.753337468643383*^9}, {
  3.753337557900775*^9, 3.7533375657597647`*^9}, {3.905845831780676*^9, 
  3.9058458406408277`*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"67680861-f0fb-44f5-862b-3f499908723c"],

Cell[BoxData[
 RowBox[{"Image", "[", 
  RowBox[{"imgLeftTVF", ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"Scaled", "[", "0.5", "]"}]}]}], "]"}]], "Input",
 CellLabel->
  "In[198]:=",ExpressionUUID->"ceb421ba-8515-4e4e-ae48-a6e3eb177d31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"imgLeftTVF", "=", 
    RowBox[{"ImageData", "[", "imgLeftTVF", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Usually", " ", "we", " ", "remove", " ", "the", " ", "lower", " ", 
    "frequencies", " ", "in", " ", "the", " ", "image"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"imgLeftTVF", "=", 
    RowBox[{"imgLeftTVF", "-", 
     RowBox[{"GaussianFilter", "[", 
      RowBox[{"imgLeftTVF", ",", "32"}], "]"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"HP", ":", " ", "\"\<High-Pass\>\""}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ImageAdjust", "[", 
  RowBox[{"Image", "[", "imgLeftTVF", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.905494062860077*^9, 3.9054940643078623`*^9}, {
  3.9055886729905825`*^9, 3.905588677581869*^9}, {3.906097940561057*^9, 
  3.9060979449865646`*^9}, {3.906097988473937*^9, 3.9060979972289505`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"75e5fb47-7374-46f2-ad6b-1d467383db9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Usually", " ", "we", " ", "remove", " ", "the", " ", "lower", " ", 
    "frequencies", " ", "in", " ", "the", " ", "image"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"imgLeftTVFHP", "=", 
     RowBox[{"imgLeftTVF", "-", 
      RowBox[{"GaussianFilter", "[", 
       RowBox[{"imgLeftTVF", ",", "32"}], "]"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"HP", ":", " ", "\"\<High-Pass\>\""}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ImageAdjust", "[", 
    RowBox[{"Image", "[", "imgLeftTVFHP", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"osDenoisedErik", "=", 
     RowBox[{"WaveletTransform2DErik", "[", 
      RowBox[{"cws", ",", "imgLeftTVFHP"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9054945083550663`*^9, 3.905494535380582*^9}, {
   3.9060054519015837`*^9, 3.906005452424637*^9}, 3.906097874717969*^9, {
   3.9060979246757507`*^9, 3.9060979269864187`*^9}, 3.9060979574307137`*^9, {
   3.9061726165126457`*^9, 3.9061726560044785`*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"253e5369-3429-47e8-bb6f-5f0ab61d106d"],

Cell[BoxData[
 RowBox[{"Image3D", "[", 
  RowBox[{"Rescale", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"Re", "[", "osDenoisedErik", "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.906171574751444*^9, 3.906171612240672*^9}, {
  3.90617259109296*^9, 3.906172592310408*^9}, {3.9272562184369745`*^9, 
  3.92725623492412*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"5dcb434c-2ecb-4f4d-a000-54c4c56b8863"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Apply the vesselness function and do thinning operator on output\
\>", "Chapter",
 CellChangeTimes->{{3.6628820916351433`*^9, 3.662882096034143*^9}, {
  3.927175073619728*^9, 
  3.9271750812529774`*^9}},ExpressionUUID->"db8ae1e0-b1a4-4342-973b-\
80719a026738"],

Cell[CellGroupData[{

Cell["Vesselness", "Section",
 CellChangeTimes->{{3.927175095552822*^9, 
  3.9271750972536125`*^9}},ExpressionUUID->"2ecfc3c5-2221-4969-af9a-\
af9ad175d9ce"],

Cell[CellGroupData[{

Cell["Hessian Code", "Subsection",
 CellChangeTimes->{{3.9120620535169163`*^9, 
  3.9120620574059916`*^9}},ExpressionUUID->"68be89c5-1704-4cec-826a-\
32bc9a8b5338"],

Cell[CellGroupData[{

Cell["Documentation", "Subsubsection",
 CellChangeTimes->{{3.910930656536928*^9, 
  3.9109306583400955`*^9}},ExpressionUUID->"654f99eb-1a69-4286-9b8b-\
4708add21052"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExternalRegularization", "::", "usage"}], "=", 
    "\"\<ExternalRegularization[tensorIn, orientations, \[Sigma]sExt, \
\[Sigma]aExt]\n\treturns a regularised version of tensorIn, where tensorIn is \
a rank 2 tensor on SE(2), \n\twith dimensions {3, 3, Nx, Ny, No}, \
orientations contains the angular coordinate of each \n\tslice in tensorIn, \
and \[Sigma]sExt and \[Sigma]aExt are the standard deviations of the external \
\n\tregularisation in the spatial directions in pixels and in the angular \
direction in radians,\n\trespectively.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrientationScoreHessian", "::", "usage"}], "=", 
    "\"\<OrientationScoreHessian[U, \[Sigma]s, \[Sigma]a] \n\treturns the \
Hessian of the scalar field U, with dimensions {Nx, Ny, No}, where the \n\t\
derivatives are taken at standard deviations \[Sigma]s and \[Sigma]a in the \
spatial direction in pixels\n\tand in the angular direction in radians, \
respectively.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LeftInvariantDerivatives", "::", "usage"}], "=", 
    "\"\<LeftInvariantDerivatives[U, derivativeindex, \[Sigma]s, \[Sigma]a] \n\
\treturns the left invariant derivatives represented by derivativeindex of \
the scalar field U, \n\twith dimensions {Nx, Ny, No}, where the derivatives \
are taken at standard deviations \[Sigma]s and \n\t\[Sigma]a in the spatial \
directions in pixels and in the angular direction in radians, respectively. \n\
\tExample: if derivativeindex = {12, 13}, then it returns \
{\!\(\*SubscriptBox[\(\[ScriptCapitalA]\), \(12\)]\)U, \!\(\*SubscriptBox[\(\
\[ScriptCapitalA]\), \(13\)]\)U}.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftInvariantDerivative", "::", "usage"}], "=", 
   "\"\<LeftInvariantDerivative[U, derivativeindex, \[Sigma]s, \[Sigma]a] \n\t\
returns the left invariant derivative represented by derivativeindex of the \
scalar field U, \n\twith dimensions {Nx, Ny, No}, where the derivatives are \
taken at standard deviations \[Sigma]s and \n\t\[Sigma]a in the spatial \
direction in pixels and angular direction in radians, respectively.\n\t\
Example: if derivativeindex = 12, then it returns \!\(\*SubscriptBox[\(\
\[ScriptCapitalA]\), \(12\)]\)U.\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.9145562249787993`*^9, 3.9145563161141243`*^9}, {
   3.914556354492192*^9, 3.9145563546259418`*^9}, {3.9145563964778223`*^9, 
   3.914556403384923*^9}, {3.914556500908801*^9, 3.9145566623360095`*^9}, {
   3.91455669777105*^9, 3.9145567696186676`*^9}, 3.9145568119106054`*^9, {
   3.9145568703847265`*^9, 3.9145568816875057`*^9}, {3.914557171131405*^9, 
   3.914557234226368*^9}, {3.914557305366747*^9, 3.914557311248738*^9}, {
   3.914557364270966*^9, 3.9145575638928013`*^9}, {3.9145575947917366`*^9, 
   3.9145576018886747`*^9}, {3.9145576887850733`*^9, 
   3.9145577129858503`*^9}, {3.9145590987545147`*^9, 
   3.9145591589392414`*^9}, {3.9145790547162895`*^9, 3.9145791494802756`*^9}, 
   3.915091909287184*^9, 3.9158532548985443`*^9},
 CellLabel->
  "In[256]:=",ExpressionUUID->"387f4d4a-5dae-41c7-ac0d-d824d5b3e1b8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Implementation ", "Subsubsection",
 CellChangeTimes->{{3.663066272193674*^9, 3.663066351219674*^9}, {
   3.9110131775496407`*^9, 3.9110131869146595`*^9}, {3.911534692721732*^9, 
   3.9115347329425535`*^9}, 
   3.9131978183804827`*^9},ExpressionUUID->"3f5e5aef-df03-45c7-b297-\
2fba5cde2d21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Adapted", " ", "from", " ", 
     RowBox[{"LieAnalysis", "\\", "Common", "\\", 
      RowBox[{"OrientationScoreTensor", ".", "m"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"LieAnalysis", "\\", "Common", "\\", 
     RowBox[{"GaussianDerivative", ".", 
      RowBox[{"m", "\n", "**", " ", 
       RowBox[{"Author", ":", " ", 
        RowBox[{
         RowBox[{"F", ".", "C", ".", " ", "Martin"}], " ", "<", 
         RowBox[{"f", ".", "c", ".", 
          RowBox[{"martin", "@", "tue"}], ".", "nl"}], ">"}]}]}]}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CreatePeriodicOrientationAxes", "[", 
      RowBox[{"U_", ",", "periodicitylocal_"}], "]"}], ":=", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "periodicitylocal", ",", "\[IndentingNewLine]", "Pi", ",", "U", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"-", "Pi"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{"U", ",", 
         RowBox[{"-", 
          RowBox[{"Conjugate", "[", "U", "]"}]}], ",", "3"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"2", "Pi"}], ",", "U"}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Reorder", "[", 
      RowBox[{"os_", ",", "order_"}], "]"}], ":=", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"order", ",", "\"\<OrientationFirst\>\""}], "]"}], "&&", 
         RowBox[{
          RowBox[{"Depth", "[", "os", "]"}], "==", "4"}]}], ")"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"os", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"order", ",", "\"\<SpatialFirst\>\""}], "]"}], "&&", 
         RowBox[{
          RowBox[{"Depth", "[", "os", "]"}], "==", "4"}]}], ")"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"os", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"order", ",", "\"\<OrientationFirst\>\""}], "]"}], "&&", 
         RowBox[{
          RowBox[{"Depth", "[", "os", "]"}], "==", "5"}]}], ")"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"os", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"order", ",", "\"\<SpatialFirst\>\""}], "]"}], "&&", 
         RowBox[{
          RowBox[{"Depth", "[", "os", "]"}], "==", "5"}]}], ")"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"os", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderTheDerivatives", "[", "order_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{"(*", 
       RowBox[{"Define", " ", "substitution", " ", "rules"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"thetaXi", "=", 
          RowBox[{
           RowBox[{"prior___", "~~", "\"\<31\>\"", "~~", "post___"}], ":>", 
           RowBox[{
           "prior", "<>", "\"\<2\>\"", "<>", "post", "<>", "\"\<+\>\"", "<>", 
            "prior", "<>", "\"\<13\>\"", "<>", "post"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"thetaEta", "=", 
          RowBox[{
           RowBox[{"prior___", "~~", "\"\<32\>\"", "~~", "post___"}], ":>", 
           RowBox[{
           "prior", "<>", "\"\<23\>\"", "<>", "post", "<>", "\"\<-\>\"", "<>",
             "prior", "<>", "\"\<1\>\"", "<>", "post"}]}]}], ",", 
         "\[IndentingNewLine]", "orderTerms", ",", "derivativeOrderReWritten",
          ",", "previousResult", ",", "result"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Save", " ", "the", " ", "original"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"ToString", "[", "order", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Repeat", " ", "the", " ", "process", " ", "untill", " ", "theta", 
          " ", "is", " ", "the", " ", "first", " ", "derivative"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"previousResult", "=!=", "result"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Update", " ", "the", " ", "iteration", " ", "condition"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"previousResult", "=", "result"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"orderTerms", "=", 
            RowBox[{"StringSplit", "[", 
             RowBox[{"result", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<+\>\"", "->", "\"\<+\>\""}], ",", 
                RowBox[{"\"\<-\>\"", "->", "\"\<-\>\""}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"(*", "Substitute", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"derivativeOrderReWritten", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"StringReplace", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"thetaEta", ",", "thetaXi"}], "}"}]}], "]"}], "&"}], 
             "/@", "orderTerms"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"result", "=", 
            RowBox[{"StringJoin", "[", "derivativeOrderReWritten", "]"}]}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Return", " ", "the", " ", "reordered", " ", "result"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.913266316355891*^9, 3.9132663462724314`*^9}, {
   3.91326640534489*^9, 3.913266636777845*^9}, {3.913266674560602*^9, 
   3.913266722627385*^9}, {3.9132669622233953`*^9, 3.9132670732534933`*^9}, {
   3.9132671211399665`*^9, 3.9132671649539127`*^9}, {3.9132672411455283`*^9, 
   3.9132672760560665`*^9}, {3.9132673229054155`*^9, 3.91326741022259*^9}, {
   3.913267459599203*^9, 3.9132674991929502`*^9}, {3.9132675293763933`*^9, 
   3.9132675406618032`*^9}, 3.91326758256355*^9, {3.913267651409629*^9, 
   3.9132677523339977`*^9}, {3.9132677839326763`*^9, 
   3.9132678501899595`*^9}, {3.9132681033267813`*^9, 3.913268167003166*^9}, {
   3.91326820008107*^9, 3.913268229649136*^9}, {3.91327122257629*^9, 
   3.9132712388128424`*^9}, {3.913271305614857*^9, 3.9132713096550045`*^9}, {
   3.9132714007209396`*^9, 3.913271438219386*^9}, {3.913271471794546*^9, 
   3.913271687057373*^9}, {3.9132718667825594`*^9, 3.9132718932613125`*^9}, {
   3.913271988783467*^9, 3.913272198510557*^9}, {3.9132724898160343`*^9, 
   3.9132724911786633`*^9}, {3.9132725366691036`*^9, 3.91327254403657*^9}, {
   3.9132726166706543`*^9, 3.9132726207260313`*^9}, {3.9132726589382734`*^9, 
   3.9132726702227354`*^9}, {3.9132727004239497`*^9, 
   3.9132728547053595`*^9}, {3.91327292413078*^9, 3.9132729703181458`*^9}, {
   3.913273013275709*^9, 3.91327304740345*^9}, {3.913273210974222*^9, 
   3.913273235181641*^9}, {3.913273266034292*^9, 3.9132733635673656`*^9}, {
   3.9132734794371634`*^9, 3.9132735834269814`*^9}, {3.9132736554048004`*^9, 
   3.91327368728664*^9}, {3.913273717493252*^9, 3.9132738091796474`*^9}, 
   3.9132738608048077`*^9, {3.913273901382612*^9, 3.913273930821867*^9}, {
   3.9132739768741016`*^9, 3.9132739973489017`*^9}, {3.9132740512128773`*^9, 
   3.9132740838971834`*^9}, {3.9132741481474323`*^9, 
   3.9132742250857553`*^9}, {3.9132743816972446`*^9, 
   3.9132743865246487`*^9}, {3.913276533308627*^9, 3.913276546926363*^9}, {
   3.9132780892350836`*^9, 3.9132780945227833`*^9}, {3.913278138582215*^9, 
   3.9132781415891047`*^9}, {3.9132781865500307`*^9, 
   3.9132781917764177`*^9}, {3.913278222782586*^9, 3.913278234306244*^9}, {
   3.9132783069330306`*^9, 3.913278357169004*^9}, {3.913278407891507*^9, 
   3.913278412069999*^9}, {3.913278548349722*^9, 3.913278612841592*^9}, {
   3.913279365820752*^9, 3.913279404780896*^9}, {3.913279556550499*^9, 
   3.9132795782372966`*^9}, {3.9132796544061255`*^9, 
   3.9132796923508096`*^9}, {3.913279893494243*^9, 3.913279899866739*^9}, {
   3.9132800877692966`*^9, 3.9132801403592076`*^9}, {3.9132802085237455`*^9, 
   3.9132802146227303`*^9}, {3.913280291737883*^9, 3.913280307475136*^9}, {
   3.913280339523716*^9, 3.9132803614629474`*^9}, {3.9132804493770237`*^9, 
   3.913280456142724*^9}, {3.9132805086156015`*^9, 3.913280517259898*^9}, {
   3.913280583455991*^9, 3.9132806421471643`*^9}, {3.9132806960247374`*^9, 
   3.9132807142075825`*^9}, {3.9132817010783505`*^9, 3.9132817471291304`*^9}, 
   3.9132818137389565`*^9, {3.913281854469602*^9, 3.913281876846076*^9}, {
   3.9132819941431875`*^9, 3.9132820014013443`*^9}, 3.9132820468635254`*^9, {
   3.9132821648403645`*^9, 3.9132821736611214`*^9}, {3.9132822235060635`*^9, 
   3.913282247668455*^9}, {3.9132823511892624`*^9, 3.9132823902271585`*^9}, {
   3.913282663890301*^9, 3.913282671615747*^9}, {3.913282724504727*^9, 
   3.913282801823016*^9}, {3.913282897867173*^9, 3.913282906038251*^9}, {
   3.913283176794826*^9, 3.913283181279191*^9}, 3.9132833015350647`*^9, {
   3.9132833412113667`*^9, 3.9132833593146043`*^9}, 3.9132861772336035`*^9, {
   3.9133483626804237`*^9, 3.913348395529066*^9}, {3.913359867574653*^9, 
   3.913359909174513*^9}, {3.9133604335575495`*^9, 3.9133604535641484`*^9}, {
   3.91336113050226*^9, 3.9133611372493143`*^9}, {3.9133612268639193`*^9, 
   3.9133612363109913`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"12f0b6f8-a99c-4873-8f60-f45d9bea24a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaussianDerivative", "[", 
     RowBox[{"data_", ",", "\[Sigma]s_", ",", "orders_", ",", 
      RowBox[{"padding_", ":", "\"\<Periodic\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "derivative", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Compute", " ", "the", " ", "derivative", 
        RowBox[{"(", "s", ")"}], " ", "depending", " ", "on", " ", "input"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"derivative", "=", 
        RowBox[{"GaussianFilter", "[", 
         RowBox[{"data", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"4", " ", "\[Sigma]s"}], "+", "1"}], ",", "\[Sigma]s"}], 
           "}"}], ",", "orders", ",", 
          RowBox[{"Padding", "->", "padding"}], ",", 
          RowBox[{"Method", "->", "\"\<Gaussian\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Return", " ", "the", " ", "derivative"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "derivative", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.913266316355891*^9, 3.9132663462724314`*^9}, {
   3.91326640534489*^9, 3.913266636777845*^9}, {3.913266674560602*^9, 
   3.913266722627385*^9}, {3.9132669622233953`*^9, 3.9132670732534933`*^9}, {
   3.9132671211399665`*^9, 3.9132671649539127`*^9}, {3.9132672411455283`*^9, 
   3.9132672760560665`*^9}, {3.9132673229054155`*^9, 3.91326741022259*^9}, {
   3.913267459599203*^9, 3.9132674991929502`*^9}, {3.9132675293763933`*^9, 
   3.9132675406618032`*^9}, 3.91326758256355*^9, {3.913267651409629*^9, 
   3.9132677523339977`*^9}, {3.9132677839326763`*^9, 
   3.9132678501899595`*^9}, {3.9132681033267813`*^9, 3.913268167003166*^9}, {
   3.91326820008107*^9, 3.913268229649136*^9}, {3.91327122257629*^9, 
   3.9132712388128424`*^9}, {3.913271305614857*^9, 3.9132713096550045`*^9}, {
   3.9132714007209396`*^9, 3.913271438219386*^9}, {3.913271471794546*^9, 
   3.913271687057373*^9}, {3.9132718667825594`*^9, 3.9132718932613125`*^9}, {
   3.913271988783467*^9, 3.913272198510557*^9}, {3.9132724898160343`*^9, 
   3.9132724911786633`*^9}, {3.9132725366691036`*^9, 3.91327254403657*^9}, {
   3.9132726166706543`*^9, 3.9132726207260313`*^9}, {3.9132726589382734`*^9, 
   3.9132726702227354`*^9}, {3.9132727004239497`*^9, 
   3.9132728547053595`*^9}, {3.91327292413078*^9, 3.9132729703181458`*^9}, {
   3.913273013275709*^9, 3.91327304740345*^9}, {3.913273210974222*^9, 
   3.913273235181641*^9}, {3.913273266034292*^9, 3.9132733635673656`*^9}, {
   3.9132734794371634`*^9, 3.9132735834269814`*^9}, {3.9132736554048004`*^9, 
   3.91327368728664*^9}, {3.913273717493252*^9, 3.9132738091796474`*^9}, 
   3.9132738608048077`*^9, {3.913273901382612*^9, 3.913273930821867*^9}, {
   3.9132739768741016`*^9, 3.9132739973489017`*^9}, {3.9132740512128773`*^9, 
   3.9132740838971834`*^9}, {3.9132741481474323`*^9, 
   3.9132742250857553`*^9}, {3.9132743816972446`*^9, 
   3.9132743865246487`*^9}, {3.913276533308627*^9, 3.913276546926363*^9}, {
   3.9132780892350836`*^9, 3.9132780945227833`*^9}, {3.913278138582215*^9, 
   3.9132781415891047`*^9}, {3.9132781865500307`*^9, 
   3.9132781917764177`*^9}, {3.913278222782586*^9, 3.913278234306244*^9}, {
   3.9132783069330306`*^9, 3.913278357169004*^9}, {3.913278407891507*^9, 
   3.913278412069999*^9}, {3.913278548349722*^9, 3.913278612841592*^9}, {
   3.913279365820752*^9, 3.913279404780896*^9}, {3.913279556550499*^9, 
   3.9132795782372966`*^9}, {3.9132796544061255`*^9, 
   3.9132796923508096`*^9}, {3.913279893494243*^9, 3.913279899866739*^9}, {
   3.9132800877692966`*^9, 3.9132801403592076`*^9}, {3.9132802085237455`*^9, 
   3.9132802146227303`*^9}, {3.913280291737883*^9, 3.913280307475136*^9}, {
   3.913280339523716*^9, 3.9132803614629474`*^9}, {3.9132804493770237`*^9, 
   3.913280456142724*^9}, {3.9132805086156015`*^9, 3.913280517259898*^9}, {
   3.913280583455991*^9, 3.9132806421471643`*^9}, {3.9132806960247374`*^9, 
   3.9132807142075825`*^9}, {3.9132817010783505`*^9, 3.9132817471291304`*^9}, 
   3.9132818137389565`*^9, {3.913281854469602*^9, 3.913281876846076*^9}, {
   3.9132819941431875`*^9, 3.9132820014013443`*^9}, 3.9132820468635254`*^9, {
   3.9132821648403645`*^9, 3.9132821736611214`*^9}, {3.9132822235060635`*^9, 
   3.913282247668455*^9}, {3.9132823511892624`*^9, 3.9132823902271585`*^9}, {
   3.913282663890301*^9, 3.913282671615747*^9}, {3.913282724504727*^9, 
   3.913282801823016*^9}, {3.913282897867173*^9, 3.913282906038251*^9}, {
   3.913283176794826*^9, 3.913283181279191*^9}, 3.9132833015350647`*^9, {
   3.9132833412113667`*^9, 3.9132833593146043`*^9}, 3.9132861772336035`*^9, {
   3.9133483626804237`*^9, 3.913348395529066*^9}, 3.9133484270053825`*^9, {
   3.913348480857382*^9, 3.9133484941904516`*^9}, {3.914039370171339*^9, 
   3.9140394412065554`*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"4fd18640-9805-4e0a-9578-2ed627121b7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrientationDerivative", "[", 
    RowBox[{
    "U_", ",", "scaled\[Sigma]s_", ",", "scaled\[Sigma]OD_", ",", 
     "angularresolution_", ",", "order_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"periodicU", ",", 
       RowBox[{"periodicitylocal", "=", 
        RowBox[{"2", "\[Pi]"}]}], ",", "blurredU", ",", "derivative"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Compute", " ", "the", " ", "theta"}], "-", "derivative"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"periodicU", "=", 
       RowBox[{"CreatePeriodicOrientationAxes", "[", 
        RowBox[{"U", ",", "periodicitylocal"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"periodicU", "=", 
       RowBox[{"Reorder", "[", 
        RowBox[{"periodicU", ",", "\"\<OrientationFirst\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Blur", " ", "the", " ", "spatial", " ", "directions"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Can", "'"}], "t", " ", "we", " ", "blur", " ", "in", " ", 
        "spatial", " ", "directions", " ", "while", " ", "differentiating", 
        " ", "in", " ", "the", " ", "angular", " ", 
        RowBox[{"direction", "?"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"blurredU", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"GaussianFilter", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"4", 
               RowBox[{"{", 
                RowBox[{"scaled\[Sigma]s", ",", "scaled\[Sigma]s"}], "}"}]}], 
              "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"scaled\[Sigma]s", ",", "scaled\[Sigma]s"}], "}"}]}], 
            "}"}], ",", 
           RowBox[{"Padding", "->", "\"\<Fixed\>\""}]}], "]"}], "&"}], "/@", 
        "periodicU"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Derivative", " ", "in", " ", "y"}], "-", "direction"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"derivative", "=", 
       RowBox[{"GaussianDerivative", "[", 
        RowBox[{"blurredU", ",", 
         RowBox[{"{", 
          RowBox[{"scaled\[Sigma]OD", ",", "0.125", ",", "0.125"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"order", ",", "0", ",", "0"}], "}"}], ",", 
         "\"\<Periodic\>\""}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"TODO", ":", 
         RowBox[{
         "spatial", " ", "standard", " ", "deviation", " ", "0.125", " ", 
          "is", " ", "used", " ", "instead", " ", "of", " ", "0.0"}]}], ",", 
        " ", 
        RowBox[{
        "because", " ", "Mathematica", " ", "has", " ", "a", " ", "bug", " ", 
         "for", " ", "the", " ", "case", " ", "0.0", " ", "with", " ", 
         RowBox[{
          RowBox[{"SetOptions", "[", 
           RowBox[{"GaussianFilter", ",", 
            RowBox[{"Method", "->", "\"\<Gaussian\>\""}]}], "]"}], ".", " ", 
          "Standard"}], " ", "deviation", " ", "0.125", " ", "is", " ", 
         "still", " ", "small", " ", "enough", " ", "to", " ", "be", " ", 
         "ignored"}], ",", 
        RowBox[{
         RowBox[{
         "but", " ", "large", " ", "enough", " ", "for", " ", "Mathematica", 
          " ", "to", " ", "be", " ", "stable"}], ".."}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Cut", " ", 
        RowBox[{"off", " ", "'"}], 
        RowBox[{"extra", "'"}], " ", "period"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"derivative", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"periodicity", ",", 
           RowBox[{"Pi", "|", 
            RowBox[{"-", "Pi"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"derivative", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{
             RowBox[{"Dimensions", "[", "U", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", "derivative"}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "scale", " ", "with", " ", "the", " ", "angular", " ", "resolution"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"derivative", "=", 
       RowBox[{"derivative", "/", 
        RowBox[{"(", 
         RowBox[{"angularresolution", "^", "order"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Reorder", " ", "that", " ", "the", " ", "spatial", " ", "dimensions",
          " ", "are", " ", "first", " ", "x"}], ",", "y", ",", "theta"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"derivative", "=", 
       RowBox[{"Reorder", "[", 
        RowBox[{"derivative", ",", "\"\<SpatialFirst\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Return", " ", "the", " ", "derivative"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "derivative", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913266316355891*^9, 3.9132663462724314`*^9}, {
   3.91326640534489*^9, 3.913266636777845*^9}, {3.913266674560602*^9, 
   3.913266722627385*^9}, {3.9132669622233953`*^9, 3.9132670732534933`*^9}, {
   3.9132671211399665`*^9, 3.9132671649539127`*^9}, {3.9132672411455283`*^9, 
   3.9132672760560665`*^9}, {3.9132673229054155`*^9, 3.91326741022259*^9}, {
   3.913267459599203*^9, 3.9132674991929502`*^9}, {3.9132675293763933`*^9, 
   3.9132675406618032`*^9}, 3.91326758256355*^9, {3.913267651409629*^9, 
   3.9132677523339977`*^9}, {3.9132677839326763`*^9, 
   3.9132678501899595`*^9}, {3.9132681033267813`*^9, 3.913268167003166*^9}, {
   3.91326820008107*^9, 3.913268229649136*^9}, {3.91327122257629*^9, 
   3.9132712388128424`*^9}, {3.913271305614857*^9, 3.9132713096550045`*^9}, {
   3.9132714007209396`*^9, 3.913271438219386*^9}, {3.913271471794546*^9, 
   3.913271687057373*^9}, {3.9132718667825594`*^9, 3.9132718932613125`*^9}, {
   3.913271988783467*^9, 3.913272198510557*^9}, {3.9132724898160343`*^9, 
   3.9132724911786633`*^9}, {3.9132725366691036`*^9, 3.91327254403657*^9}, {
   3.9132726166706543`*^9, 3.9132726207260313`*^9}, {3.9132726589382734`*^9, 
   3.9132726702227354`*^9}, {3.9132727004239497`*^9, 
   3.9132728547053595`*^9}, {3.91327292413078*^9, 3.9132729703181458`*^9}, {
   3.913273013275709*^9, 3.91327304740345*^9}, {3.913273210974222*^9, 
   3.913273235181641*^9}, {3.913273266034292*^9, 3.9132733635673656`*^9}, {
   3.9132734794371634`*^9, 3.9132735834269814`*^9}, {3.9132736554048004`*^9, 
   3.91327368728664*^9}, {3.913273717493252*^9, 3.9132738091796474`*^9}, 
   3.9132738608048077`*^9, {3.913273901382612*^9, 3.913273930821867*^9}, {
   3.9132739768741016`*^9, 3.9132739973489017`*^9}, {3.9132740512128773`*^9, 
   3.9132740838971834`*^9}, {3.9132741481474323`*^9, 
   3.9132742250857553`*^9}, {3.9132743816972446`*^9, 
   3.9132743865246487`*^9}, {3.913276533308627*^9, 3.913276546926363*^9}, {
   3.9132780892350836`*^9, 3.9132780945227833`*^9}, {3.913278138582215*^9, 
   3.9132781415891047`*^9}, {3.9132781865500307`*^9, 
   3.9132781917764177`*^9}, {3.913278222782586*^9, 3.913278234306244*^9}, {
   3.9132783069330306`*^9, 3.913278357169004*^9}, {3.913278407891507*^9, 
   3.913278412069999*^9}, {3.913278548349722*^9, 3.913278612841592*^9}, {
   3.913279365820752*^9, 3.913279404780896*^9}, {3.913279556550499*^9, 
   3.9132795782372966`*^9}, {3.9132796544061255`*^9, 
   3.9132796923508096`*^9}, {3.913279893494243*^9, 3.913279899866739*^9}, {
   3.9132800877692966`*^9, 3.9132801403592076`*^9}, {3.9132802085237455`*^9, 
   3.9132802146227303`*^9}, {3.913280291737883*^9, 3.913280307475136*^9}, {
   3.913280339523716*^9, 3.9132803614629474`*^9}, {3.9132804493770237`*^9, 
   3.913280456142724*^9}, {3.9132805086156015`*^9, 3.913280517259898*^9}, {
   3.913280583455991*^9, 3.9132806421471643`*^9}, {3.9132806960247374`*^9, 
   3.9132807142075825`*^9}, {3.9132817010783505`*^9, 3.9132817471291304`*^9}, 
   3.9132818137389565`*^9, {3.913281854469602*^9, 3.913281876846076*^9}, {
   3.9132819941431875`*^9, 3.9132820014013443`*^9}, 3.9132820468635254`*^9, {
   3.9132821648403645`*^9, 3.9132821736611214`*^9}, {3.9132822235060635`*^9, 
   3.913282247668455*^9}, {3.9132823511892624`*^9, 3.9132823902271585`*^9}, {
   3.913282663890301*^9, 3.913282671615747*^9}, {3.913282724504727*^9, 
   3.913282801823016*^9}, {3.913282897867173*^9, 3.913282906038251*^9}, {
   3.913283176794826*^9, 3.913283181279191*^9}, 3.9132833015350647`*^9, {
   3.9132833412113667`*^9, 3.9132833593146043`*^9}, 3.9132861772336035`*^9, {
   3.9133483626804237`*^9, 3.913348395529066*^9}, 3.9133484270053825`*^9, {
   3.913348480857382*^9, 3.9133484941904516`*^9}, 3.9133604766151905`*^9, {
   3.9140389222226095`*^9, 3.914038935712634*^9}, {3.9140390770403986`*^9, 
   3.9140390838990173`*^9}, {3.9140395058301644`*^9, 
   3.9140395772890787`*^9}, {3.914579189467939*^9, 3.914579209223483*^9}, {
   3.915089647258377*^9, 3.9150896706033983`*^9}, {3.915852805788727*^9, 
   3.915852809760234*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"367e2b7e-be2b-4b79-9e16-d0af6dabd010"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpatialDerivative", "[", 
    RowBox[{
    "U_", ",", "scaled\[Sigma]s_", ",", "scaled\[Sigma]OD_", ",", 
     "direction_", ",", "angles_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"periodicU", ",", 
       RowBox[{"periodicitylocal", "=", 
        RowBox[{"2", "\[Pi]"}]}], ",", "dx", ",", "dy", ",", "derivative"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Blur", " ", "the", " ", "OS", " ", "in", " ", "thera"}], "-", 
       "direction"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"TODO", ":", 
       RowBox[{"remove", " ", "redundant", " ", "steps"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"?", " ", 
       RowBox[{"why", " ", "?"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"periodicU", "=", 
       RowBox[{"CreatePeriodicOrientationAxes", "[", 
        RowBox[{"U", ",", "periodicitylocal"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"periodicU", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"periodicitylocal", ",", 
           RowBox[{"Pi", "|", 
            RowBox[{"-", "Pi"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"periodicU", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", 
            RowBox[{"1", ";;", 
             RowBox[{
              RowBox[{"Dimensions", "[", "U", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", "periodicU"}], "\[IndentingNewLine]", "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "Reorder", "*)"}], 
      RowBox[{"(*", 
       RowBox[{
       "Why", " ", "do", " ", "we", " ", "even", " ", "need", " ", "to", " ", 
        RowBox[{"reorder", "?"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"periodicU", "=", 
       RowBox[{"Reorder", "[", 
        RowBox[{"periodicU", ",", "\"\<OrientationFirst\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Compute", " ", "the", " ", "x", " ", "and", " ", "y"}], "-", 
        "derivative"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dx", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"GaussianDerivative", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"scaled\[Sigma]s", ",", "scaled\[Sigma]s"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<Fixed\>\""}], "]"}], 
         "&"}], "/@", "periodicU"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dy", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"GaussianDerivative", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"scaled\[Sigma]s", ",", "scaled\[Sigma]s"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<Fixed\>\""}], "]"}], 
         "&"}], "/@", "periodicU"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Rotate", " ", "to", " ", "the", " ", "\[Eta]"}], ",", " ", 
        RowBox[{"\[Xi]", " ", "frame"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"derivative", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"direction", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "A1", "*)"}], "1", ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#1", " ", 
               RowBox[{"Cos", "[", "#3", "]"}]}], "+", 
              RowBox[{"#2", " ", 
               RowBox[{"Sin", "[", "#3", "]"}]}]}], ")"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"dx", ",", "dy", ",", "angles"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "A2", "*)"}], "2", ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "#1"}], " ", 
               RowBox[{"Sin", "[", "#3", "]"}]}], "+", 
              RowBox[{"#2", " ", 
               RowBox[{"Cos", "[", "#3", "]"}]}]}], ")"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"dx", ",", "dy", ",", "angles"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Reorder", " ", "x"}], ",", " ", "y", ",", " ", "\[Theta]"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"derivative", "=", 
       RowBox[{"Reorder", "[", 
        RowBox[{"derivative", ",", "\"\<SpatialFirst\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Return", " ", "the", " ", "derivative"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "derivative", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913266316355891*^9, 3.9132663462724314`*^9}, {
   3.91326640534489*^9, 3.913266636777845*^9}, {3.913266674560602*^9, 
   3.913266722627385*^9}, {3.9132669622233953`*^9, 3.9132670732534933`*^9}, {
   3.9132671211399665`*^9, 3.9132671649539127`*^9}, {3.9132672411455283`*^9, 
   3.9132672760560665`*^9}, {3.9132673229054155`*^9, 3.91326741022259*^9}, {
   3.913267459599203*^9, 3.9132674991929502`*^9}, {3.9132675293763933`*^9, 
   3.9132675406618032`*^9}, 3.91326758256355*^9, {3.913267651409629*^9, 
   3.9132677523339977`*^9}, {3.9132677839326763`*^9, 
   3.9132678501899595`*^9}, {3.9132681033267813`*^9, 3.913268167003166*^9}, {
   3.91326820008107*^9, 3.913268229649136*^9}, {3.91327122257629*^9, 
   3.9132712388128424`*^9}, {3.913271305614857*^9, 3.9132713096550045`*^9}, {
   3.9132714007209396`*^9, 3.913271438219386*^9}, {3.913271471794546*^9, 
   3.913271687057373*^9}, {3.9132718667825594`*^9, 3.9132718932613125`*^9}, {
   3.913271988783467*^9, 3.913272198510557*^9}, {3.9132724898160343`*^9, 
   3.9132724911786633`*^9}, {3.9132725366691036`*^9, 3.91327254403657*^9}, {
   3.9132726166706543`*^9, 3.9132726207260313`*^9}, {3.9132726589382734`*^9, 
   3.9132726702227354`*^9}, {3.9132727004239497`*^9, 
   3.9132728547053595`*^9}, {3.91327292413078*^9, 3.9132729703181458`*^9}, {
   3.913273013275709*^9, 3.91327304740345*^9}, {3.913273210974222*^9, 
   3.913273235181641*^9}, {3.913273266034292*^9, 3.9132733635673656`*^9}, {
   3.9132734794371634`*^9, 3.9132735834269814`*^9}, {3.9132736554048004`*^9, 
   3.91327368728664*^9}, {3.913273717493252*^9, 3.9132738091796474`*^9}, 
   3.9132738608048077`*^9, {3.913273901382612*^9, 3.913273930821867*^9}, {
   3.9132739768741016`*^9, 3.9132739973489017`*^9}, {3.9132740512128773`*^9, 
   3.9132740838971834`*^9}, {3.9132741481474323`*^9, 
   3.9132742250857553`*^9}, {3.9132743816972446`*^9, 
   3.9132743865246487`*^9}, {3.913276533308627*^9, 3.913276546926363*^9}, {
   3.9132780892350836`*^9, 3.9132780945227833`*^9}, {3.913278138582215*^9, 
   3.9132781415891047`*^9}, {3.9132781865500307`*^9, 
   3.9132781917764177`*^9}, {3.913278222782586*^9, 3.913278234306244*^9}, {
   3.9132783069330306`*^9, 3.913278357169004*^9}, {3.913278407891507*^9, 
   3.913278412069999*^9}, {3.913278548349722*^9, 3.913278612841592*^9}, {
   3.913279365820752*^9, 3.913279404780896*^9}, {3.913279556550499*^9, 
   3.9132795782372966`*^9}, {3.9132796544061255`*^9, 
   3.9132796923508096`*^9}, {3.913279893494243*^9, 3.913279899866739*^9}, {
   3.9132800877692966`*^9, 3.9132801403592076`*^9}, {3.9132802085237455`*^9, 
   3.9132802146227303`*^9}, {3.913280291737883*^9, 3.913280307475136*^9}, {
   3.913280339523716*^9, 3.9132803614629474`*^9}, {3.9132804493770237`*^9, 
   3.913280456142724*^9}, {3.9132805086156015`*^9, 3.913280517259898*^9}, {
   3.913280583455991*^9, 3.9132806421471643`*^9}, {3.9132806960247374`*^9, 
   3.9132807142075825`*^9}, {3.9132817010783505`*^9, 3.9132817471291304`*^9}, 
   3.9132818137389565`*^9, {3.913281854469602*^9, 3.913281876846076*^9}, {
   3.9132819941431875`*^9, 3.9132820014013443`*^9}, 3.9132820468635254`*^9, {
   3.9132821648403645`*^9, 3.9132821736611214`*^9}, {3.9132822235060635`*^9, 
   3.913282247668455*^9}, {3.9132823511892624`*^9, 3.9132823902271585`*^9}, {
   3.913282663890301*^9, 3.913282671615747*^9}, {3.913282724504727*^9, 
   3.913282801823016*^9}, {3.913282897867173*^9, 3.913282906038251*^9}, {
   3.913283176794826*^9, 3.913283181279191*^9}, 3.9132833015350647`*^9, {
   3.9132833412113667`*^9, 3.9132833593146043`*^9}, 3.9132861772336035`*^9, {
   3.9133483626804237`*^9, 3.913348395529066*^9}, 3.9133484270053825`*^9, 
   3.913348480857382*^9, {3.9140392996044044`*^9, 3.914039313782251*^9}, {
   3.9140395992904444`*^9, 3.91403965619209*^9}, 3.9158527783833466`*^9},
 CellLabel->
  "In[265]:=",ExpressionUUID->"46421821-0a7c-4a2c-869d-c658f2561e9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LeftInvariantDerivativeCorrectOrder", "[", 
    RowBox[{
    "U_", ",", "orders_", ",", "\[Sigma]s_", ",", "\[Sigma]OD_", ",", 
     "angularresolution_", ",", "angles_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "derivative", ",", "n", ",", "scaled\[Sigma]s", ",", "angularorder", 
       ",", 
       RowBox[{"periodicitylocal", "=", 
        RowBox[{"2", "\[Pi]"}]}], ",", "spatialorders"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "scale", " ", "\[Sigma]s", " ", "to", " ", "the", " ", "number", " ", 
       "of", " ", "derivatives"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"orders", ",", 
          RowBox[{"1", "|", "2"}]}], "]"}], "+", "1"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\[Theta]", " ", "derivatives", " ", "are", " ", "always", " ", 
         "computed", " ", "in", " ", "1", " ", "step"}], ",", " ", 
        RowBox[{"independent", " ", "of", " ", "the", " ", "order"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"scaled\[Sigma]s", "=", " ", 
       RowBox[{"\[Sigma]s", "/", 
        RowBox[{"Sqrt", "[", "n", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Compute", " ", "angular", " ", "derivative", 
        RowBox[{"(", "s", ")"}], " ", "if", " ", "any"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"angularorder", "=", 
       RowBox[{"Count", "[", 
        RowBox[{"orders", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"derivative", "=", 
       RowBox[{"OrientationDerivative", "[", 
        RowBox[{
        "U", ",", "scaled\[Sigma]s", ",", "\[Sigma]OD", ",", 
         "angularresolution", ",", "angularorder"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"spatialorders", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"orders", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Compute", " ", "spatial", " ", "derivative", 
        RowBox[{"(", "s", ")"}], " ", "if", " ", "any"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"derivative", "=", 
          RowBox[{"SpatialDerivative", "[", 
           RowBox[{
           "derivative", ",", "scaled\[Sigma]s", ",", "0", ",", "direction", 
            ",", "angles"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"periodicitylocal", "=", 
          RowBox[{"Switch", "[", 
           RowBox[{"periodicity", ",", "Pi", ",", 
            RowBox[{"-", "Pi"}], ",", 
            RowBox[{"-", "Pi"}], ",", "Pi", ",", 
            RowBox[{"2", "Pi"}], ",", 
            RowBox[{"2", "Pi"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"direction", ",", "spatialorders"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "derivative", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913360020754381*^9, 3.9133601658056726`*^9}, {
  3.9133619453997784`*^9, 3.913361965439348*^9}, {3.9133621320632772`*^9, 
  3.9133621411031446`*^9}, {3.9133626140234995`*^9, 3.9133626292555237`*^9}, {
  3.913363793631291*^9, 3.9133637981969385`*^9}, {3.91404543607929*^9, 
  3.9140454390940013`*^9}, {3.914579218741389*^9, 3.91457922095512*^9}, {
  3.9145794316854362`*^9, 3.914579451124174*^9}, {3.9145794824377146`*^9, 
  3.91457948591933*^9}, {3.9150895816129074`*^9, 3.9150895836642675`*^9}, {
  3.9158527624233027`*^9, 3.9158527638219604`*^9}, {3.9179644922953463`*^9, 
  3.9179644964685473`*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"845a3cf4-4226-454e-8322-03c70c1de3b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LeftInvariantDerivativeWrongOrder", "[", 
    RowBox[{"U_", ",", "orders_", ",", "\[Sigma]s_", ",", "\[Sigma]OD_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "derivativestring", ",", "reorders", ",", "operators", ",", 
       "derivatives", ",", "derivative"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Recompute", " ", "Order"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"derivativestring", "=", 
       RowBox[{"StringSplit", "[", 
        RowBox[{
         RowBox[{"OrderTheDerivatives", "[", "orders", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<+\>\"", "->", "\"\<+\>\""}], ",", 
           RowBox[{"\"\<-\>\"", "->", "\"\<-\>\""}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"reorders", ",", "operators"}], "}"}], "=", 
       RowBox[{"GatherBy", "[", 
        RowBox[{"derivativestring", ",", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<-\>\"", "|", "\"\<+\>\""}]}], "]"}], "&"}]}], 
        "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "legal", " ", "derivative", " ", "orders", " ", "that", " ", "need", 
        " ", "to", " ", "be", " ", "computed"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"derivatives", "=", 
       RowBox[{"LeftInvariantDerivatives", "[", 
        RowBox[{"U", ",", 
         RowBox[{"ToExpression", 
          RowBox[{"(*", "FromDigits", "*)"}], "@", "reorders"}], ",", 
         "\[Sigma]s", ",", "\[Sigma]OD"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"derivative", "=", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#2", "==", "\"\<-\>\""}], ",", 
               RowBox[{"-", "#1"}], ",", "#1"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"derivatives", "[", 
               RowBox[{"[", 
                RowBox[{"2", ";;", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "operators"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"derivatives", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "derivative", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913360203809423*^9, 3.913360204336856*^9}, {
  3.9133609130295057`*^9, 3.91336096983055*^9}, {3.9133610043199205`*^9, 
  3.9133610264547396`*^9}, {3.9133611470337715`*^9, 3.913361148480099*^9}, {
  3.9133613338054748`*^9, 3.9133614487503986`*^9}, {3.9133618930305796`*^9, 
  3.913361904390707*^9}, {3.9133619734785852`*^9, 3.9133619821822243`*^9}, {
  3.9133626413450937`*^9, 3.9133626514468718`*^9}, {3.913363671678951*^9, 
  3.913363674911066*^9}, {3.913363790269661*^9, 3.913363792136504*^9}, {
  3.91343899232438*^9, 3.913439028094017*^9}, {3.9134391303484693`*^9, 
  3.913439152338135*^9}, {3.9134402926931224`*^9, 3.913440299161191*^9}, {
  3.91404542414684*^9, 3.914045430002695*^9}, {3.915089565030402*^9, 
  3.9150895687509537`*^9}, {3.915852757089932*^9, 3.9158527588154755`*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"8a2161c3-0c7e-4cfc-b12d-d1526483f9be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LeftInvariantDerivative", "[", 
    RowBox[{
    "U_", ",", "derivativeindex_", ",", "\[Sigma]s_", ",", "\[Sigma]a_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"temporaryprint", ",", "No", ",", 
       RowBox[{"periodicitylocal", "=", 
        RowBox[{"2", "\[Pi]"}]}], ",", "angularresolution", ",", "angles", 
       ",", "\[Sigma]OD", ",", "orders", ",", "derivative", ",", "n", ",", 
       "scaled\[Sigma]s", ",", "angularorder"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"temporaryprint", "=", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{
        "\"\<Current derivative index is \>\"", ",", "derivativeindex"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"orientation", " ", "angles"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"No", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "U", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"angularresolution", "=", 
       RowBox[{"periodicitylocal", "/", "No"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"angles", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{"periodicitylocal", "-", "angularresolution"}], ",", 
         "angularresolution"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Convert", " ", "to", " ", "discrete", " ", "orientation", " ", 
        "sigma"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]OD", "=", 
       RowBox[{"\[Sigma]a", "/", "angularresolution"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "list", " ", "of", " ", "derivatives", " ", "that", " ", "need", " ", 
        "to", " ", "be", " ", "computed"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"orders", "=", 
       RowBox[{"Reverse", "[", 
        RowBox[{"IntegerDigits", "[", "derivativeindex", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "When", " ", "we", " ", "compute", " ", "a", " ", "higher", " ", 
         "order", " ", "derivative", " ", "with", " ", "both", " ", "spatial",
          " ", "and", " ", "orientational", " ", "derivatives"}], ",", " ", 
        RowBox[{
        "we", " ", "need", " ", "to", " ", "reorder", " ", "the", " ", 
         "derivatives", " ", "using", " ", "the", " ", "commutator", " ", 
         "relations", " ", "so", " ", "that", " ", "the", " ", 
         "orientational", " ", "derivative", " ", "is", " ", "calculated", 
         " ", 
         RowBox[{"first", ".", " ", "More"}], " ", "information", " ", 
         "about", " ", "this", " ", "can", " ", "be", " ", "found", " ", "in",
          " ", 
         RowBox[{"Sec", ".", " ", "5.3"}], " ", "of", " ", 
         RowBox[{
          TemplateBox[{
            RowBox[{"Erik", " ", 
              RowBox[{"Franken", "'"}], "s", " ", "PhD", " ", "thesis"}], {
             URL[
             "https://research.tue.nl/en/publications/enhancement-of-crossing-\
elongated-structures-in-images"], None}, 
            "https://research.tue.nl/en/publications/enhancement-of-crossing-\
elongated-structures-in-images", "HyperlinkActionRecycled", {
            "HyperlinkActive"}, BaseStyle -> {"Hyperlink"}, HyperlinkAction -> 
            "Recycled"},
           "HyperlinkTemplate"], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"orders", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "..."}], ",", 
            RowBox[{
             RowBox[{"Except", "[", "3", "]"}], "..."}]}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"(*", 
         RowBox[{
         "All", " ", "orientational", " ", "derivatives", " ", "are", " ", 
          "computed", " ", 
          RowBox[{"first", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"derivative", "=", 
         RowBox[{"LeftInvariantDerivativeCorrectOrder", "[", 
          RowBox[{
          "U", ",", "orders", ",", "\[Sigma]s", ",", "\[Sigma]OD", ",", 
           "angularresolution", ",", "angles"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"derivative", "=", 
         RowBox[{"LeftInvariantDerivativeWrongOrder", "[", 
          RowBox[{
          "U", ",", "derivativeindex", ",", "\[Sigma]s", ",", "\[Sigma]OD"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Return", " ", "Derivatives"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"NotebookDelete", "[", "temporaryprint", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "derivative", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LeftInvariantDerivatives", "[", 
   RowBox[{
   "U_", ",", "derivativeindex_", ",", "\[Sigma]s_", ",", "\[Sigma]a_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"LeftInvariantDerivative", "[", 
     RowBox[{"U", ",", "#", ",", "\[Sigma]s", ",", "\[Sigma]a"}], "]"}], 
    "&"}], "/@", "derivativeindex"}]}]}], "Input",
 CellChangeTimes->{{3.913266316355891*^9, 3.9132663462724314`*^9}, {
   3.91326640534489*^9, 3.913266636777845*^9}, {3.913266674560602*^9, 
   3.913266722627385*^9}, {3.9132669622233953`*^9, 3.9132670732534933`*^9}, {
   3.9132671211399665`*^9, 3.9132671649539127`*^9}, {3.9132672411455283`*^9, 
   3.9132672760560665`*^9}, {3.9132673229054155`*^9, 3.91326741022259*^9}, {
   3.913267459599203*^9, 3.9132674991929502`*^9}, {3.9132675293763933`*^9, 
   3.9132675406618032`*^9}, 3.91326758256355*^9, {3.913267651409629*^9, 
   3.9132677523339977`*^9}, {3.9132677839326763`*^9, 
   3.9132678501899595`*^9}, {3.9132681033267813`*^9, 3.913268167003166*^9}, {
   3.91326820008107*^9, 3.913268229649136*^9}, {3.91327122257629*^9, 
   3.9132712388128424`*^9}, {3.913271305614857*^9, 3.9132713096550045`*^9}, {
   3.9132714007209396`*^9, 3.913271438219386*^9}, {3.913271471794546*^9, 
   3.913271687057373*^9}, {3.9132718667825594`*^9, 3.9132718932613125`*^9}, {
   3.913271988783467*^9, 3.913272198510557*^9}, {3.9132724898160343`*^9, 
   3.9132724911786633`*^9}, {3.9132725366691036`*^9, 3.91327254403657*^9}, {
   3.9132726166706543`*^9, 3.9132726207260313`*^9}, {3.9132726589382734`*^9, 
   3.9132726702227354`*^9}, {3.9132727004239497`*^9, 
   3.9132728547053595`*^9}, {3.91327292413078*^9, 3.9132729703181458`*^9}, {
   3.913273013275709*^9, 3.91327304740345*^9}, {3.913273210974222*^9, 
   3.913273235181641*^9}, {3.913273266034292*^9, 3.9132733635673656`*^9}, {
   3.9132734794371634`*^9, 3.9132735834269814`*^9}, {3.9132736554048004`*^9, 
   3.91327368728664*^9}, {3.913273717493252*^9, 3.9132738091796474`*^9}, 
   3.9132738608048077`*^9, {3.913273901382612*^9, 3.913273930821867*^9}, {
   3.9132739768741016`*^9, 3.9132739973489017`*^9}, {3.9132740512128773`*^9, 
   3.9132740838971834`*^9}, {3.9132741481474323`*^9, 
   3.9132742250857553`*^9}, {3.9132743816972446`*^9, 
   3.9132743865246487`*^9}, {3.913276533308627*^9, 3.913276546926363*^9}, {
   3.9132780892350836`*^9, 3.9132780945227833`*^9}, {3.913278138582215*^9, 
   3.9132781415891047`*^9}, {3.9132781865500307`*^9, 
   3.9132781917764177`*^9}, {3.913278222782586*^9, 3.913278234306244*^9}, {
   3.9132783069330306`*^9, 3.913278357169004*^9}, {3.913278407891507*^9, 
   3.913278412069999*^9}, {3.913278548349722*^9, 3.913278612841592*^9}, {
   3.913279365820752*^9, 3.913279404780896*^9}, {3.913279556550499*^9, 
   3.9132795782372966`*^9}, {3.9132796544061255`*^9, 
   3.9132796923508096`*^9}, {3.913279893494243*^9, 3.913279899866739*^9}, {
   3.9132800877692966`*^9, 3.9132801403592076`*^9}, {3.9132802085237455`*^9, 
   3.9132802146227303`*^9}, {3.913280291737883*^9, 3.913280307475136*^9}, {
   3.913280339523716*^9, 3.9132803614629474`*^9}, {3.9132804493770237`*^9, 
   3.913280456142724*^9}, {3.9132805086156015`*^9, 3.913280517259898*^9}, {
   3.913280583455991*^9, 3.9132806421471643`*^9}, {3.9132806960247374`*^9, 
   3.9132807142075825`*^9}, {3.9132817010783505`*^9, 3.9132817471291304`*^9}, 
   3.9132818137389565`*^9, {3.913281854469602*^9, 3.913281876846076*^9}, {
   3.9132819941431875`*^9, 3.9132820014013443`*^9}, 3.9132820468635254`*^9, {
   3.9132821648403645`*^9, 3.9132821736611214`*^9}, {3.9132822235060635`*^9, 
   3.913282247668455*^9}, {3.9132823511892624`*^9, 3.9132823902271585`*^9}, {
   3.913282663890301*^9, 3.913282671615747*^9}, {3.913282724504727*^9, 
   3.913282801823016*^9}, {3.913282897867173*^9, 3.913282906038251*^9}, {
   3.913283176794826*^9, 3.913283181279191*^9}, 3.9132833015350647`*^9, {
   3.9132833412113667`*^9, 3.9132833593146043`*^9}, 3.9132861772336035`*^9, {
   3.9133483626804237`*^9, 3.913348395529066*^9}, {3.9133484270053825`*^9, 
   3.913348431093735*^9}, {3.9133587860299063`*^9, 3.9133588350151777`*^9}, {
   3.9133588675415916`*^9, 3.913358949931817*^9}, {3.913359063096943*^9, 
   3.9133590696894937`*^9}, 3.9133597230143375`*^9, {3.9133599664158173`*^9, 
   3.9133600023290963`*^9}, {3.9133600931678624`*^9, 3.913360094247072*^9}, {
   3.913360167795355*^9, 3.9133602445193644`*^9}, 3.913361066894164*^9, 
   3.9133613115034037`*^9, {3.9133618650981345`*^9, 3.913361878311364*^9}, 
   3.9133619130095253`*^9, {3.913362147633233*^9, 3.9133621477982936`*^9}, {
   3.913362269864027*^9, 3.913362284528604*^9}, {3.9133630403917494`*^9, 
   3.913363048722866*^9}, {3.9133632154824247`*^9, 3.913363254438673*^9}, {
   3.913363313928294*^9, 3.913363322105999*^9}, {3.913363785767273*^9, 
   3.9133638179753823`*^9}, {3.9133641183812027`*^9, 
   3.9133641332873764`*^9}, {3.9133643563829055`*^9, 3.9133643590708675`*^9}, 
   3.913364422190098*^9, {3.913364484101824*^9, 3.91336448553356*^9}, {
   3.9133650634325404`*^9, 3.913365088624405*^9}, {3.9140451976978626`*^9, 
   3.9140452334089904`*^9}, {3.914045413867149*^9, 3.9140454191208243`*^9}, {
   3.9150895388166957`*^9, 3.915089552389288*^9}, {3.9158526818269925`*^9, 
   3.915852685000721*^9}, {3.9158527248438296`*^9, 3.915852753368204*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"e0401b75-656c-4494-826a-fba2d8bcf73c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrientationScoreHessian", "[", 
    RowBox[{"U_", ",", "\[Sigma]s_", ",", "\[Sigma]a_"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"H", ",", "derivatives"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"derivatives", "=", 
       RowBox[{"LeftInvariantDerivatives", "[", 
        RowBox[{"U", ",", 
         RowBox[{"{", 
          RowBox[{
          "11", ",", "21", ",", "31", ",", "12", ",", "22", ",", "32", ",", 
           "13", ",", "23", ",", "33"}], "}"}], ",", "\[Sigma]s", ",", 
         "\[Sigma]a"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"H", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"derivatives", ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Dimensions", "[", "U", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "H", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.913266316355891*^9, 3.9132663462724314`*^9}, {
   3.91326640534489*^9, 3.913266636777845*^9}, {3.913266674560602*^9, 
   3.913266722627385*^9}, {3.9132669622233953`*^9, 3.9132670732534933`*^9}, {
   3.9132671211399665`*^9, 3.9132671649539127`*^9}, {3.9132672411455283`*^9, 
   3.9132672760560665`*^9}, {3.9132673229054155`*^9, 3.91326741022259*^9}, {
   3.913267459599203*^9, 3.9132674991929502`*^9}, {3.9132675293763933`*^9, 
   3.9132675406618032`*^9}, 3.91326758256355*^9, {3.913267651409629*^9, 
   3.9132677523339977`*^9}, {3.9132677839326763`*^9, 
   3.9132678501899595`*^9}, {3.9132681033267813`*^9, 3.913268167003166*^9}, {
   3.91326820008107*^9, 3.913268229649136*^9}, {3.91327122257629*^9, 
   3.9132712388128424`*^9}, {3.913271305614857*^9, 3.9132713096550045`*^9}, {
   3.9132714007209396`*^9, 3.913271438219386*^9}, {3.913271471794546*^9, 
   3.913271687057373*^9}, {3.9132718667825594`*^9, 3.9132718932613125`*^9}, {
   3.913271988783467*^9, 3.913272198510557*^9}, {3.9132724898160343`*^9, 
   3.9132724911786633`*^9}, {3.9132725366691036`*^9, 3.91327254403657*^9}, {
   3.9132726166706543`*^9, 3.9132726207260313`*^9}, {3.9132726589382734`*^9, 
   3.9132726702227354`*^9}, {3.9132727004239497`*^9, 
   3.9132728547053595`*^9}, {3.91327292413078*^9, 3.9132729703181458`*^9}, {
   3.913273013275709*^9, 3.91327304740345*^9}, {3.913273210974222*^9, 
   3.913273235181641*^9}, {3.913273266034292*^9, 3.9132733635673656`*^9}, {
   3.9132734794371634`*^9, 3.9132735834269814`*^9}, {3.9132736554048004`*^9, 
   3.91327368728664*^9}, {3.913273717493252*^9, 3.9132738091796474`*^9}, 
   3.9132738608048077`*^9, {3.913273901382612*^9, 3.913273930821867*^9}, {
   3.9132739768741016`*^9, 3.9132739973489017`*^9}, {3.9132740512128773`*^9, 
   3.9132740838971834`*^9}, {3.9132741481474323`*^9, 
   3.9132742250857553`*^9}, {3.9132743816972446`*^9, 
   3.9132743865246487`*^9}, {3.913276533308627*^9, 3.913276546926363*^9}, {
   3.9132780892350836`*^9, 3.9132780945227833`*^9}, {3.913278138582215*^9, 
   3.9132781415891047`*^9}, {3.9132781865500307`*^9, 
   3.9132781917764177`*^9}, {3.913278222782586*^9, 3.913278234306244*^9}, {
   3.9132783069330306`*^9, 3.913278357169004*^9}, {3.913278407891507*^9, 
   3.913278412069999*^9}, {3.913278548349722*^9, 3.913278612841592*^9}, {
   3.913279365820752*^9, 3.913279404780896*^9}, {3.913279556550499*^9, 
   3.9132795782372966`*^9}, {3.9132796544061255`*^9, 
   3.9132796923508096`*^9}, {3.913279893494243*^9, 3.913279899866739*^9}, {
   3.9132800877692966`*^9, 3.9132801403592076`*^9}, {3.9132802085237455`*^9, 
   3.9132802146227303`*^9}, {3.913280291737883*^9, 3.913280307475136*^9}, {
   3.913280339523716*^9, 3.9132803614629474`*^9}, {3.9132804493770237`*^9, 
   3.913280456142724*^9}, {3.9132805086156015`*^9, 3.913280517259898*^9}, {
   3.913280583455991*^9, 3.9132806421471643`*^9}, {3.9132806960247374`*^9, 
   3.9132807142075825`*^9}, {3.9132817010783505`*^9, 3.9132817471291304`*^9}, 
   3.9132818137389565`*^9, {3.913281854469602*^9, 3.913281876846076*^9}, {
   3.9132819941431875`*^9, 3.9132820014013443`*^9}, 3.9132820468635254`*^9, {
   3.9132821648403645`*^9, 3.9132821736611214`*^9}, {3.9132822235060635`*^9, 
   3.913282247668455*^9}, {3.9132823511892624`*^9, 3.9132823902271585`*^9}, {
   3.913282663890301*^9, 3.913282671615747*^9}, {3.913282724504727*^9, 
   3.913282801823016*^9}, {3.913282897867173*^9, 3.913282906038251*^9}, {
   3.913283176794826*^9, 3.913283181279191*^9}, 3.9132833015350647`*^9, {
   3.9132833412113667`*^9, 3.9132833593146043`*^9}, 3.9132861772336035`*^9, {
   3.9133483626804237`*^9, 3.913348395529066*^9}, {3.9133484270053825`*^9, 
   3.913348431093735*^9}, {3.9133577060966005`*^9, 3.9133577225168724`*^9}, {
   3.9133670200694647`*^9, 3.913367036956009*^9}, {3.9133671596242833`*^9, 
   3.9133671685837607`*^9}, {3.913367376753078*^9, 3.9133673801703596`*^9}, {
   3.9133680495605907`*^9, 3.913368051557822*^9}, 3.9133682340402884`*^9},
 CellLabel->
  "In[270]:=",ExpressionUUID->"7b91c1b4-6cd2-4ef2-ba5b-1d3e5fc7db3a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Adapted", " ", "from", " ", 
    RowBox[{"LieAnalysis", "\\", "Common", "\\", 
     RowBox[{"ExternalRegularization", ".", "m"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"LieAnalysis", "\\", "Common", "\\", 
    RowBox[{"CoordinateSystemConversions", ".", 
     RowBox[{"m", "\n", "**", " ", 
      RowBox[{"Author", ":", " ", 
       RowBox[{
        RowBox[{"F", ".", "C", ".", " ", "Martin"}], " ", "<", 
        RowBox[{"f", ".", "c", ".", 
         RowBox[{"martin", "@", "tue"}], ".", "nl"}], ">"}]}]}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9131987912047167`*^9, 3.9131987913157196`*^9}, {
   3.9132605839622393`*^9, 3.9132605845440063`*^9}, {3.913260722995036*^9, 
   3.9132607307987604`*^9}, {3.9132608047773733`*^9, 
   3.9132609062833877`*^9}, {3.9132610135813046`*^9, 
   3.9132611106559763`*^9}, {3.9132611598708687`*^9, 3.91326116347782*^9}, {
   3.913261227519309*^9, 3.913261256491106*^9}, {3.9132613686350555`*^9, 
   3.9132613701965103`*^9}, {3.913261456827197*^9, 3.9132617482914867`*^9}, {
   3.913266146033348*^9, 3.913266152483122*^9}, 3.913274365276992*^9, {
   3.9132765521264124`*^9, 3.913276555781418*^9}, {3.913348441482709*^9, 
   3.91334844720072*^9}, {3.9187271595316234`*^9, 3.9187271762329144`*^9}, {
   3.9187275268875427`*^9, 3.9187275296336465`*^9}, 3.91872763878554*^9, {
   3.918727678430316*^9, 3.9187277514758043`*^9}, {3.918728084084567*^9, 
   3.9187281677056*^9}, {3.9187281987305727`*^9, 3.9187282212540727`*^9}, {
   3.918728411324391*^9, 3.918728416395115*^9}, {3.9187926437594175`*^9, 
   3.918792650689191*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"41b3f9fe-0983-40d2-96da-241751ef29f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExternalRegularization", "[", 
    RowBox[{
    "tensorIn_", ",", "orientations_", ",", "\[Sigma]sExt_", ",", 
     "\[Sigma]aExt_"}], "]"}], ":=", 
   RowBox[{"Block", "[", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Not", " ", "sure", " ", "why", " ", "Block", " ", "instead", " ", "of", 
      " ", "Module"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tensor", "=", "tensorIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"periodicitylocal", "=", 
        RowBox[{"2", "\[Pi]"}]}], ",", "\[IndentingNewLine]", 
       "angularresolution", ",", "\[IndentingNewLine]", "\[Sigma]ODExt", ",", 
       "\[IndentingNewLine]", "\[Sigma]s"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"angularresolution", "=", 
       RowBox[{"periodicitylocal", "/", 
        RowBox[{
         RowBox[{"Dimensions", "[", "tensor", "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]ODExt", "=", 
       RowBox[{"\[Sigma]aExt", "/", "angularresolution"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]s", "=", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]sExt", ",", "\[Sigma]sExt", ",", "\[Sigma]ODExt"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Apply", " ", "external", " ", "regularization"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tensor", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"GaussianFilter", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"4", "\[Sigma]s"}], "+", "1"}], ",", "\[Sigma]s"}], 
               "}"}]}], "]"}], "&"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"tensor", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}]}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Return", " ", "the", " ", "object"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "tensor", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9131987912047167`*^9, 3.9131987913157196`*^9}, {
   3.9132605839622393`*^9, 3.9132605845440063`*^9}, {3.913260722995036*^9, 
   3.9132607307987604`*^9}, {3.9132608047773733`*^9, 
   3.9132609062833877`*^9}, {3.9132610135813046`*^9, 
   3.9132611106559763`*^9}, {3.9132611598708687`*^9, 3.91326116347782*^9}, {
   3.913261227519309*^9, 3.913261256491106*^9}, {3.9132613686350555`*^9, 
   3.9132613701965103`*^9}, {3.913261456827197*^9, 3.9132617482914867`*^9}, {
   3.913266146033348*^9, 3.913266152483122*^9}, 3.913274365276992*^9, {
   3.9132765521264124`*^9, 3.913276555781418*^9}, {3.913348441482709*^9, 
   3.9133484523029647`*^9}, 3.9133573363347497`*^9, {3.913364157872963*^9, 
   3.913364170524413*^9}, {3.9133644696699967`*^9, 3.913364472387657*^9}, {
   3.9150894773807507`*^9, 3.9150894980796995`*^9}, {3.915852042022706*^9, 
   3.9158520540076284`*^9}, 3.9158520894623804`*^9, {3.9158525249066334`*^9, 
   3.9158526513013415`*^9}, {3.9187270602878675`*^9, 
   3.9187270897883234`*^9}, {3.9187273239473195`*^9, 3.918727331281267*^9}, {
   3.9187279103030796`*^9, 3.918727983901002*^9}, {3.918728426733127*^9, 
   3.918728431736085*^9}, 3.918790795370791*^9, {3.918792624128806*^9, 
   3.918792635115245*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"2ff546d9-4171-4f0b-a522-90b403ce980c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vesselness Code", "Subsection",
 CellChangeTimes->{{3.9145594624444656`*^9, 
  3.9145594656379857`*^9}},ExpressionUUID->"8bbffd92-8ae1-4706-a711-\
75b886c42820"],

Cell[CellGroupData[{

Cell["Documentation", "Subsubsection",
 CellChangeTimes->{{3.91319793039741*^9, 
  3.9131979332272635`*^9}},ExpressionUUID->"461cda36-ade4-475a-b494-\
2e9a87b7ebb0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SingleScaleVesselnessExtReg", "::", "usage"}], "=", 
    "\"\<SingleScaleVesselnessExtReg[U, mask, \[Xi], \[Zeta], \[Sigma]s, \
\[Sigma]a]\n\treturns the vesselness of the scalar field U, with dimensions \
{Nx, Ny, No}, masked with mask,\n\tat spatial standard deviation \[Sigma]s in \
pixels and angular standard deviation \[Sigma]a in radians, with\n\tleft \
invariant metric tensor field defined by parameters \[Xi] and \[Zeta] as G \
=\!\(\*TagBox[RowBox[{\"(\", \"\[NoBreak]\", GridBox[{{SuperscriptBox[\"\[Xi]\
\", \"2\"], \"0\", \"0\"},{\"0\", FractionBox[SuperscriptBox[\"\[Xi]\", \
\"2\"], SuperscriptBox[\"\[Zeta]\", \"2\"]], \"0\"},{\"0\", \"0\", \"1\"}
},GridBoxAlignment->{\"Columns\" -> {{Center}}, \"Rows\" -> \
{{Baseline}}},GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}}], \"\[NoBreak]\", \")\"}],Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]\). The \n\targuments \[Sigma]sExt and \[Sigma]aExt, \
default 0, define the standard deviations of the external \n\tregularisation \
on the spatial components in pixels and the angular component in radians,\n\t\
respectively.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MultiScaleVesselnessExtReg", "::", "usage"}], "=", 
    "\"\<MultiScaleVesselnessExtReg[U, mask, \[Xi], \[Zeta], \[Sigma]s, \
\[Sigma]a]\n\treturns the vesselness of the scalar field U, with dimensions \
{Nx, Ny, No}, masked with mask,\n\tat spatial standard deviations \[Sigma]s \
in pixels and angular standard deviation \[Sigma]a in radians, with\n\tleft \
invariant metric tensor field defined by parameters \[Xi] and \[Zeta] as G \
=\!\(\*TagBox[RowBox[{\"(\", \"\[NoBreak]\", GridBox[{{SuperscriptBox[\"\[Xi]\
\", \"2\"], \"0\", \"0\"},{\"0\", FractionBox[SuperscriptBox[\"\[Xi]\", \
\"2\"], SuperscriptBox[\"\[Zeta]\", \"2\"]], \"0\"},{\"0\", \"0\", \"1\"}
},GridBoxAlignment->{\"Columns\" -> {{Center}}, \"Rows\" -> \
{{Baseline}}},GridBoxSpacings->{\"Columns\" -> {
Offset[0.27999999999999997`], {
Offset[0.7]}, 
Offset[0.27999999999999997`]}, \"Rows\" -> {
Offset[0.2], {
Offset[0.4]}, 
Offset[0.2]}}], \"\[NoBreak]\", \")\"}],Function[BoxForm`e$, 
MatrixForm[BoxForm`e$]]]\). The \n\targuments \[Sigma]sExt and \[Sigma]aExt, \
default 0, define the standard deviations of the external \n\tregularisation \
on the spatial components in pixels and the angular component in radians,\n\t\
respectively.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergeVesselnessFilters", "::", "usage"}], "=", 
   "\"\<MergeVesselnessFilters[vesselnessfilters]\n\treturns a single \
vesselness filter defined by integrating over the scales in vesselnessfilter \
\n\tand normalising.\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.9132607944292555`*^9, 3.913260794907592*^9}, {
   3.913262533879789*^9, 3.913262606348717*^9}, {3.9132626392088847`*^9, 
   3.9132627266059914`*^9}, 3.9132627742595778`*^9, {3.91326281882034*^9, 
   3.9132628268635144`*^9}, {3.913262876097571*^9, 3.913262913478367*^9}, {
   3.913262949844576*^9, 3.913263013537442*^9}, {3.9132630517028093`*^9, 
   3.913263101065271*^9}, {3.913352290516512*^9, 3.9133523358923664`*^9}, {
   3.914559489339059*^9, 3.914559595518489*^9}, {3.914559631683718*^9, 
   3.9145598107944455`*^9}, {3.9145799117208557`*^9, 
   3.9145799895214252`*^9}, {3.91509397594214*^9, 3.915093982189191*^9}, {
   3.915094033598173*^9, 3.9150941281670384`*^9}, 3.9158534687413826`*^9},
 CellLabel->
  "In[273]:=",ExpressionUUID->"c4019279-2a52-4fe5-a399-80b7a27fe82a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Implementation", "Subsubsection",
 CellChangeTimes->{{3.9133523293450236`*^9, 
  3.9133523313569555`*^9}},ExpressionUUID->"c3e64e1f-3192-4d4f-8943-\
05b13ce514c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SingleScaleVesselnessExtReg", "[", 
   RowBox[{
   "U_", ",", "mask_", ",", "\[Xi]_", ",", "\[Zeta]_", ",", "\[Sigma]s_", ",",
     "\[Sigma]a_", ",", 
    RowBox[{"\[Sigma]sExt_", ":", "0"}], ",", 
    RowBox[{"\[Sigma]aExt_", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "What", " ", "does", " ", "\[Sigma]1", " ", "mean", " ", "and", " ", 
     "why", " ", "do", " ", "we", " ", "pick", " ", "this", " ", 
     RowBox[{"defaults", "?"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Nx", ",", "Ny", ",", "No", ",", "H", ",", "M", ",", "orientations", ",",
       "Hess", ",", "\[Lambda]1", ",", "c", ",", "Q", ",", "S", ",", "R", ",", 
      RowBox[{"\[Sigma]1", "=", "0.5"}], ",", "\[Sigma]2", ",", "vesselness", 
      ",", "Qgreater0", ",", "newvesselnessfilter", ",", 
      "maskedvesselnessfilter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Dimensions", " ", "of", " ", "orientation", " ", "score"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Nx", ",", "Ny", ",", "No"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "U", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temporaryprint", "=", 
      RowBox[{
      "PrintTemporary", "[", "\"\<Computing structural derivatives\>\"", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"structuralDerivatives", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"LeftInvariantDerivatives", "[", 
         RowBox[{"U", ",", 
          RowBox[{"{", 
           RowBox[{"11", ",", "22"}], "}"}], ",", "\[Sigma]s", ",", 
          "\[Sigma]a"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orientations", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"2", "\[Pi]"}], "-", 
         RowBox[{"2", 
          RowBox[{"\[Pi]", "/", "No"}]}]}], ",", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", "No"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookDelete", "[", "temporaryprint", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Sigma]sExt", ",", "\[Sigma]aExt"}], "}"}], " ", "=!=", 
        " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temporaryprint", "=", 
         RowBox[{
         "PrintTemporary", "[", "\"\<Regularising structural derivatives\>\"",
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"structuralDerivatives", "=", " ", 
         RowBox[{"ExternalRegularization", "[", 
          RowBox[{
          "structuralDerivatives", ",", " ", "orientations", ",", " ", 
           "\[Sigma]sExt", ",", "\[Sigma]aExt"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NotebookDelete", "[", "temporaryprint", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"temporaryprint", "=", 
      RowBox[{"PrintTemporary", "[", "\"\<Computing vesselness\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "It", " ", "would", " ", "be", " ", "more", " ", "correct", " ", "to", 
        " ", "use", " ", "the", " ", "gauge", " ", "derivatives"}], ",", " ", 
       RowBox[{
       "however", " ", "LI", " ", "derivatives", " ", "works", " ", "alright",
         " ", "as", " ", "well", " ", "and", " ", "is", " ", "much", " ", 
        "simpler"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]1", "=", 
      RowBox[{
       RowBox[{"structuralDerivatives", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "All", ",", "1"}], 
        "\[RightDoubleBracket]"}], "/", 
       SuperscriptBox["\[Xi]", "2"]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalA]", "11"], "U"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{"structuralDerivatives", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "All", ",", "2"}], 
        "\[RightDoubleBracket]"}], "*", 
       RowBox[{
        SuperscriptBox["\[Zeta]", "2"], "/", 
        SuperscriptBox["\[Xi]", "2"]}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalA]", "22"], "U"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", "c"}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"convexity", " ", "criterion"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Determine", " ", "measures", " ", "that", " ", "are", " ", "used", " ",
        "when", " ", "calculating", " ", "the", " ", "vesselness"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{
       SuperscriptBox["\[Lambda]1", "2"], "+", 
       SuperscriptBox["c", "2"]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"structure", " ", "measure"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"\[Lambda]1", "/", "c"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"anisotropy", " ", "measure"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]2", "=", 
      RowBox[{"0.2", "*", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", "S", "]"}], "]"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", "S", "]"}], "]"}], " ", "ensures", " ", "that", 
       " ", "the", " ", "method", " ", "is", " ", "scaling", " ", 
       "invariant"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calculate", " ", "the", " ", "vesselness", " ", "at", " ", "ALL", " ", 
       "locations", " ", "and", " ", "orientations"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"vesselness", "=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["R", "2"]}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SuperscriptBox["\[Sigma]1", "2"]}], ")"}]}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "S"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "\[Sigma]2"}], ")"}]}], "]"}]}], ")"}]}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Selection", " ", "criterion", " ", "on", " ", "convexity"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Qgreater0", "=", 
      RowBox[{"1", "-", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"-", "Q"}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"is", " ", "Q"}], "==", 
       RowBox[{"0", " ", 
        RowBox[{"important", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Vesselness", " ", "at", " ", "locations", " ", "that", " ", "meet", 
       " ", "the", " ", "convexity", " ", "criterion"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"newvesselnessfilter", "=", 
      RowBox[{"vesselness", "*", "Qgreater0"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Cut", " ", "off", " ", "the", " ", "upper", " ", "border", " ", 
       "which", " ", "influences", " ", "the", " ", "vesselness"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newvesselnessfilter", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "5"}], "]"}], "]"}], "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "Ny", ",", "No"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Cut", " ", "off", " ", "the", " ", "lower", " ", "border", " ", 
       "which", " ", "influences", " ", "the", " ", "vesselness"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newvesselnessfilter", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"-", "5"}], ";;"}], "]"}], "]"}], "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "Ny", ",", "No"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Add", " ", "new", " ", "vesselness", " ", "to", " ", "the", " ", 
       "array", " ", "containing", " ", "vesselness", " ", "filters", " ", 
       "for", " ", "all", " ", "different", " ", "values", " ", "of", " ", 
       "\[Sigma]s"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"maskedvesselnessfilter", "=", 
      RowBox[{"mask", "*", "newvesselnessfilter"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookDelete", "[", "temporaryprint", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "maskedvesselnessfilter", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.913198482656753*^9, {3.913198606247609*^9, 3.913198624768097*^9}, {
   3.9132617744540987`*^9, 3.9132617772684283`*^9}, 3.9132674206394*^9, {
   3.9132750470865946`*^9, 3.913275170039471*^9}, {3.9132752566935835`*^9, 
   3.9132753005236177`*^9}, {3.9132753533557177`*^9, 
   3.9132753822707853`*^9}, {3.9132755813870974`*^9, 
   3.9132757478268404`*^9}, {3.913275798808852*^9, 3.91327580997488*^9}, {
   3.913276063950756*^9, 3.913276225110195*^9}, {3.913276522677698*^9, 
   3.9132765230603437`*^9}, {3.9132768203734713`*^9, 
   3.9132768358114457`*^9}, {3.9132771585818887`*^9, 
   3.9132771587417574`*^9}, {3.9132773276165943`*^9, 3.9132773558454247`*^9}, 
   3.913283317210365*^9, {3.9132853698549376`*^9, 3.9132853723574214`*^9}, {
   3.9132854497055073`*^9, 3.913285451063797*^9}, {3.9132855322768197`*^9, 
   3.9132855347360044`*^9}, {3.9132858415786695`*^9, 3.913285906111375*^9}, {
   3.9132861344102554`*^9, 3.9132861534618487`*^9}, {3.9133512971099143`*^9, 
   3.9133513161570997`*^9}, {3.913351357929556*^9, 3.9133514286502414`*^9}, {
   3.913357224912428*^9, 3.9133572293111467`*^9}, 3.9133572800294437`*^9, 
   3.913357415685244*^9, {3.913357476296212*^9, 3.91335749083329*^9}, {
   3.9133640835753117`*^9, 3.9133640992947717`*^9}, 3.9133645344070005`*^9, 
   3.9133660204188643`*^9, {3.9133661815460634`*^9, 3.913366189145434*^9}, {
   3.913366379135363*^9, 3.9133663842238164`*^9}, 3.9133664284793453`*^9, {
   3.9133665437702694`*^9, 3.9133665552199583`*^9}, {3.913366777543455*^9, 
   3.913366781787729*^9}, {3.9133668230464993`*^9, 3.9133668504453278`*^9}, {
   3.9133691883239365`*^9, 3.913369189202818*^9}, {3.9133694269615765`*^9, 
   3.9133694512125306`*^9}, 3.913956933010992*^9, {3.9139569984482193`*^9, 
   3.9139570010729265`*^9}, 3.9139575042845964`*^9, {3.9140493577673206`*^9, 
   3.9140494219156284`*^9}, {3.914049805582427*^9, 3.9140498064549093`*^9}, {
   3.914050104548688*^9, 3.914050131646821*^9}, {3.914050547737129*^9, 
   3.914050557190193*^9}, {3.914579740160698*^9, 3.9145797423242116`*^9}, {
   3.914579777845722*^9, 3.9145797935689797`*^9}, {3.9150894024421577`*^9, 
   3.9150894529131336`*^9}, {3.917964516031165*^9, 3.9179645319367013`*^9}, {
   3.918726967641693*^9, 3.918727053225834*^9}, {3.9187270972500124`*^9, 
   3.9187271075440865`*^9}, 3.9187272735719233`*^9, {3.918790801719229*^9, 
   3.918790889446359*^9}, 3.91879268328615*^9},
 CellLabel->
  "In[276]:=",ExpressionUUID->"d1908073-5226-44d0-9e22-428ad62187f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiScaleVesselnessExtReg", "[", 
   RowBox[{
   "U_", ",", "mask_", ",", "\[Xi]_", ",", "\[Zeta]_", ",", "\[Sigma]s_", ",",
     "\[Sigma]a_", ",", 
    RowBox[{"\[Sigma]sExt_", ":", "0"}], ",", 
    RowBox[{"\[Sigma]aExt_", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vesselness", ",", "newvesselnessfilter", ",", 
      RowBox[{"vesselnessfilter", "=", 
       RowBox[{"{", "}"}]}], ",", "k", ",", "i", ",", "Nx", ",", "Ny", ",", 
      "No"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Dimensions", " ", "of", " ", "orientation", " ", "score"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Nx", ",", "Ny", ",", "No"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "U", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", "\[Sigma]s", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Select", " ", "the", " ", "spatial", " ", "scale", " ", "for", " ",
            "the", " ", "specific", " ", "iteration"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"k", "=", 
           RowBox[{"\[Sigma]s", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"temporaryprint", "=", 
           RowBox[{"PrintTemporary", "[", 
            RowBox[{"\"\<Computing vesselness at scale \>\"", ",", "k"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Calculate", " ", "the", " ", "vesselness", " ", "of", " ", "the", 
            " ", "full", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"vesselness", "=", 
           RowBox[{"SingleScaleVesselnessExtReg", "[", 
            RowBox[{
            "U", ",", "mask", ",", "\[Xi]", ",", "\[Zeta]", ",", "k", ",", 
             "\[Sigma]a", ",", "\[Sigma]sExt", ",", "\[Sigma]aExt"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"NotebookDelete", "[", "temporaryprint", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"vesselnessfilter", ",", "vesselness"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ProgressIndicator", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Length", "[", "\[Sigma]s", "]"}]}], "}"}]}], "]"}], 
           ",", "i", ",", "\"\</\>\"", ",", 
           RowBox[{"Length", "[", "\[Sigma]s", "]"}]}], "}"}], ",", 
         "\"\< \>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "vesselnessfilter", "]"}]}]}], "\n", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9108609238058133`*^9, 3.910860930529484*^9}, {
   3.911534028898551*^9, 3.911534034966361*^9}, {3.911534638883432*^9, 
   3.9115346397481055`*^9}, {3.9131978247862015`*^9, 
   3.9131978875594625`*^9}, {3.9131979685203576`*^9, 3.913198095287741*^9}, {
   3.913198126028945*^9, 3.9131981528650584`*^9}, {3.9131982940962057`*^9, 
   3.913198388303872*^9}, 3.913198423551984*^9, {3.913198486542949*^9, 
   3.913198507670722*^9}, 3.9132617980551405`*^9, {3.9132754368516893`*^9, 
   3.913275547816448*^9}, {3.913276251236601*^9, 3.9132762517875586`*^9}, {
   3.9132859205461407`*^9, 3.913286011250038*^9}, {3.913350627419647*^9, 
   3.9133506345710864`*^9}, {3.913351326862296*^9, 3.913351353773332*^9}, {
   3.913351408789881*^9, 3.913351410518016*^9}, 3.913353823866131*^9, {
   3.9133691984842634`*^9, 3.9133692083625507`*^9}, {3.913370366168984*^9, 
   3.913370395811858*^9}, 3.9133705472042074`*^9, {3.9139569253027515`*^9, 
   3.913956927411398*^9}, {3.91395698669654*^9, 3.9139569940772514`*^9}, {
   3.914049479546033*^9, 3.9140495063718815`*^9}, {3.9140505408362846`*^9, 
   3.914050541987454*^9}, {3.9140507379750676`*^9, 3.914050740873905*^9}, 
   3.914050884042922*^9, {3.914051457228774*^9, 3.9140514960841446`*^9}, {
   3.914052121845408*^9, 3.9140521401779537`*^9}, {3.914579802021852*^9, 
   3.9145798976463957`*^9}, 3.915089395961276*^9, 3.9158516609466147`*^9, 
   3.9158519405847893`*^9, {3.917964535645177*^9, 3.9179645386535425`*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"f12ae987-d9f8-440c-8d64-d72b7355b573"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MergeVesselnessFilters", "[", "vesselnessfilters_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vesselnessunnormalised", ",", "vesselnessfilter"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Calculate", " ", "vesselness", " ", "per", " ", "location", " ", "and", 
      " ", "orientation", " ", "by", " ", "taking", " ", "sum", " ", "over", 
      " ", "all", " ", "spatial", " ", "scales"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vesselnessunnormalised", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"vesselnessfilters", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Dimensions", "[", "vesselnessfilters", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calculate", " ", "maximum", " ", "value", " ", "in", " ", "sum1"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vesselnessfilter", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"vesselnessunnormalised", "-", 
         RowBox[{"Min", "[", "vesselnessunnormalised", "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Max", "[", "vesselnessunnormalised", "]"}], "-", 
         RowBox[{"Min", "[", "vesselnessunnormalised", "]"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "vesselnessfilter", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.913352264154648*^9, 3.9133522807429996`*^9}, {
   3.913352477773391*^9, 3.913352558719881*^9}, 3.913352809940792*^9, 
   3.9133528805889254`*^9, {3.9133542069033513`*^9, 3.9133542188387456`*^9}, {
   3.9140527792940884`*^9, 3.914052801201972*^9}, {3.9140528465487795`*^9, 
   3.914052851160531*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"595a731e-5ee2-4a64-bb52-8f4e63c0ebe2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Cost Code", "Subsection",
 CellChangeTimes->{{3.914560140713973*^9, 
  3.914560144890857*^9}},ExpressionUUID->"0f15e304-c093-457e-9fef-\
1afd28b09d3f"],

Cell[CellGroupData[{

Cell["Documentation", "Subsubsection",
 CellChangeTimes->{{3.9145601516999598`*^9, 
  3.9145601544594607`*^9}},ExpressionUUID->"a35aff76-3674-462d-8a12-\
166348df8c4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddLifts", "::", "usage"}], "=", 
    "\"\<AddLifts[vesselness, seedsIndex] \n\tadds lifts to the vesselness at \
the points defined by seedsIndex, in order to improve tracking through \
bifurcations.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CostFunction", "::", "usage"}], "=", 
    "\"\<CostFunction[vesselness, \[Lambda], p] \n\treturns the cost function \
associated with the supplied vesselness.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CostFromMultiScaleVesselness", "::", "usage"}], "=", 
   "\"\<CostFromMultiScaleVesselness[vesselness, \[Lambda], p]\n\treturns the \
cost function associated with the supplied vesselness.\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.914560355593959*^9, 3.914560377767003*^9}, {
  3.914560453294405*^9, 3.9145604857546797`*^9}, {3.9150941822060237`*^9, 
  3.9150942450398808`*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"1c37753f-5123-4254-ac79-15d028c98464"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Subsubsection",
 CellChangeTimes->{{3.9145601569202094`*^9, 
  3.9145601584576693`*^9}},ExpressionUUID->"e2bc870d-09a0-400e-8941-\
a1caff83d77c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddLifts", "[", 
   RowBox[{"vesselness_", ",", "seedsIndex_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Nxl", ",", "Nyl", ",", "Nol", ",", "liftElevators", ",", 
      "vesselnesslift"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Nxl", ",", "Nyl", ",", "Nol"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "vesselness", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"liftElevators", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Nol", ",", "Nxl", ",", "Nyl"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"liftElevators", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", "#", ")"}]}]}], "\[RightDoubleBracket]"}], "=", 
          "1"}], ";"}], "&"}], ",", "seedsIndex"}], "]"}], ";", 
     RowBox[{"(*", 
      RowBox[{"What", " ", "is", " ", "this", " ", "supposed", " ", "to", " ", 
       RowBox[{"do", "?"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"liftElevators", "=", 
      RowBox[{"GaussianFilter", "[", 
       RowBox[{"liftElevators", ",", "1.5"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Combine", " ", "both", " ", "mobility", " ", "functions"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vesselnesslift", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"4", "*", 
             RowBox[{"Rescale", "[", "vesselness", "]"}]}], ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"Rescale", "[", "liftElevators", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vesselnesslift", "=", 
      RowBox[{"vesselnesslift", "/", 
       RowBox[{"Max", "[", "vesselnesslift", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "vesselnesslift", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.9133528865395575`*^9, {3.9133530992284718`*^9, 3.9133531045784545`*^9}, {
   3.913353168519992*^9, 3.913353252690937*^9}, {3.9133533053980236`*^9, 
   3.913353310841132*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"86634edb-d014-4828-846d-2258a18b5463"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CostFunction", "[", 
    RowBox[{"vesselness_", ",", "\[Lambda]_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cost", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cost", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[Lambda]", "*", 
           SuperscriptBox["vesselness", "p"]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "cost", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9133521029671197`*^9, 3.9133521879615993`*^9}, 
   3.913352577283453*^9, {3.913352700230754*^9, 3.9133527043114276`*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"14eaee01-363e-42a2-b449-160366c66731"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CostFromVesselness", "[", 
    RowBox[{"vesselness_", ",", "\[Lambda]_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vesselnesslift", ",", "cost"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vesselnesslift", "=", 
       RowBox[{"AddLifts", "[", 
        RowBox[{"vesselness", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{"#", 
            RowBox[{"(*", 
             RowBox[{"-", 
              RowBox[{"{", 
               RowBox[{"ySelect", ",", "0"}], "}"}]}], "*)"}], "&"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Used", " ", "to", " ", "add", " ", "lifts", " ", "at", " ", 
        "bifurcations", " ", "when", " ", "the", " ", "locations", " ", "of", 
        " ", "these", " ", "bifurcations", " ", "is", " ", "known", " ", 
        RowBox[{"beforehand", ".", " ", "Currently"}], " ", 
        RowBox[{"disabled", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"cost", "=", 
       RowBox[{"CostFunction", "[", 
        RowBox[{"vesselnesslift", ",", "\[Lambda]", ",", "p"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "cost", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.91335157221082*^9, 3.913351602809481*^9}, {
  3.9133527505441713`*^9, 3.913352758340267*^9}, {3.9133528006913*^9, 
  3.913352826935608*^9}, {3.9133529357749376`*^9, 3.91335294956761*^9}, {
  3.9133529796503253`*^9, 3.9133529860743513`*^9}, {3.913353263344164*^9, 
  3.9133533484916377`*^9}, {3.91508102002754*^9, 3.9150810670240364`*^9}, {
  3.9150900926226997`*^9, 3.9150901013029547`*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"7b5067f1-ae62-43ba-b72a-1607bae26bb9"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute Vesselness", "Section",
 CellChangeTimes->{{3.9145599583919754`*^9, 
  3.91455996107295*^9}},ExpressionUUID->"4488ee5a-d8fb-4c36-8498-\
ccddf30e9bc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Xi]vesselness", "=", "1"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Metric", " ", "tensor", " ", "parameter", " ", "for", " ", "vesselness"}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Zeta]vesselness", "=", "1"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Metric", " ", "tensor", " ", "parameter", " ", "for", " ", 
     RowBox[{"vesselness", ":", " ", 
      RowBox[{"diag", 
       RowBox[{"(", "G", ")"}]}]}]}], "=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "\[Xi]"], ",", 
      FractionBox["\[Zeta]", "\[Xi]"], ",", "1"}], "}"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]svesselness", "=", 
    RowBox[{"1", "+", 
     RowBox[{"0.5", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Spatial", " ", "standard", " ", "deviations", " ", "at", " ", "which", 
    " ", "the", " ", "vesselness", " ", "is", " ", "computed"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]avesselness", "=", 
    RowBox[{"0.5", "*", 
     SuperscriptBox["0.75", "2"]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Angular", " ", "standard", " ", "deviation", " ", "at", " ", "which", " ",
     "the", " ", "vesselness", " ", "is", " ", "computed"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]spatialExt", "=", "0"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Standard", " ", "deviation", " ", "for", " ", "spatial", " ", "external", 
    " ", "regularisation", " ", "of", " ", "Hessian", " ", "in", " ", 
    "vesselness", " ", "computation"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]angularExt", "=", "0"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Standard", " ", "deviation", " ", "for", " ", "orientational", " ", 
    "external", " ", "regularisation", " ", "of", " ", "Hessian", " ", "in", 
    " ", "vesselness", " ", "computation"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9140537011372433`*^9, 3.914053746944399*^9}, {
   3.9140537778906593`*^9, 3.914053792214876*^9}, {3.9140549395027885`*^9, 
   3.9140551126301384`*^9}, {3.914055265088069*^9, 3.914055335468361*^9}, 
   3.9145600227830124`*^9, 3.91456019016335*^9, {3.914580021566539*^9, 
   3.9145800406026974`*^9}, {3.914580253024952*^9, 3.914580289945353*^9}, {
   3.9146438043496275`*^9, 3.9146438156372223`*^9}, {3.9187269588344965`*^9, 
   3.918726959399897*^9}, {3.928222049358026*^9, 3.9282220691916122`*^9}, {
   3.928224631810053*^9, 3.9282246366050386`*^9}, {3.928224678773771*^9, 
   3.9282246873681364`*^9}, {3.9282247407072954`*^9, 3.928224740796352*^9}, {
   3.9282247815953503`*^9, 3.9282247887536173`*^9}, {3.928226713956077*^9, 
   3.9282267181912107`*^9}, {3.9282267937780457`*^9, 3.928226795470036*^9}, {
   3.9282268794321423`*^9, 3.928226879558775*^9}, 3.9282269866339464`*^9, {
   3.92822704741838*^9, 3.928227075931075*^9}, {3.9282271067632723`*^9, 
   3.928227111186165*^9}, {3.92822736496088*^9, 3.928227365883726*^9}, {
   3.928227451579561*^9, 3.928227452845058*^9}, {3.928227541046549*^9, 
   3.9282275436635094`*^9}, {3.9282276075012436`*^9, 3.928227613147975*^9}, {
   3.9282281017678027`*^9, 3.9282281018610497`*^9}, 3.9285690753899155`*^9, 
   3.9285699030394583`*^9, 3.9285699704749537`*^9, {3.9285700457071114`*^9, 
   3.9285700544577427`*^9}, {3.928570115594103*^9, 3.9285701165157146`*^9}, {
   3.928570386607195*^9, 3.928570388220273*^9}, 3.9285706341771975`*^9, {
   3.9285708968072968`*^9, 3.928570900053176*^9}, 3.9285710049975595`*^9},
 CellLabel->
  "In[285]:=",ExpressionUUID->"50fe6860-c173-4edd-aa38-6be638556479"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mask", "=", 
   RowBox[{"Erosion", "[", 
    RowBox[{
     RowBox[{"ImageData", "@", 
      RowBox[{"Binarize", "[", 
       RowBox[{"Image", "@", "maskhalf"}], "]"}]}], ",", "1", ",", 
     RowBox[{"Padding", "->", "0."}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9282229624628935`*^9, 3.9282230428618*^9}, 
   3.9282230783410387`*^9, {3.9282231333738375`*^9, 3.9282231334377956`*^9}, {
   3.928223175266271*^9, 3.928223175336282*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"692fbd37-5859-4ce7-9fbd-90969341847f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"computetime", ",", "multiscalevesselness"}], "}"}], "=", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"MultiScaleVesselnessExtReg", "[", 
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"osDenoisedErik", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      "mask", ",", "\[Xi]vesselness", ",", "\[Zeta]vesselness", ",", 
      "\[Sigma]svesselness", ",", "\[Sigma]avesselness", ",", 
      "\[Sigma]spatialExt", ",", "\[Sigma]angularExt"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "computetime"}], "Input",
 CellChangeTimes->{{3.914560037445935*^9, 3.914560061926683*^9}, {
  3.9145800458262205`*^9, 3.914580049968794*^9}, {3.9282218773486896`*^9, 
  3.928221880980155*^9}},
 CellLabel->
  "In[292]:=",ExpressionUUID->"3e00d0e9-97fa-4890-b483-45bb5286aaaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"MergeVesselnessFilters", "[", 
    RowBox[{"multiscalevesselness", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.915094290472288*^9, 3.915094325392597*^9}, 
   3.915094462027727*^9, {3.928226918099758*^9, 3.9282269420760264`*^9}, 
   3.928227008065879*^9, {3.9282271442077336`*^9, 3.9282271451228914`*^9}, 
   3.9282271907647734`*^9, 3.9285633225189776`*^9, {3.928566635986021*^9, 
   3.928566636102606*^9}, {3.9285691744189167`*^9, 3.9285692231707897`*^9}, {
   3.928570793775016*^9, 3.9285708114555044`*^9}, {3.9285709036907487`*^9, 
   3.9285709055776386`*^9}, {3.928571078822295*^9, 3.9285710788911014`*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"081c9be4-7e83-468a-8216-9664fd83a2dd"],

Cell[BoxData[
 RowBox[{"Image3D", "[", 
  RowBox[{
   RowBox[{"Rescale", "[", "V", "]"}], ",", 
   RowBox[{"BoxRatios", "->", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0.5", ",", "1"}], "}"}]}], ",", 
   RowBox[{"ViewPoint", "->", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.914560624858206*^9, 3.914560625258789*^9}, 
   3.9150943398500576`*^9, {3.928222106251042*^9, 3.9282221152929945`*^9}, {
   3.9282222956236677`*^9, 3.928222318037064*^9}, {3.928568749275395*^9, 
   3.9285687509112806`*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"79e18c64-9724-451f-b4f1-a7c96ded4671"],

Cell[BoxData[
 RowBox[{"Image", "@", 
  RowBox[{"Rescale", "@", 
   RowBox[{"Map", "[", 
    RowBox[{"Min", ",", 
     RowBox[{"-", "V"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9150943470827103`*^9, 3.9150943556080575`*^9}, {
  3.919502175967085*^9, 3.919502204648041*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"9c1e0769-c38a-45ad-a038-d890eca42f3b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Cost", "Section",
 CellChangeTimes->{{3.91456012041747*^9, 
  3.914560127867725*^9}},ExpressionUUID->"334556c7-8b96-44fc-a202-\
070508d103d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "=", "50"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Cost", " ", "function", " ", "parameter", " ", "giving", " ", "the", " ",
      "cost", " ", "of", " ", "moving", " ", "outside", " ", "of", " ", "a", 
     " ", "vessel", " ", "relative", " ", "to", " ", "moving", " ", "along", 
     " ", "a", " ", 
     RowBox[{"vessel", ":", " ", 
      RowBox[{
      "Higher", " ", "\[Lambda]", " ", "means", " ", "staying", " ", "on", 
       " ", "vessels", " ", "is", " ", "favourable\|01f389"}]}]}], ",", " ", 
    RowBox[{
    "but", " ", "also", " ", "makes", " ", "the", " ", "cost", " ", 
     "function", " ", "less", " ", "coercive\|01f622"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "=", "3.5"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Cost", " ", "function", " ", "parameter", " ", "of", " ", "the", " ", 
     "power", " ", "to", " ", "which", " ", "the", " ", "vesselness", " ", 
     "is", " ", "taken", " ", "in", " ", "the", " ", "cost", " ", 
     RowBox[{"function", ":", " ", 
      RowBox[{
      "Higher", " ", "p", " ", "means", " ", "noise", " ", "is", " ", 
       "ignored\|01f389"}]}]}], ",", " ", 
    RowBox[{
    "but", " ", "also", " ", "small", " ", "vessels", " ", "with", " ", 
     "relatively", " ", "low", " ", "vesselness", " ", "are", " ", 
     "ignored\|01f622"}]}], " ", "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9140565664431143`*^9, 3.9140567376296*^9}, {
   3.914056940266196*^9, 3.914056976443555*^9}, {3.9145803062767773`*^9, 
   3.914580309891176*^9}, 3.9150943618533635`*^9, {3.928224196926531*^9, 
   3.928224197119358*^9}, {3.928224511922016*^9, 3.92822457640655*^9}, {
   3.9282247697175574`*^9, 3.928224770219426*^9}, {3.928225906996088*^9, 
   3.928225907085879*^9}, {3.928228138998041*^9, 3.9282281394634185`*^9}, {
   3.9285706589911823`*^9, 3.928570659150576*^9}, 3.9285706966657224`*^9, 
   3.9285708269964447`*^9, 3.9285710129923077`*^9, {3.928571825484668*^9, 
   3.9285718302036066`*^9}, {3.9285718975788574`*^9, 
   3.9285718978963304`*^9}, {3.9285720676174245`*^9, 3.9285720703302717`*^9}, 
   3.9285735680883827`*^9, 3.9285750085836105`*^9, 3.9285753113006244`*^9, {
   3.9285754081773043`*^9, 3.9285754133795977`*^9}, {3.92857574977829*^9, 
   3.928575750122947*^9}, {3.9285758723954673`*^9, 3.9285758725271225`*^9}, {
   3.9285759298022175`*^9, 3.92857593003395*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"e70abd64-78f3-4511-a942-4e9079748346"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"computetime", ",", "CSE2Thick"}], "}"}], "=", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"CostFromVesselness", "[", 
     RowBox[{"V", ",", "\[Lambda]", ",", "p"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "computetime"}], "Input",
 CellChangeTimes->{{3.914560288294434*^9, 3.9145603006596727`*^9}, {
  3.9150943697549005`*^9, 3.9150943754013834`*^9}, {3.9282258414989605`*^9, 
  3.928225842021874*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"aa69c104-9cf3-46d0-a9e2-457e23c11fce"],

Cell[BoxData[
 RowBox[{"Image3D", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"Transpose", "[", 
     RowBox[{"CSE2Thick", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"BoxRatios", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "1", ",", "1"}], "}"}]}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", "Top"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.928224130951284*^9, 3.928224145738558*^9}, 
   3.9282258466700172`*^9, {3.928568759895449*^9, 3.9285687634567127`*^9}, {
   3.928569866042423*^9, 3.9285698741329355`*^9}, {3.928570445455708*^9, 
   3.9285704466672497`*^9}, {3.9285704782827682`*^9, 3.928570481379846*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"20e269a3-af66-48b0-835c-da5f5c570da0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CSE2", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dilation", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"Padding", "->", "\"\<Periodic\>\""}]}], "]"}], "&"}], ",", 
     "CSE2Thick", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.928225488793958*^9, 3.9282255613269215`*^9}, {
  3.9282257427485247`*^9, 3.928225752807972*^9}, {3.928225850048876*^9, 
  3.9282258552674737`*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"75be2a75-66e7-46c8-88db-abac63985bce"],

Cell[BoxData[{
 RowBox[{"Image3D", "[", 
  RowBox[{
   RowBox[{"1", "-", "CSE2"}], ",", 
   RowBox[{"BoxRatios", "->", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0.5", ",", "1"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Binarize", "[", 
  RowBox[{"Image3D", "[", 
   RowBox[{
    RowBox[{"1", "-", "CSE2"}], ",", 
    RowBox[{"BoxRatios", "->", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0.5", ",", "1"}], "}"}]}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9282256013773956`*^9, 3.9282256140875053`*^9}, {
  3.928225646179598*^9, 3.928225676296472*^9}, {3.928225860218341*^9, 
  3.928225863795553*^9}, {3.928568811963344*^9, 3.9285688133993835`*^9}, {
  3.9285705201607747`*^9, 3.9285705514943094`*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"afef0957-4185-46ce-ab12-27b1b03598ed"],

Cell[BoxData[
 RowBox[{"Image", "[", 
  RowBox[{"Rescale", "[", 
   RowBox[{"Map", "[", 
    RowBox[{"Min", ",", "CSE2", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.914580145539709*^9, 3.9145801687224483`*^9}, {
  3.9195021789674225`*^9, 3.919502209715913*^9}, {3.9282241623224716`*^9, 
  3.928224177673389*^9}, {3.928225821779357*^9, 3.928225829123887*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"8df6339f-7e21-4248-b73d-9d42bac80599"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Thinning and dilation", "Chapter",
 CellChangeTimes->{{3.928552636762683*^9, 
  3.9285526416858*^9}},ExpressionUUID->"4d87868c-72c0-49a5-801e-8a7d380bc9ad"],

Cell[CellGroupData[{

Cell["Prerequisites (Code from Gijs Bellaard)", "Section",
 CellChangeTimes->{{3.862475521745652*^9, 3.862475522612938*^9}, {
  3.862479499974881*^9, 3.862479500140279*^9}, {3.8643626420219593`*^9, 
  3.8643626536287646`*^9}, {3.8902801069141474`*^9, 3.8902801177906246`*^9}, {
  3.8902801629632187`*^9, 
  3.89028016486298*^9}},ExpressionUUID->"373af919-e40b-46f8-ad52-\
25ff1bcde1a6"],

Cell[CellGroupData[{

Cell["Rotating a 3D stack of 2D images", "Subsection",
 CellChangeTimes->{{3.8649719208862734`*^9, 
  3.8649719306224003`*^9}},ExpressionUUID->"7abba3a3-835a-4c68-b75a-\
13a45a6711f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"List3DInterpolation2D", " ", "=", " ", "\[IndentingNewLine]", 
   RowBox[{"Compile", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"img", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"xn", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"yn", ",", "_Integer"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"padding", ",", "_Real"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x0", "=", 
          RowBox[{"Floor", "[", "x", "]"}]}], ",", 
         RowBox[{"y0", "=", 
          RowBox[{"Floor", "[", "y", "]"}]}], ",", 
         RowBox[{"dx", "=", 
          RowBox[{"x", "-", "x0"}]}], ",", 
         RowBox[{"dy", "=", 
          RowBox[{"y", "-", "y0"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "<", "x0", "<", "xn"}], "\[And]", 
          RowBox[{"0", "<", "y0", "<", "yn"}]}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "dx"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "dy"}], ")"}], " ", 
              RowBox[{"img", "\[LeftDoubleBracket]", 
               RowBox[{"x0", ",", "y0", ",", "All"}], 
               "\[RightDoubleBracket]"}]}], "+", 
             RowBox[{"dy", " ", 
              RowBox[{"img", "\[LeftDoubleBracket]", 
               RowBox[{"x0", ",", 
                RowBox[{"y0", "+", "1"}], ",", "All"}], 
               "\[RightDoubleBracket]"}]}]}], ")"}]}], "+", 
          RowBox[{"dx", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "dy"}], ")"}], " ", 
              RowBox[{"img", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"x0", "+", "1"}], ",", "y0", ",", "All"}], 
               "\[RightDoubleBracket]"}]}], "+", 
             RowBox[{"dy", " ", 
              RowBox[{"img", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"x0", "+", "1"}], ",", 
                RowBox[{"y0", "+", "1"}], ",", "All"}], 
               "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"x", "\[Equal]", "xn"}], " ", "\[And]", " ", 
          RowBox[{"0", "<", "y0", "<", "yn"}]}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "dy"}], ")"}], " ", 
           RowBox[{"img", "\[LeftDoubleBracket]", 
            RowBox[{"x0", ",", "y0", ",", "All"}], 
            "\[RightDoubleBracket]"}]}], "+", 
          RowBox[{"dy", " ", 
           RowBox[{"img", "\[LeftDoubleBracket]", 
            RowBox[{"x0", ",", 
             RowBox[{"y0", "+", "1"}], ",", "All"}], 
            "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "\[Equal]", "yn"}], " ", "\[And]", " ", 
          RowBox[{"0", "<", "x0", "<", "xn"}]}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "dx"}], ")"}], 
           RowBox[{"img", "\[LeftDoubleBracket]", 
            RowBox[{"x0", ",", "y0", ",", "All"}], 
            "\[RightDoubleBracket]"}]}], "+", 
          RowBox[{"dx", " ", 
           RowBox[{"img", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"x0", "+", "1"}], ",", "y0", ",", "All"}], 
            "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"x", "\[Equal]", "xn"}], " ", "\[And]", " ", 
          RowBox[{"y", "==", "yn"}]}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"img", "\[LeftDoubleBracket]", 
          RowBox[{"x0", ",", "y0", ",", "All"}], "\[RightDoubleBracket]"}], 
         ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Table", "[", 
          RowBox[{"padding", ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "img", "]"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.864971856222364*^9, 3.864971876873952*^9}, {
   3.9061107347562323`*^9, 3.906110794394919*^9}, 3.907228771418393*^9},
 CellLabel->
  "In[334]:=",ExpressionUUID->"66ddff11-de03-45ad-8165-aec28a22698f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"List3DRotate2D", "=", "\[IndentingNewLine]", 
   RowBox[{"Compile", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"img", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x0", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y0", ",", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"padding", ",", "_Real"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xn", " ", "=", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", "img", "]"}], "\[LeftDoubleBracket]", 
           "2", "\[RightDoubleBracket]"}]}], ",", " ", 
         RowBox[{"yn", " ", "=", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", "img", "]"}], "\[LeftDoubleBracket]", 
           "1", "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"s", " ", "=", " ", 
          RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], ",", " ", 
         RowBox[{"c", " ", "=", " ", 
          RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"List3DInterpolation2D", "[", 
          RowBox[{"img", ",", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"c", " ", "x"}], "+", 
             RowBox[{"s", " ", "y"}], "+", "x0"}], "]"}], ",", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "s"}], " ", "x"}], "+", 
             RowBox[{"c", " ", "y"}], "+", "y0"}], "]"}], ",", "xn", ",", 
           "yn", ",", "padding"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"1", "-", "x0"}], ",", 
           RowBox[{"xn", "-", "x0"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"1", "-", "y0"}], ",", 
           RowBox[{"yn", "-", "y0"}]}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"List3DInterpolation2D", "[", 
         RowBox[{"_", ",", "_", ",", "_", ",", "_", ",", "_", ",", "_"}], 
         "]"}], ",", "_Real", ",", "1"}], "}"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.864971883245599*^9, 3.8649718944660444`*^9}, 
   3.9060304389231205`*^9, {3.906108770523875*^9, 3.9061087811810484`*^9}, {
   3.906108847712948*^9, 3.906108866955908*^9}, {3.906109337532011*^9, 
   3.906109410337713*^9}, {3.9061105629797854`*^9, 3.9061105798277984`*^9}, 
   3.9061106163030396`*^9, {3.90611118334853*^9, 3.9061112121782055`*^9}, {
   3.9061112482564554`*^9, 3.906111254714892*^9}, {3.9061114112648664`*^9, 
   3.90611141246145*^9}, {3.906111450935083*^9, 3.9061114918411846`*^9}, 
   3.906111535351157*^9, {3.906112129428994*^9, 3.9061121455118523`*^9}, {
   3.9061126427219024`*^9, 3.906112647045405*^9}, {3.9061127197720222`*^9, 
   3.9061127214429564`*^9}, {3.9061139415256996`*^9, 3.906113946961727*^9}, {
   3.9061140149391646`*^9, 3.906114040789157*^9}, {3.9072287820529833`*^9, 
   3.907228799653509*^9}, {3.907240308135043*^9, 3.9072403102039137`*^9}, {
   3.910849726291728*^9, 3.9108497356432247`*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"08091653-9256-4f30-9ff5-afd0ca5fe385"]
}, Closed]],

Cell[CellGroupData[{

Cell["Convolution/Correlation Algorithms", "Subsection",
 CellChangeTimes->{{3.864800890142026*^9, 3.864800907547643*^9}, {
  3.865566477840437*^9, 
  3.865566480532665*^9}},ExpressionUUID->"f9d1dac9-8b60-4733-8e4e-\
eaa0c9dcf587"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CyclicTake", "[", 
   RowBox[{
    RowBox[{"a_", "?", "ArrayQ"}], ",", 
    RowBox[{"{", 
     RowBox[{"lower_Integer", ",", "upper_Integer"}], "}"}]}], "]"}], ":=", 
  " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "a", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"lower", "\[LessEqual]", "upper"}], ",", "\[IndentingNewLine]", 
      "\t\t", 
      RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"lower", "-", "1"}], ",", "n"}], "]"}], "===", " ", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"upper", "-", "1"}], ",", "n"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"Take", "[", 
         RowBox[{"a", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"lower", "-", "1"}], ",", "n"}], "]"}], "+", "1"}], 
            ",", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"upper", "-", "1"}], ",", "n"}], "]"}], "+", "1"}]}], 
           "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"a", ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"-", "lower"}], ",", "n"}], "]"}]}], "-", "1"}]}], 
           "]"}], ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Quotient", "[", 
                RowBox[{
                 RowBox[{"upper", "-", "1"}], ",", "n"}], "]"}], "-", 
               RowBox[{"Quotient", "[", 
                RowBox[{
                 RowBox[{"lower", "-", "1"}], ",", "n"}], "]"}], "-", "1"}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{"a", ",", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"upper", "-", "1"}], ",", "n"}], "]"}], "+", "1"}]}], 
           "]"}]}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}], ",", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "\t", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.8649829580480614`*^9, 3.86498295960727*^9}, {
  3.8649832619689074`*^9, 3.8649832924013042`*^9}},
 CellLabel->
  "In[336]:=",ExpressionUUID->"ba179476-e1c0-4e1c-b319-7b74e0bac4c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCorrelate", "[", 
   RowBox[{
    RowBox[{"kernel_", "?", "ArrayQ"}], ",", 
    RowBox[{"bndl_", "?", "ArrayQ"}]}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kernelCenter", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Dimensions", "[", "kernel", "]"}], "+", "1"}], ")"}], "/",
          "2"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"kernelRadius", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Dimensions", "[", "kernel", "]"}], "-", "1"}], ")"}], "/",
          "2"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"bndlHeight", "=", 
        RowBox[{"Length", "[", "bndl", "]"}]}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rotKernel", " ", "=", " ", 
            RowBox[{"List3DRotate2D", "[", 
             RowBox[{"kernel", ",", 
              RowBox[{"\[Pi]", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"k", "-", "1"}], ")"}], "/", "bndlHeight"}]}], ",", 
              RowBox[{
              "kernelCenter", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "kernelCenter", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sub\[LetterSpace]bndl", " ", "=", 
            RowBox[{"CyclicTake", "[", 
             RowBox[{"bndl", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k", "-", 
                 RowBox[{"kernelRadius", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"k", "+", 
                 RowBox[{"kernelRadius", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"klist", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"kernelCenter", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"kernelCenter", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"kernelCenter", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"kernelCenter", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"First", "[", 
          RowBox[{"ListCorrelate", "[", 
           RowBox[{
           "rotKernel", ",", "sub\[LetterSpace]bndl", ",", "klist", " ", ",", 
            "sub\[LetterSpace]bndl", ",", "Times", ",", "Plus"}], "]"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "bndlHeight"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], "/;", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayDepth", "[", "kernel", "]"}], " ", "===", " ", 
     RowBox[{"ArrayDepth", "[", "bndl", "]"}], " ", "===", "3"}], "  ", "&&", 
    " ", 
    RowBox[{"AllTrue", "[", 
     RowBox[{
      RowBox[{"Dimensions", "[", "kernel", "]"}], ",", "OddQ"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8617059071138535`*^9, 3.861705946047845*^9}, {
   3.8618742800089235`*^9, 3.8618742834334164`*^9}, 3.861874430702794*^9, {
   3.8649719721014633`*^9, 3.864971972230237*^9}, {3.864977313557308*^9, 
   3.8649773674927087`*^9}, 3.864977580970931*^9, {3.8649781749839435`*^9, 
   3.8649781824027095`*^9}, {3.86497864794627*^9, 3.8649786574693613`*^9}, {
   3.8649790249594765`*^9, 3.8649790345519714`*^9}, 3.8649793228389974`*^9, {
   3.864979365796213*^9, 3.864979371902713*^9}, {3.8649795604911747`*^9, 
   3.8649795646481915`*^9}, {3.86498318725298*^9, 3.8649831994284067`*^9}, {
   3.8649832997624106`*^9, 3.864983336560193*^9}, {3.8649833780585766`*^9, 
   3.864983538641207*^9}, {3.8649835878513575`*^9, 3.8649835961530666`*^9}, {
   3.864983677476456*^9, 3.8649836779846444`*^9}, {3.864983729160086*^9, 
   3.864983765967784*^9}, {3.864983843723313*^9, 3.864983845976979*^9}, 
   3.8649848132192173`*^9, 3.8649848928571835`*^9, {3.865050231792286*^9, 
   3.865050247665106*^9}, {3.8650505374570723`*^9, 3.865050540055498*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"abec1ac0-c250-4201-9c0e-8c30ac7208cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCorrelateMorpho", "[", 
   RowBox[{
    RowBox[{"kernel_", "?", "ArrayQ"}], ",", 
    RowBox[{"bndl_", "?", "ArrayQ"}]}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kernelCenter", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Dimensions", "[", "kernel", "]"}], "+", "1"}], ")"}], "/",
          "2"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"kernelRadius", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Dimensions", "[", "kernel", "]"}], "-", "1"}], ")"}], "/",
          "2"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"bndlHeight", "=", 
        RowBox[{"Length", "[", "bndl", "]"}]}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rotKernel", " ", "=", " ", 
            RowBox[{"List3DRotate2D", "[", 
             RowBox[{"kernel", ",", 
              RowBox[{"\[Pi]", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"k", "-", "1"}], ")"}], "/", "bndlHeight"}]}], ",", 
              RowBox[{
              "kernelCenter", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "kernelCenter", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}], ",", 
              SuperscriptBox["10", "7"]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sub\[LetterSpace]bndl", " ", "=", 
            RowBox[{"CyclicTake", "[", 
             RowBox[{"bndl", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k", "-", 
                 RowBox[{"kernelRadius", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"k", "+", 
                 RowBox[{"kernelRadius", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"klist", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"kernelCenter", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"kernelCenter", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"kernelCenter", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"kernelCenter", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"First", "[", 
          RowBox[{"ListCorrelate", "[", 
           RowBox[{
           "rotKernel", ",", "sub\[LetterSpace]bndl", ",", "klist", " ", ",", 
            "sub\[LetterSpace]bndl", ",", "Plus", ",", "Min"}], "]"}], " ", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "bndlHeight"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], "/;", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"ArrayDepth", "[", "kernel", "]"}], " ", "===", " ", 
     RowBox[{"ArrayDepth", "[", "bndl", "]"}], " ", "===", "3"}], "  ", "&&", 
    " ", 
    RowBox[{"AllTrue", "[", 
     RowBox[{
      RowBox[{"Dimensions", "[", "kernel", "]"}], ",", "OddQ"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.861874423348833*^9, 3.8618744369724035`*^9}, {
   3.8618762124220195`*^9, 3.8618762573987784`*^9}, {3.8628880230969133`*^9, 
   3.862888049752054*^9}, {3.864795199223553*^9, 3.8647952119194393`*^9}, {
   3.864809337218477*^9, 3.864809341867978*^9}, {3.864810752635583*^9, 
   3.864810756169845*^9}, {3.86481098196518*^9, 3.8648110061149898`*^9}, {
   3.864811347169217*^9, 3.864811352546596*^9}, {3.864812629983091*^9, 
   3.86481270984731*^9}, {3.8648128244701023`*^9, 3.8648128271995897`*^9}, {
   3.864812931610135*^9, 3.8648129425694923`*^9}, {3.864970870144816*^9, 
   3.8649708835061398`*^9}, {3.864970934257557*^9, 3.8649709482884016`*^9}, {
   3.8649719809701977`*^9, 3.8649719909500055`*^9}, {3.8649775292359695`*^9, 
   3.864977531889249*^9}, {3.8649775686421623`*^9, 3.86497757764456*^9}, {
   3.864978587002451*^9, 3.864978587891348*^9}, {3.864979420418297*^9, 
   3.8649794208678694`*^9}, {3.864979541154564*^9, 3.864979543097069*^9}, {
   3.864983497321106*^9, 3.8649835853214827`*^9}, {3.864983684349972*^9, 
   3.864983695704747*^9}, {3.8649837565725822`*^9, 3.864983768995018*^9}, {
   3.8649838529211774`*^9, 3.864983874271291*^9}, 3.8649847988965225`*^9, 
   3.864984894436688*^9, {3.8650502499385233`*^9, 3.8650502524376354`*^9}, {
   3.8650505415210285`*^9, 3.8650505434484434`*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"06bb48eb-fdc1-401a-9bfb-434537f1af48"]
}, Closed]],

Cell[CellGroupData[{

Cell["Orientation Score Transform", "Subsection",
 CellChangeTimes->{{3.6283308046688805`*^9, 3.6283308128694572`*^9}, 
   3.864970958729597*^9, {3.865405427915101*^9, 
   3.8654054308761015`*^9}},ExpressionUUID->"b1b99cb5-33f7-4eed-a1c5-\
c62d7fddd7a7"],

Cell["\<\
All functions directly copied (OrientationScoreTransform is the main function \
of interest)\
\>", "Text",
 CellChangeTimes->{{3.6283308355729156`*^9, 3.6283308660777903`*^9}, 
   3.8660967134315767`*^9},ExpressionUUID->"7d408438-996c-4586-a4e4-\
6af17b4ba670"],

Cell[CellGroupData[{

Cell["Things", "Subsubsection",
 CellChangeTimes->{{3.865405406479128*^9, 
  3.865405407044685*^9}},ExpressionUUID->"51e317f5-70cf-40a3-bc35-\
bfe20bdbc6c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "PolarCoordinateGridRadial", " ", "returns", " ", "a", " ", "matrix", " ", 
    "in", " ", "which", " ", "each", " ", "element", " ", "gives", " ", "the",
     " ", "corresponding", " ", "radial", " ", "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "with", " ", "the", " ", "origin", " ", "in", " ", "the", " ", "center", 
      " ", "of", " ", "the", " ", "matrix"}]}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"PolarCoordinateGridRadial", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"size", ",", "_Integer"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"y", "^", "2"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}]}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "PolarCoordinateGridRadial", " ", "returns", " ", "a", " ", "matrix", " ",
      "in", " ", "which", " ", "each", " ", "element", " ", "gives", " ", 
     "the", " ", "corresponding", " ", "radial", " ", "coordinate", " ", 
     RowBox[{"(", 
      RowBox[{
      "with", " ", "the", " ", "origin", " ", "in", " ", "the", " ", "center",
        " ", "of", " ", "the", " ", "matrix"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"PolarCoordinateGridAngular", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"size", ",", "_Integer"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Arg", "[", 
          RowBox[{"x", "+", 
           RowBox[{"I", " ", "y"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}]}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "MnWindow", " ", "gives", " ", "the", " ", "radial", " ", "windowing", 
     " ", "matrix", " ", "for", " ", "sampling", " ", "the", " ", "fourier", 
     " ", "domain"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"MnWindow", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"size", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Rho]inflection", ",", "_Real"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "\[Rho]Matrix", "}"}], ",", 
         RowBox[{
          RowBox[{"\[Rho]Matrix", "=", 
           RowBox[{"$MachineEpsilon", "+", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", "*", 
                  RowBox[{"\[Rho]inflection", "^", "2"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", " ", "n"}]}], ")"}]}], "]"}]}], " ", 
             RowBox[{"PolarCoordinateGridRadial", "[", "size", "]"}]}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Total", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"E", "^", 
               RowBox[{"-", 
                RowBox[{"\[Rho]Matrix", "^", "2"}]}]}], "*", 
              RowBox[{
               RowBox[{"\[Rho]Matrix", "^", 
                RowBox[{"(", 
                 RowBox[{"2", "k"}], ")"}]}], "/", 
               RowBox[{"k", "!"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "0", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k", "!"}], ",", "_Real"}], "}"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "BSplineScalarFunc", " ", "is", " ", "a", " ", "compile", " ", "spline", 
      " ", "basis", " ", "function", " ", "of", " ", "arbitrary", " ", 
      RowBox[{"order", ".", "The"}], " ", "function", " ", "is", " ", 
      "defined", " ", "for", " ", "scalars"}], ",", 
     RowBox[{
     "list", " ", "and", " ", "2", "D", " ", "matrix", " ", "objects"}]}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"BSplineScalarFunc", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "_Real"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"function", ",", "intervalCheck"}], "}"}], ",", 
         RowBox[{"Total", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"function", "=", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}], "!"}]}], 
                 ")"}]}], " ", 
               RowBox[{"Total", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Binomial", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                    ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}]}], " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "k"}], " ", 
                   RowBox[{"Sign", "[", 
                    RowBox[{"i", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "0", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "]"}]}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"intervalCheck", "=", 
              RowBox[{"Round", "[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "<", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}], "/", "2"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], ")"}]}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}], "-", "$MachineEpsilon"}], 
                    ")"}]}], ")"}]}], "]"}]}]}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"function", "*", "intervalCheck"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "n", "-", "1"}], ")"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1", "+", "1"}], ")"}], "/", "2"}]}], 
             "}"}]}], "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"BSplineListFunc", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"function", ",", "intervalCheck"}], "}"}], ",", 
         RowBox[{"Total", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"function", "=", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}], "!"}]}], 
                 ")"}]}], " ", 
               RowBox[{"Total", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Binomial", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                    ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}]}], " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "k"}], " ", 
                   RowBox[{"Sign", "[", 
                    RowBox[{"i", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "0", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "]"}]}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"intervalCheck", "=", 
              RowBox[{"Round", "[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "<", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}], "/", "2"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], ")"}]}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}], "-", "$MachineEpsilon"}], 
                    ")"}]}], ")"}]}], "]"}]}]}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"function", "*", "intervalCheck"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "n", "-", "1"}], ")"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1", "+", "1"}], ")"}], "/", "2"}]}], 
             "}"}]}], "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"BSplineMatrixFunc", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"function", ",", "intervalCheck"}], "}"}], ",", 
         RowBox[{"Total", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"function", "=", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}], "!"}]}], 
                 ")"}]}], " ", 
               RowBox[{"Total", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Binomial", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "k"}], "]"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                    ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}]}], " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", "k"}], " ", 
                   RowBox[{"Sign", "[", 
                    RowBox[{"i", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "-", "k"}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "0", ",", 
                    RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "]"}]}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"intervalCheck", "=", 
              RowBox[{"Round", "[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "<", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "+", "1", "-", "1"}], ")"}], "/", "2"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}]}], ")"}]}], ")"}]}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", 
                    RowBox[{"1", "/", "2"}], "+", "$MachineEpsilon"}], 
                    ")"}]}], "]"}], "*", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", 
                    RowBox[{"1", "/", "2"}], "-", "$MachineEpsilon"}], 
                    ")"}]}], ")"}]}], "]"}]}]}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"function", "*", "intervalCheck"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "n", "-", "1"}], ")"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1", "+", "1"}], ")"}], "/", "2"}]}], 
             "}"}]}], "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "WindowGauss", " ", "retuns", " ", "the", " ", "spatial", " ", "Gauss", 
     " ", "envelope"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"WindowGauss", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"size", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Sigma]s", ",", "_Real"}], "}"}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "^", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", 
                 RowBox[{"\[Sigma]s", "^", "2"}]}], ")"}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"y", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", 
               RowBox[{"\[Sigma]s", "^", "2"}]}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}], 
             "]"}]}]}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "CakeWaveletStackFourier", " ", "constructs", " ", "the", " ", "cake", 
     " ", "wavelets", " ", "in", " ", "the", " ", "Fourier", " ", "domain", 
     " ", 
     RowBox[{"(", 
      RowBox[{
      "note", " ", "that", " ", "windowing", " ", "in", " ", "the", " ", 
       "spatial", " ", "domain", " ", "is", " ", "still", " ", "required", 
       " ", "after", " ", "this"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"CakeWaveletStackFourier", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"size", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s\[CurlyPhi]", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"kspline", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Rho]Inflection", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"kMn", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"matrixCoordinatesQ", ",", 
           RowBox[{"True", "|", "False"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mnWindow", ",", "angleGrid"}], "}"}], ",", 
         RowBox[{
          RowBox[{"mnWindow", "=", 
           RowBox[{"MnWindow", "[", 
            RowBox[{"size", ",", "kMn", ",", "\[Rho]Inflection"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"angleGrid", "=", 
           RowBox[{"PolarCoordinateGridAngular", "[", "size", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"mnWindow", "*", 
             RowBox[{"BSplineMatrixFunc", "[", 
              RowBox[{"kspline", ",", 
               RowBox[{"If", "[", 
                RowBox[{"matrixCoordinatesQ", ",", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"angleGrid", "-", "\[Theta]", "-", 
                    RowBox[{"\[Pi]", "/", "2"}]}], ",", 
                    RowBox[{"2", "\[Pi]"}], ",", 
                    RowBox[{"-", "\[Pi]"}]}], "]"}], "/", "s\[CurlyPhi]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"angleGrid", "+", "\[Theta]", "+", "\[Pi]"}], ",", 
                    RowBox[{"2", "\[Pi]"}], ",", 
                    RowBox[{"-", "\[Pi]"}]}], "]"}], "/", "s\[CurlyPhi]"}]}], 
                "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "\[Pi]", ",", 
              RowBox[{
               RowBox[{"2", "\[Pi]"}], "-", 
               RowBox[{"s\[CurlyPhi]", "/", "q"}]}], ",", 
              RowBox[{"(", 
               RowBox[{"s\[CurlyPhi]", "/", "q"}], ")"}]}], "}"}]}], 
           "]"}]}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "ErfSet", " ", "retuns", " ", "a", " ", "set", " ", "of", " ", "2", "D", 
     " ", "error", " ", 
     RowBox[{"functions", ".", "This"}], " ", "function", " ", "is", " ", 
     "used", " ", "to", " ", "cut", " ", "the", " ", "wavelets", " ", "in", 
     " ", "two", " ", 
     RowBox[{"(", 
      RowBox[{"in", " ", "the", " ", "spatial", " ", "domain"}], ")"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ErfSet", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"size", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"No", ",", "_Integer"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "d\[Theta]", "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "2"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"Erf", "[", 
                 RowBox[{
                  RowBox[{"x", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "i"}], ")"}], " ", "\[Pi]"}], 
                    ")"}], "/", "No"}], "]"}]}], "+", 
                  RowBox[{"y", " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "i"}], ")"}], " ", "\[Pi]"}], 
                    ")"}], "/", "No"}], "]"}]}]}], "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], 
                "-", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}],
                  "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}],
                  "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ")"}]}], 
                "-", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}],
                  "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "-", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], ",", "1"}],
                  "]"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "No"}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6283308413389482`*^9, 3.6283308429780636`*^9}, {
   3.6361849439838905`*^9, 3.636184981626449*^9}, {3.6361977951105614`*^9, 
   3.636197800991724*^9}, 3.638091605120901*^9, {3.6380939495648823`*^9, 
   3.638093969863186*^9}, {3.8643635898151903`*^9, 3.864363598291545*^9}, {
   3.8643636619198575`*^9, 3.864363701169103*^9}, {3.865399041704276*^9, 
   3.865399081730671*^9}, 3.865399273888098*^9, {3.8653995902629833`*^9, 
   3.865399590364056*^9}, {3.8653996458094053`*^9, 3.865399645898638*^9}, {
   3.86539967876698*^9, 3.8653996864659476`*^9}, {3.8654048827071676`*^9, 
   3.8654049355950794`*^9}, {3.8654049973960333`*^9, 
   3.8654050271628833`*^9}, {3.8654050737085752`*^9, 
   3.8654050998248744`*^9}, {3.8654052318784084`*^9, 3.865405274788109*^9}, {
   3.865405401755903*^9, 3.865405411989806*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"c4e34844-1f09-4d06-92dc-eba04949b5b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CakeWaveletStack", "Subsubsection",
 CellChangeTimes->{
  3.865405217389065*^9},ExpressionUUID->"37f2ac85-f627-48d9-be6a-\
3ac1f94ab3c9"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"CakeWaveletStack", "::", "usage"}], "=", 
    "\"\<CakeWaveletStack[size,s\[CurlyPhi]] returns the set \n\tof rotated \
wavelets with standard paramters (see Options[CakeWaveletStack]).\n\tThe \
kernel stack has dimensions No x size x size, where No = \
\\!\\(\\*FractionBox[\\(s\[CurlyPhi]\\), \\(periodicity\\)]\\). \n\tBy \
default periodicity = \[Pi], meaning that the wavelets are constructed \n\t\
from 0 to \[Pi]. Parameter s\[CurlyPhi] specifies the angular resolution: \n\t\
the number of kernels per \[Pi] radians.\n\nOther parameters can be adjusted \
through the options or by calling the function \n\tas follows:\n \n\
CakeWaveletStack[size,s\[CurlyPhi],kSpline,q,periodicity,\[Rho]Inflection,kMn,\
\[Sigma]s,matrixCoordinatesQ].\>\""}], ";"}]}]], "Code",
 CellLabel->
  "In[348]:=",ExpressionUUID->"999e65cc-94ca-43d3-906b-b56ac973861d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "CakeWaveletStack", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<SplineOrder\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<AngularSubSampleRate\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<Periodicity\>\"", "\[Rule]", "\[Pi]"}], ",", 
     RowBox[{"\"\<InflectionPoint\>\"", "\[Rule]", "\"\<Automatic\>\""}], ",", 
     RowBox[{"\"\<MnOrder\>\"", "\[Rule]", "8"}], ",", 
     RowBox[{"\"\<GaussianWindowSigma\>\"", "\[Rule]", "\"\<Automatic\>\""}], 
     ",", 
     RowBox[{"\"\<InflectionPoint\>\"", "\[Rule]", "\"\<Automatic\>\""}], ",", 
     RowBox[{"\"\<CoordinateSystem\>\"", "\[Rule]", "\"\<Matrix\>\""}], ",", 
     RowBox[{"\"\<SingleVsDoubleSided\>\"", "\[Rule]", "\"\<Double\>\""}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6283308413389482`*^9, 3.6283308429780636`*^9}, {
   3.6361849439838905`*^9, 3.636184981626449*^9}, {3.6361977951105614`*^9, 
   3.636197800991724*^9}, 3.638091605120901*^9, {3.6380939495648823`*^9, 
   3.638093969863186*^9}, {3.8643635898151903`*^9, 3.864363598291545*^9}, {
   3.8643636619198575`*^9, 3.864363701169103*^9}, {3.865399041704276*^9, 
   3.865399081730671*^9}, 3.865399273888098*^9, {3.8653995902629833`*^9, 
   3.865399590364056*^9}, {3.8653996458094053`*^9, 3.865399645898638*^9}, {
   3.86539967876698*^9, 3.8653996864659476`*^9}, {3.8654048827071676`*^9, 
   3.8654049355950794`*^9}, {3.8654049973960333`*^9, 
   3.8654050271628833`*^9}, {3.8654050737085752`*^9, 3.865405108956499*^9}, {
   3.8654052125598626`*^9, 3.865405213778182*^9}, {3.8654053667387934`*^9, 
   3.8654053700271606`*^9}},
 CellLabel->
  "In[349]:=",ExpressionUUID->"11e04f98-237b-4f69-8475-9e50ee51cc5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "definition", " ", "for", " ", "direct", " ", "options", 
    " ", "input"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"CakeWaveletStack", "[", 
     RowBox[{
     "size_", ",", "s\[CurlyPhi]_", ",", "kSpline_", ",", "q_", ",", 
      "periodicity_", ",", "\[Rho]Inflection_", ",", "kMn_", ",", 
      "\[Sigma]s_", ",", "matrixCoordinatesQ_", ",", "singleOrDouble_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cakeF", ",", "cakeIF", ",", "window", ",", "cake"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cakeF", "=", 
        RowBox[{"CakeWaveletStackFourier", "[", 
         RowBox[{
         "size", ",", "s\[CurlyPhi]", ",", "kSpline", ",", "q", ",", 
          "\[Rho]Inflection", ",", "kMn", ",", "matrixCoordinatesQ"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"cakeF", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
              "2"}], ",", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
              "2"}]}], "]"}], "]"}], "=", 
          RowBox[{"0", "*", 
           RowBox[{"s\[CurlyPhi]", "/", "periodicity"}]}]}], ";"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "The", " ", "central", " ", "frequency", " ", "overlaps", " ", 
           "with", " ", "all", " ", "rotated", " ", "kernels"}], ",", 
          RowBox[{
          "it", " ", "should", " ", "still", " ", "ad", " ", "up", " ", "to", 
           " ", "1"}]}], "*)"}], "*)"}], 
       RowBox[{"s", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cakeF", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
             "1", "-", "s"}], ";;", 
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
             "1", "+", "s"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
             "1", "-", "s"}], ";;", 
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], "]"}], "+", 
             "1", "+", "s"}]}]}], "]"}], "]"}], "=", 
        RowBox[{"s\[CurlyPhi]", "/", "periodicity"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "central", " ", "frequency", " ", "overlaps", " ", 
          "with", " ", "all", " ", "rotated", " ", "kernels"}], ",", 
         RowBox[{
         "it", " ", "should", " ", "still", " ", "ad", " ", "up", " ", "to", 
          " ", "1"}]}], "*)"}], 
       RowBox[{"cakeIF", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"RotateRight", "[", 
           RowBox[{
            RowBox[{"InverseFourier", "[", 
             RowBox[{"RotateLeft", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"size", ",", "size"}], "}"}], "/", "2"}], "]"}]}], 
              "]"}], "]"}], ",", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"size", ",", "size"}], "}"}], "/", "2"}], "]"}]}], 
           "]"}], "&"}], "/@", "cakeF"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"window", "=", 
        RowBox[{"WindowGauss", "[", 
         RowBox[{"size", ",", "\[Sigma]s"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cake", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"window", "*", "#"}], "&"}], "/@", "cakeIF"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"periodicity", "\[Equal]", 
          RowBox[{"2", "\[Pi]"}]}], ",", 
         RowBox[{
          RowBox[{"cake", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"cake", ",", 
               RowBox[{"Conjugate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Reverse", "[", 
                   RowBox[{"Reverse", "[", "#", "]"}], "]"}], "&"}], "/@", 
                 "cake"}], "]"}]}], "}"}], ",", "1"}], "]"}]}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"singleOrDouble", "\[Equal]", "\"\<Single\>\""}], ",", 
         RowBox[{
          RowBox[{"cake", "=", 
           RowBox[{"cake", "*", 
            RowBox[{"ErfSet", "[", 
             RowBox[{"size", ",", 
              RowBox[{"q", "*", 
               RowBox[{"periodicity", "/", "s\[CurlyPhi]"}]}]}], "]"}]}]}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cake", "]"}]}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6283308413389482`*^9, 3.6283308429780636`*^9}, {
   3.6361849439838905`*^9, 3.636184981626449*^9}, {3.6361977951105614`*^9, 
   3.636197800991724*^9}, 3.638091605120901*^9, {3.6380939495648823`*^9, 
   3.638093969863186*^9}, {3.8643635898151903`*^9, 3.864363598291545*^9}, {
   3.8643636619198575`*^9, 3.864363701169103*^9}, {3.865399041704276*^9, 
   3.865399081730671*^9}, 3.865399273888098*^9, {3.8653995902629833`*^9, 
   3.865399590364056*^9}, {3.8653996458094053`*^9, 3.865399645898638*^9}, {
   3.86539967876698*^9, 3.8653996864659476`*^9}, {3.8654048827071676`*^9, 
   3.8654049355950794`*^9}, {3.8654049973960333`*^9, 
   3.8654050271628833`*^9}, {3.8654050737085752`*^9, 3.865405108956499*^9}, {
   3.8654052125598626`*^9, 3.865405213778182*^9}, {3.8654053667387934`*^9, 
   3.8654053700271606`*^9}},
 CellLabel->
  "In[350]:=",ExpressionUUID->"59ca5700-f49c-41b7-a99b-f69a6bf5bde0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "definition", " ", "that", " ", "uses", " ", "the", " ", 
    "OptionsPattern"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"CakeWaveletStack", "[", 
     RowBox[{"size_", ",", "s\[CurlyPhi]_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kSpline", ",", "q", ",", "periodicity", ",", "\[Rho]Inflection", ",", 
        "kMn", ",", "\[Sigma]s", ",", "matrixCoordinatesQ", ",", "cakeStack", 
        ",", "singleOrDouble"}], "}"}], ",", 
      RowBox[{"(*", "***************************)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**", "**", "Check"}], " ", "Parameters"}], 
       "*)"}], 
      RowBox[{
       RowBox[{"kSpline", "=", 
        RowBox[{"OptionValue", "[", "\"\<SplineOrder\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"OptionValue", "[", "\"\<AngularSubSampleRate\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"periodicity", "=", 
        RowBox[{"OptionValue", "[", "\"\<Periodicity\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<InflectionPoint\>\"", "]"}], ",", 
         "\"\<Automatic\>\"", ",", 
         RowBox[{
          RowBox[{"\[Rho]Inflection", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], " ", "0.8"}]}], 
          ";"}], ",", "_", ",", 
         RowBox[{"\[Rho]Inflection", "=", 
          RowBox[{"OptionValue", "[", "\"\<InflectionPoint\>\"", "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"kMn", "=", 
        RowBox[{"OptionValue", "[", "\"\<MnOrder\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<GaussianWindowSigma\>\"", "]"}], 
         ",", "\"\<Automatic\>\"", ",", 
         RowBox[{
          RowBox[{"\[Sigma]s", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"size", "-", "1"}], ")"}], "/", "4"}]}], ";"}], ",", "_",
          ",", 
         RowBox[{"\[Sigma]s", "=", 
          RowBox[{
          "OptionValue", "[", "\"\<GaussianWindowSigma\>\"", "]"}]}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<CoordinateSystem\>\"", "]"}], 
          "\[Equal]", "\"\<Matrix\>\""}], ",", 
         RowBox[{"matrixCoordinatesQ", "=", "True"}], ",", 
         RowBox[{"matrixCoordinatesQ", "=", "False"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"singleOrDouble", "=", 
        RowBox[{"OptionValue", "[", "\"\<SingleVsDoubleSided\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "**************************)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"**", "**", "**", "**", "**", "Construct"}], " ", "Stack"}], 
        "*)"}], 
       RowBox[{"cakeStack", "=", 
        RowBox[{"CakeWaveletStack", "[", 
         RowBox[{
         "size", ",", "s\[CurlyPhi]", ",", "kSpline", ",", "q", ",", 
          "periodicity", ",", "\[Rho]Inflection", ",", "kMn", ",", 
          "\[Sigma]s", ",", "matrixCoordinatesQ", ",", "singleOrDouble"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cakeStack", "]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6283308413389482`*^9, 3.6283308429780636`*^9}, {
   3.6361849439838905`*^9, 3.636184981626449*^9}, {3.6361977951105614`*^9, 
   3.636197800991724*^9}, 3.638091605120901*^9, {3.6380939495648823`*^9, 
   3.638093969863186*^9}, {3.8643635898151903`*^9, 3.864363598291545*^9}, {
   3.8643636619198575`*^9, 3.864363701169103*^9}, {3.865399041704276*^9, 
   3.865399081730671*^9}, 3.865399273888098*^9, {3.8653995902629833`*^9, 
   3.865399590364056*^9}, {3.8653996458094053`*^9, 3.865399645898638*^9}, {
   3.86539967876698*^9, 3.8653996864659476`*^9}, {3.8654048827071676`*^9, 
   3.8654049355950794`*^9}, {3.8654049973960333`*^9, 
   3.8654050271628833`*^9}, {3.8654050737085752`*^9, 3.865405108956499*^9}, {
   3.8654052125598626`*^9, 3.865405213778182*^9}, 3.8654053667387934`*^9},
 CellLabel->
  "In[351]:=",ExpressionUUID->"953afee7-8380-4e30-93b3-a582a446235f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["WaveletTransform2D", "Subsubsection",
 CellChangeTimes->{{3.8654051807238235`*^9, 
  3.865405186424452*^9}},ExpressionUUID->"c7710181-e938-4fcf-bc4e-\
fc6e3d0c00c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WaveletTransform2D", "::", "usage"}], "=", 
   "\"\<WaveletTransform2D[kernelStack,im] correlates each \n\tkernel with \
the image. If the kernel dimensions and image dimensions \n\tcoincide, \
correlation is done using (conjugate) Fourier multiplication, else\n\t it is \
done using correlation.\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.865405280236247*^9, 3.8654052815995903`*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"034faaf6-2477-4f04-97f2-f1005f00edc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WaveletTransform2D", "[", 
    RowBox[{"kernels_", ",", "im_", ",", 
     RowBox[{"fourierQ_", ":", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "imF", ",", "kernelsF", ",", "os", ",", "dimkernelx1", ",", 
       "dimkernely1", ",", "dimkernelx2", ",", "dimkernely2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "kernels", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"-", "2"}], ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"Dimensions", "[", "im", "]"}]}], "&&", 
         RowBox[{"fourierQ", "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Using", " ", "the", " ", "Fourier", " ", "transform"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"imF", "=", 
          RowBox[{"Fourier", "[", "im", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"kernelsF", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Fourier", "[", 
             RowBox[{"Reverse", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "&"}], "/@", 
           "kernels"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"os", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"RotateRight", "[", 
             RowBox[{
              RowBox[{"InverseFourier", "[", 
               RowBox[{"#", "*", "imF"}], "]"}], ",", 
              RowBox[{"Ceiling", "[", 
               RowBox[{"0.1", "+", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "im", "]"}], "/", "2"}]}], 
               "]"}]}], "]"}], "&"}], "/@", "kernelsF"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Using", " ", "Correlation"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dimkernelx1", ",", "dimkernely1"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"kernels", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}], "//", 
           "Ceiling"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dimkernelx2", ",", "dimkernely2"}], "}"}], "=", 
          RowBox[{"Dimensions", "[", 
           RowBox[{"kernels", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "dimkernelx2", "]"}], ",", 
           RowBox[{"dimkernelx2", "=", 
            RowBox[{
             RowBox[{"dimkernelx2", "/", "2"}], "+", "1"}]}], ",", 
           RowBox[{"dimkernelx2", "=", 
            RowBox[{
             RowBox[{"dimkernelx2", "/", "2"}], "//", "Ceiling"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "dimkernely2", "]"}], ",", 
           RowBox[{"dimkernely2", "=", 
            RowBox[{
             RowBox[{"dimkernely2", "/", "2"}], "+", "1"}]}], ",", 
           RowBox[{"dimkernely2", "=", 
            RowBox[{
             RowBox[{"dimkernely2", "/", "2"}], "//", "Ceiling"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"os", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ListCorrelate", "[", 
             RowBox[{
              RowBox[{"kernels", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "im", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "dimkernelx1"}], ",", 
                  RowBox[{"-", "dimkernely1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"dimkernelx2", ",", "dimkernely2"}], "}"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "kernels", "]"}], ",", "1"}], "}"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "os", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6283308413389482`*^9, 3.6283308429780636`*^9}, {
   3.6361849439838905`*^9, 3.636184981626449*^9}, {3.6361977951105614`*^9, 
   3.636197800991724*^9}, 3.638091605120901*^9, {3.6380939495648823`*^9, 
   3.638093969863186*^9}, {3.8643635898151903`*^9, 3.864363598291545*^9}, {
   3.8643636619198575`*^9, 3.864363701169103*^9}, {3.865399041704276*^9, 
   3.865399081730671*^9}, 3.865399273888098*^9, {3.8653995902629833`*^9, 
   3.865399590364056*^9}, {3.8653996458094053`*^9, 3.865399645898638*^9}, {
   3.86539967876698*^9, 3.8653996864659476`*^9}, {3.8654048827071676`*^9, 
   3.8654049355950794`*^9}, {3.8654049973960333`*^9, 
   3.8654050271628833`*^9}, {3.8654050737085752`*^9, 
   3.8654051209390793`*^9}, {3.8654051887476826`*^9, 3.8654051913608456`*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"3a3cda3f-076c-4a2f-908c-d5a3ea9aff29"]
}, Open  ]],

Cell[CellGroupData[{

Cell["OrientationScoreTransform", "Subsubsection",
 CellChangeTimes->{{3.865405167994972*^9, 3.865405170728138*^9}, {
  3.8660967134761677`*^9, 
  3.866096726170039*^9}},ExpressionUUID->"67f9cfa9-902a-45dd-90f4-\
5b8864f4e4be"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrientationScoreTransform", "::", "usage"}], "=", 
   "\"\<OrientationScoreTransform[image, s\[CurlyPhi]] \n\tconstructs an \
orientation score from the image using cake wavelets with \n\tdefault \
paramters (see Options[OrientationScoreTransform] and \n\t?CakeWaveletStack). \
By default this is done through Fourier domain \n\tmultiplication, unless it \
is specified (by using the options) otherwise.\>\""}], ";"}]], "Code",
 CellChangeTimes->{
  3.8654052702852316`*^9, {3.866096713481202*^9, 3.866096726176039*^9}},
 CellLabel->
  "In[354]:=",ExpressionUUID->"baa2ea06-d26f-4e05-a16b-d400f08a1fa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "OrientationScoreTransform", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<WaveletSize\>\"", "\[Rule]", "151"}], ",", 
     RowBox[{"\"\<SplineOrder\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<AngularSubSampleRate\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<Periodicity\>\"", "\[Rule]", "\[Pi]"}], ",", 
     RowBox[{"\"\<InflectionPoint\>\"", "\[Rule]", "\"\<Automatic\>\""}], ",", 
     RowBox[{"\"\<MnOrder\>\"", "\[Rule]", "8"}], ",", 
     RowBox[{"\"\<GaussianWindowSigma\>\"", "\[Rule]", "\"\<Automatic\>\""}], 
     ",", 
     RowBox[{"\"\<InflectionPoint\>\"", "\[Rule]", "\"\<Automatic\>\""}], ",", 
     RowBox[{"\"\<CoordinateSystem\>\"", "\[Rule]", "\"\<Matrix\>\""}], ",", 
     RowBox[{"\"\<SingleVsDoubleSided\>\"", "\[Rule]", "\"\<Double\>\""}], 
     ",", 
     RowBox[{"\"\<Method\>\"", "\[Rule]", "\"\<SpatialConvolution\>\""}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6283308413389482`*^9, 3.6283308429780636`*^9}, {
   3.6361849439838905`*^9, 3.636184981626449*^9}, {3.6361977951105614`*^9, 
   3.636197800991724*^9}, 3.638091605120901*^9, {3.6380939495648823`*^9, 
   3.638093969863186*^9}, {3.8643635898151903`*^9, 3.864363598291545*^9}, {
   3.8643636619198575`*^9, 3.864363701169103*^9}, {3.865399041704276*^9, 
   3.865399081730671*^9}, 3.865399273888098*^9, {3.8653995902629833`*^9, 
   3.865399590364056*^9}, {3.8653996458094053`*^9, 3.865399645898638*^9}, {
   3.86539967876698*^9, 3.8653996864659476`*^9}, {3.8654048827071676`*^9, 
   3.8654049355950794`*^9}, {3.8654049973960333`*^9, 
   3.8654050271628833`*^9}, {3.8654050737085752`*^9, 3.86540512869584*^9}, 
   3.8654051932981415`*^9, {3.8654053288326735`*^9, 3.8654053365209103`*^9}, {
   3.866096713489652*^9, 3.86609672618004*^9}},
 CellLabel->
  "In[355]:=",ExpressionUUID->"ee49478d-566d-44e9-9a4e-f5a848bf94cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OrientationScoreTransform", "::", "dim"}], "=", 
   "\"\<Warning! Method \\\"Fourier\\\" can not be used if the image \
dimensions are not equal. Convolution based method with kernel size `1`x`1` \
used instead.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"OrientationScoreTransform", "::", "size"}], "=", 
   "\"\<Warning! Wavelet size can not be specified with method \
\\\"Fourier\\\", size is set equal to the image size.\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.6283308413389482`*^9, 3.6283308429780636`*^9}, {
   3.6361849439838905`*^9, 3.636184981626449*^9}, {3.6361977951105614`*^9, 
   3.636197800991724*^9}, 3.638091605120901*^9, {3.6380939495648823`*^9, 
   3.638093969863186*^9}, {3.8643635898151903`*^9, 3.864363598291545*^9}, {
   3.8643636619198575`*^9, 3.864363701169103*^9}, {3.865399041704276*^9, 
   3.865399081730671*^9}, 3.865399273888098*^9, {3.8653995902629833`*^9, 
   3.865399590364056*^9}, {3.8653996458094053`*^9, 3.865399645898638*^9}, {
   3.86539967876698*^9, 3.8653996864659476`*^9}, {3.8654048827071676`*^9, 
   3.8654049355950794`*^9}, {3.8654049973960333`*^9, 
   3.8654050271628833`*^9}, {3.8654050737085752`*^9, 3.86540512869584*^9}, 
   3.8654051932981415`*^9, {3.8654053288326735`*^9, 3.8654053375773687`*^9}, {
   3.866096713493653*^9, 3.8660967261840754`*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"8bc82193-24fd-428f-b68e-8c77baa8a64f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrientationScoreTransform", "[", 
    RowBox[{"im_", ",", "s\[CurlyPhi]_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dimx", ",", "dimy", ",", "size", ",", "kSpline", ",", "q", ",", 
       "periodicity", ",", "\[Rho]Inflection", ",", "kMn", ",", "\[Sigma]s", 
       ",", "matrixCoordinatesQ", ",", "cakeStack", ",", "os", ",", 
       "singleOrDouble"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dimx", ",", "dimy"}], "}"}], "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "im", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Method\>\"", "]"}], "\[Equal]", 
         "\"\<Fourier\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dimx", "\[NotEqual]", "dimy"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"OrientationScoreTransform", "::", "dim"}], ",", 
             RowBox[{"OptionValue", "[", "\"\<WaveletSize\>\"", "]"}]}], 
            "]"}], ";", " ", 
           RowBox[{"size", "=", 
            RowBox[{"OptionValue", "[", "\"\<WaveletSize\>\"", "]"}]}], ";"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<WaveletSize\>\"", "]"}], 
              "\[NotEqual]", 
              RowBox[{
               RowBox[{"Options", "[", 
                RowBox[{
                "OrientationScoreTransform", ",", "\"\<WaveletSize\>\""}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{"OrientationScoreTransform", "::", "size"}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"size", "=", "dimx"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"size", "=", 
         RowBox[{"OptionValue", "[", "\"\<WaveletSize\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"kSpline", "=", 
       RowBox[{"OptionValue", "[", "\"\<SplineOrder\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"OptionValue", "[", "\"\<AngularSubSampleRate\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"periodicity", "=", 
       RowBox[{"OptionValue", "[", "\"\<Periodicity\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<InflectionPoint\>\"", "]"}], ",", 
        "\"\<Automatic\>\"", ",", 
        RowBox[{
         RowBox[{"\[Rho]Inflection", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"size", "-", "1"}], ")"}], "/", "2"}], " ", "0.9"}]}], 
         ";"}], ",", "_", ",", 
        RowBox[{"\[Rho]Inflection", "=", 
         RowBox[{"OptionValue", "[", "\"\<InflectionPoint\>\"", "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"kMn", "=", 
       RowBox[{"OptionValue", "[", "\"\<MnOrder\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<GaussianWindowSigma\>\"", "]"}], 
        ",", "\"\<Automatic\>\"", ",", 
        RowBox[{
         RowBox[{"\[Sigma]s", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"size", "-", "1"}], ")"}], "/", "4"}]}], ";"}], ",", "_", 
        ",", 
        RowBox[{"\[Sigma]s", "=", 
         RowBox[{"OptionValue", "[", "\"\<GaussianWindowSigma\>\"", "]"}]}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<CoordinateSystem\>\"", "]"}], 
         "\[Equal]", "\"\<Matrix\>\""}], ",", 
        RowBox[{"matrixCoordinatesQ", "=", "True"}], ",", 
        RowBox[{"matrixCoordinatesQ", "=", "False"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"singleOrDouble", "=", 
       RowBox[{"OptionValue", "[", "\"\<SingleVsDoubleSided\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cakeStack", "=", 
       RowBox[{"CakeWaveletStack", "[", 
        RowBox[{
        "size", ",", "s\[CurlyPhi]", ",", "kSpline", ",", "q", ",", 
         "periodicity", ",", "\[Rho]Inflection", ",", "kMn", ",", "\[Sigma]s",
          ",", "matrixCoordinatesQ", ",", "singleOrDouble"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"os", "=", 
       RowBox[{"WaveletTransform2D", "[", 
        RowBox[{"cakeStack", ",", "im", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<Method\>\"", "]"}], "\[Equal]", 
            "\"\<Fourier\>\""}], ",", "1", ",", "0"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "os", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6283308413389482`*^9, 3.6283308429780636`*^9}, {
   3.6361849439838905`*^9, 3.636184981626449*^9}, {3.6361977951105614`*^9, 
   3.636197800991724*^9}, 3.638091605120901*^9, {3.6380939495648823`*^9, 
   3.638093969863186*^9}, {3.8643635898151903`*^9, 3.864363598291545*^9}, {
   3.8643636619198575`*^9, 3.864363701169103*^9}, {3.865399041704276*^9, 
   3.865399081730671*^9}, 3.865399273888098*^9, {3.8653995902629833`*^9, 
   3.865399590364056*^9}, {3.8653996458094053`*^9, 3.865399645898638*^9}, {
   3.86539967876698*^9, 3.8653996864659476`*^9}, {3.8654048827071676`*^9, 
   3.8654049355950794`*^9}, {3.8654049973960333`*^9, 
   3.8654050271628833`*^9}, {3.8654050737085752`*^9, 3.86540512869584*^9}, 
   3.8654051932981415`*^9, {3.8654053288326735`*^9, 3.865405341727069*^9}, {
   3.8660967135006523`*^9, 3.86609672619975*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"2c49fd37-469b-434b-a80b-e0af97325b87"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Distance Approximations", "Subsection",
 CellChangeTimes->{{3.8654788282827597`*^9, 
  3.865478831503728*^9}},ExpressionUUID->"34d3e14f-3937-4e93-96c3-\
17e1f15a219b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cartesianApproximation", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "\[Theta]_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"w1_", ",", "w2_", ",", "w3_"}], "}"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "\[Theta]"}], "}"}], "*", 
    RowBox[{"{", 
     RowBox[{"w1", ",", "w2", ",", "w3"}], "}"}]}], "]"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.8654788345261393`*^9, 3.865478875932912*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"5fd5e78f-8a68-4476-a126-dd8d19550033"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"half", "-", 
    RowBox[{"angle", " ", "coordinates"}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"b", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "\[Theta]_"}], "}"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"{", "\n", "\t ", 
    RowBox[{
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "/", "2"}], "]"}]}], " ", "+", " ", 
      RowBox[{"y", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "/", "2"}], "]"}]}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "x"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "/", "2"}], "]"}]}], " ", "+", " ", 
      RowBox[{"y", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "/", "2"}], "]"}]}]}], ",", "\n", "\t", 
     "\[Theta]"}], "\n", "}"}]}]}]], "Code",
 InitializationCell->False,
 CellLabel->
  "In[360]:=",ExpressionUUID->"b3089416-0bff-44ce-bfc4-b0d4f6642dff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfAngleApproxmation", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "\[Theta]_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"w1_", ",", "w2_", ",", "w3_"}], "}"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{"b", "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "\[Theta]"}], "}"}], "]"}], "*", 
    RowBox[{"{", 
     RowBox[{"w1", ",", "w2", ",", "w3"}], "}"}]}], "]"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.8654788932785983`*^9, 3.8654789426050963`*^9}},
 CellLabel->
  "In[361]:=",ExpressionUUID->"195907f2-0a95-4d5b-8f10-ccb5af1bcb33"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Thinning", "Section",
 CellChangeTimes->{{3.9271750888032427`*^9, 
  3.927175089586335*^9}},ExpressionUUID->"4966a8e6-870a-4be7-8eb1-\
9b46df4aac7d"],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 CellChangeTimes->{{3.927175109869827*^9, 
  3.927175111286799*^9}},ExpressionUUID->"0b1d59b3-d3bd-4529-b36b-\
151004fb04d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"inds", "=", 
        RowBox[{"{", 
         RowBox[{
         "25", ",", "26", ",", "16", ",", "17", ",", "22", ",", "23", ",", 
          "13", ",", "27", ",", "24", ",", "18", ",", "15", ",", "26", ",", 
          "23", ",", "17", ",", "19", ",", "22", ",", "10", ",", "13", ",", 
          "20", ",", "23", ",", "11", ",", "21", ",", "24", ",", "20", ",", 
          "23", ",", "12", ",", "15", ",", "11", ",", "7", ",", "16", ",", 
          "8", ",", "17", ",", "4", ",", "13", ",", "5", ",", "9", ",", "8", 
          ",", "18", ",", "17", ",", "6", ",", "5", ",", "15", ",", "1", ",", 
          "10", ",", "4", ",", "13", ",", "2", ",", "11", ",", "5", ",", "3", 
          ",", "2", ",", "12", ",", "11", ",", "6", ",", "5", ",", "15"}], 
         "}"}]}], ",", 
       RowBox[{"\[Delta]G6", "=", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "3"}], ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "3"}], ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "3"}], ",", "3", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "3", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "3", ",", "3", ",", "1", ",", 
            "5", ",", "3", ",", "3", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "7"}], ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "3"}], ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "3"}], ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "3"}], ",", "3", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "3", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "3", ",", "3", ",", "1", ",", 
            "5", ",", "3", ",", "3", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "128"}], "]"}]}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"preservesEulerCharacteristicQ", "=", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"nb", ",", "_Integer", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"nb", "[", 
                 RowBox[{"[", "inds", "]"}], "]"}], ",", "7"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
               "128", ",", "64", ",", "32", ",", "16", ",", "8", ",", "4", 
                ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"\[Delta]G6", "[", 
               RowBox[{"[", 
                RowBox[{"n", "+", "1"}], "]"}], "]"}], "]"}], "==", "0"}]}]}],
           "]"}], ",", 
         RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
         RowBox[{"CompilationTarget", "->", "\"\<C\>\""}]}], "]"}]}], ";"}]}],
     "]"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a27", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"27", ",", "27"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"tups", "=", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", "3"}], 
         "]"}]}], ",", 
       RowBox[{"dig", "=", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "26"}], "]"}], ",", "3", ",", "3"}], "]"}], "+",
          "1"}]}], ",", 
       RowBox[{"rng", "=", 
        RowBox[{"Range", "[", "27", "]"}]}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "tups", "]"}], "+", "#"}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"0", "<", 
                 RowBox[{"Min", "[", "#", "]"}], "<=", 
                 RowBox[{"Max", "[", "#", "]"}], "<", "4"}], "&"}]}], "]"}], 
             ".", 
             RowBox[{"{", 
              RowBox[{"9", ",", "3", ",", "1"}], "}"}]}], "-", "12"}], "&"}], 
          "/@", "dig"}]}], "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"c1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", "<=", "#", "<=", "27"}], "&&", 
                 RowBox[{"i", "!=", "14"}]}], "&"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "27"}], "}"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"conn1", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"conn2", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"conn3", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{"conn4", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], ",", 
             RowBox[{"conn5", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], ",", 
             RowBox[{"conn6", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], ",", 
             RowBox[{"conn7", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "7", "]"}], "]"}]}], ",", 
             RowBox[{"conn8", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "8", "]"}], "]"}]}], ",", 
             RowBox[{"conn9", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "9", "]"}], "]"}]}], ",", 
             RowBox[{"conn10", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "10", "]"}], "]"}]}], ",", 
             RowBox[{"conn11", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "11", "]"}], "]"}]}], ",", 
             RowBox[{"conn12", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "12", "]"}], "]"}]}], ",", 
             RowBox[{"conn13", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "13", "]"}], "]"}]}], ",", 
             RowBox[{"conn15", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "15", "]"}], "]"}]}], ",", 
             RowBox[{"conn16", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "16", "]"}], "]"}]}], ",", 
             RowBox[{"conn17", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "17", "]"}], "]"}]}], ",", 
             RowBox[{"conn18", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "18", "]"}], "]"}]}], ",", 
             RowBox[{"conn19", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "19", "]"}], "]"}]}], ",", 
             RowBox[{"conn20", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "20", "]"}], "]"}]}], ",", 
             RowBox[{"conn21", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "21", "]"}], "]"}]}], ",", 
             RowBox[{"conn22", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "22", "]"}], "]"}]}], ",", 
             RowBox[{"conn23", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "23", "]"}], "]"}]}], ",", 
             RowBox[{"conn24", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "24", "]"}], "]"}]}], ",", 
             RowBox[{"conn25", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "25", "]"}], "]"}]}], ",", 
             RowBox[{"conn26", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "26", "]"}], "]"}]}], ",", 
             RowBox[{"conn27", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "27", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"simplePointQ", "=", 
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"nb", ",", "_Integer", ",", "1"}], "}"}], "}"}], ",", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"cb", "=", "nb"}], ",", "adj", ",", "pp"}], "}"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"cb", "[", 
                    RowBox[{"[", "14", "]"}], "]"}], "=", "0"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"adj", "=", "a27"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", "cb", "]"}], ">", "23"}], ",", 
                    RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn1"}], "}"}]}], "]"}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn2"}], "}"}]}], "]"}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn3"}], "}"}]}], "]"}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn4"}], "}"}]}], "]"}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn5"}], "}"}]}], "]"}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"6", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn6"}], "}"}]}], "]"}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"7", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn7"}], "}"}]}], "]"}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "8", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn8"}], "}"}]}], "]"}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "9", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"9", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn9"}], "}"}]}], "]"}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "10", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"10", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn10"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "11", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"11", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn11"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "12", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"12", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn12"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "13", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"13", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn13"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "15", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"15", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn15"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "16", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"16", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn16"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "17", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"17", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn17"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "18", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"18", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn18"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "19", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"19", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn19"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "20", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"20", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn20"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "21", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"21", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn21"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "22", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"22", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn22"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "23", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"23", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn23"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "24", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"24", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn24"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "25", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"25", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn25"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "26", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"26", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn26"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "27", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cb", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{
                    RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"27", ",", "j"}], "]"}], "]"}], "=", "1"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "conn27"}], "}"}]}], "]"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"pp", "=", 
                   RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"rng", " ", "cb"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"adj", "=", 
                   RowBox[{"adj", "[", 
                    RowBox[{"[", 
                    RowBox[{"pp", ",", "pp"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"adj", "=", 
                   RowBox[{"adj", "+", 
                    RowBox[{"Transpose", "[", "adj", "]"}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"adj", "=", 
                   RowBox[{"adj", ".", "adj"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Min", "[", "adj", "]"}], ">", "0"}], ",", "True",
                     ",", 
                    RowBox[{
                    RowBox[{"adj", "=", 
                    RowBox[{"adj", ".", "adj"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Min", "[", "adj", "]"}], ">", "0"}]}]}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
               RowBox[{"CompilationTarget", "->", "\"\<C\>\""}]}], "]"}]}], 
            ";"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"morphologicalThinning3DC", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"oim", ",", "_Integer", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"iter", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cnt", "=", "0"}], ",", "X", ",", "Y", ",", "Z", ",", 
          RowBox[{"im", "=", "oim"}], ",", 
          RowBox[{"im2", "=", "oim"}], ",", 
          RowBox[{"samefaces", "=", "0"}], ",", "nb", ",", "bag", ",", 
          "nface", ",", "yo", ",", "sbp", ",", "il", ",", "jl", ",", "kl"}], 
         "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X", ",", "Y", ",", "Z"}], "}"}], "=", 
          RowBox[{"Dimensions", "[", "im", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"cnt", "++"}], "<", "iter"}], "&&", 
            RowBox[{"samefaces", "<", "6"}]}], ",", 
           RowBox[{
            RowBox[{"samefaces", "=", "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nface", "=", "1"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"im", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "==", 
                    "0"}], ",", 
                    RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"!", 
                    RowBox[{"Or", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"f", "==", "1"}], "&&", 
                    RowBox[{
                    RowBox[{"im", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "-", "1"}], ",", "k"}], "]"}], "]"}], "==", 
                    "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"f", "==", "2"}], "&&", 
                    RowBox[{
                    RowBox[{"im", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", "k"}], "]"}], "]"}], "==", 
                    "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"f", "==", "3"}], "&&", 
                    RowBox[{
                    RowBox[{"im", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "j", ",", "k"}], "]"}], 
                    "]"}], "==", "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"f", "==", "4"}], "&&", 
                    RowBox[{
                    RowBox[{"im", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j", ",", "k"}], "]"}], 
                    "]"}], "==", "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"f", "==", "5"}], "&&", 
                    RowBox[{
                    RowBox[{"im", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "==", "0"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"f", "==", "6"}], "&&", 
                    RowBox[{
                    RowBox[{"im", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", 
                    RowBox[{"k", "-", "1"}]}], "]"}], "]"}], "==", "0"}]}]}], 
                    "]"}]}], ",", 
                    RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"nb", "=", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"im", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ";;", 
                    RowBox[{"i", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"j", "-", "1"}], ";;", 
                    RowBox[{"j", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"k", "-", "1"}], ";;", 
                    RowBox[{"k", "+", "1"}]}]}], "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", "nb", "]"}], "!=", "2"}], "&&", 
                    RowBox[{"preservesEulerCharacteristicQ", "[", "nb", "]"}],
                     "&&", 
                    RowBox[{"simplePointQ", "[", "nb", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"simplePointQ", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"im2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ";;", 
                    RowBox[{"i", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"j", "-", "1"}], ";;", 
                    RowBox[{"j", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"k", "-", "1"}], ";;", 
                    RowBox[{"k", "+", "1"}]}]}], "]"}], "]"}], "]"}], "]"}]}],
                     ",", 
                    RowBox[{
                    RowBox[{"im2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
                    "1"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"im2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
                    "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"nface", "=", "0"}], ";"}]}], "]"}], ";"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "2", ",", 
                   RowBox[{"Z", "-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "2", ",", 
                   RowBox[{"Y", "-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{"X", "-", "1"}]}], "}"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"im", "=", "im2"}], ";", "\[IndentingNewLine]", 
               RowBox[{"samefaces", "+=", "nface"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"f", ",", "1", ",", "6"}], "}"}]}], "]"}], ";"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "im"}]}], "]"}], ",", 
      RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
      RowBox[{"CompilationOptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "True"}], ",", 
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}]}], 
        "}"}]}], ",", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MorphologicalThinning3D", "[", 
    RowBox[{"im_", ",", "0"}], "]"}], ":=", "im"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MorphologicalThinning3D", "[", 
    RowBox[{"im_Image3D", ",", 
     RowBox[{"iter_", ":", "Infinity"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"ImageType", "[", "im", "]"}], "===", "\"\<Bit\>\""}]}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"idata", ",", "ii", ",", "res"}], "}"}], ",", 
    RowBox[{
     RowBox[{"idata", "=", 
      RowBox[{"ImageData", "[", 
       RowBox[{"ImagePad", "[", 
        RowBox[{"im", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ii", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"iter", ",", 
        RowBox[{
         RowBox[{"Except", "[", 
          RowBox[{"_Integer", "?", "NonNegative"}], "]"}], "->", 
         RowBox[{"10", "^", "9"}]}], ",", 
        RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"morphologicalThinning3DC", "[", 
       RowBox[{"idata", ",", "ii"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ImagePad", "[", 
      RowBox[{
       RowBox[{"Image3D", "[", 
        RowBox[{"res", ",", "\"\<Bit\>\""}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.907237710393819*^9, 3.907237726819501*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"138d3b2f-a725-41cc-b317-6c8b3e7ee715"]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsection",
 CellChangeTimes->{{3.9271751169530516`*^9, 
  3.9271751175694304`*^9}},ExpressionUUID->"3b587400-b305-465c-b691-\
42ddc957f8be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"thinCost", "=", 
   RowBox[{"MorphologicalThinning3D", "[", 
    RowBox[{"Binarize", "[", 
     RowBox[{"Image3D", "[", 
      RowBox[{"(", 
       RowBox[{"1", "-", "CSE2"}], ")"}], "]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9282233057263775`*^9, 3.9282233110794983`*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"02498ef1-17b5-4b00-9b46-1f5c0190d436"],

Cell[BoxData[
 RowBox[{"Image3D", "[", 
  RowBox[{"thinCost", ",", 
   RowBox[{"BoxRatios", "->", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0.5", ",", "1"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9102510726292686`*^9, 3.9102510835980625`*^9}, {
   3.9102512472756395`*^9, 3.9102512506607423`*^9}, {3.9276157246384735`*^9, 
   3.927615729951151*^9}, 3.9276948472690887`*^9, {3.9285705787499185`*^9, 
   3.9285705941289287`*^9}},
 CellLabel->
  "In[368]:=",ExpressionUUID->"14e127c1-0a1b-470b-88ba-d65721431dcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Set", " ", "up"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "1.5", ",", "50"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", "=", "32"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"orientations", "=", "No"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Theta]step", "=", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "orientations"}]}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"alpha", " ", "=", " ", 
     RowBox[{"2", "*", "0.65"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"beta", " ", "=", " ", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", " ", "-", " ", 
        RowBox[{"1", "/", "alpha"}]}], ")"}]}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"DilationKernel", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "beta"}], " ", "*", " ", 
        SuperscriptBox[
         RowBox[{"halfAngleApproxmation", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "\[Theta]"}], "}"}], ",", "w"}], 
          "]"}], "beta"]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "d"}], ",", "d"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"-", "d"}], ",", "d"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{
          RowBox[{"-", "d"}], " ", "\[Theta]step"}], ",", 
         RowBox[{"d", " ", "\[Theta]step"}], ",", "\[Theta]step"}], "}"}]}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{"Dimensions", "[", "DilationKernel", "]"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Table", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Image", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"List3DRotate2D", "[", 
           RowBox[{"DilationKernel", ",", 
            RowBox[{"\[Theta]step", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}], ",", 
            RowBox[{"d", "+", "1"}], ",", 
            RowBox[{"d", "+", "1"}], ",", 
            SuperscriptBox["10", "7"]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
      "\n", "\t", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "\n", "]"}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{"dilationtable", " ", "=", " ", 
     RowBox[{"Table", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"List3DRotate2D", "[", 
          RowBox[{"DilationKernel", ",", 
           RowBox[{"\[Theta]step", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], ",", 
           RowBox[{"d", "+", "1"}], ",", 
           RowBox[{"d", "+", "1"}], ",", 
           SuperscriptBox["10", "7"]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], ",", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "orientations"}], "}"}]}], "\n", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "list", " ", "of", " ", "points", " ", "that", " ", "are", " ", "within", 
     " ", "reach"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"withinReach", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Ramp", "[", 
           RowBox[{
            RowBox[{"dilationtable", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], "]"}], ",", "0."}], 
         "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"d", "+", "1"}], ")"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "orientations"}], "}"}]}], "]"}]}], ";"}],
    "\n", "\n"}]}]], "Input",
 CellChangeTimes->{{3.9048834037357388`*^9, 3.9048834080227575`*^9}, {
   3.904883557104313*^9, 3.904883576412548*^9}, {3.9048839553952923`*^9, 
   3.90488397401577*^9}, {3.904884150231792*^9, 3.9048841681448164`*^9}, {
   3.904884524875807*^9, 3.904884529065113*^9}, 3.9048849270355225`*^9, {
   3.904890684889282*^9, 3.904890720890507*^9}, {3.9048910185488157`*^9, 
   3.904891055510801*^9}, {3.904962960269287*^9, 3.9049629888509617`*^9}, {
   3.9049638257946386`*^9, 3.90496400824562*^9}, {3.9049641425609293`*^9, 
   3.9049641966548195`*^9}, {3.9049798681539354`*^9, 
   3.9049799606289754`*^9}, {3.9049799920675297`*^9, 
   3.9049799927274914`*^9}, {3.9049800793347244`*^9, 3.904980447358877*^9}, {
   3.9049804791417065`*^9, 3.9049805060971413`*^9}, {3.904980890945881*^9, 
   3.904981002585272*^9}, {3.904981291488632*^9, 3.9049812939135885`*^9}, {
   3.9049813567964945`*^9, 3.904981394796593*^9}, {3.9049814264795837`*^9, 
   3.904981508959073*^9}, {3.9049815497160535`*^9, 3.9049816088624754`*^9}, {
   3.9049816444553685`*^9, 3.9049816731016665`*^9}, {3.904981794797123*^9, 
   3.90498185963522*^9}, {3.9049822840615864`*^9, 3.9049822921675806`*^9}, {
   3.904982341719949*^9, 3.904982344585791*^9}, {3.9049823988824315`*^9, 
   3.904982536670623*^9}, 3.9049841587687488`*^9, {3.90498423724074*^9, 
   3.904984238075202*^9}, {3.9049852372372885`*^9, 3.9049852379874907`*^9}, {
   3.9049858071835375`*^9, 3.904985837807565*^9}, {3.9049862266893573`*^9, 
   3.904986229339017*^9}, {3.9049863319777603`*^9, 3.9049863337688107`*^9}, {
   3.9049867366262326`*^9, 3.9049867379364967`*^9}, {3.904987143280877*^9, 
   3.904987143767649*^9}, 3.904988055897834*^9, {3.9052455987841377`*^9, 
   3.9052458531478977`*^9}, {3.90524659259853*^9, 3.905246603303923*^9}, {
   3.905246812991022*^9, 3.90524684623836*^9}, {3.907751640532821*^9, 
   3.907751644513748*^9}, {3.9077516806026096`*^9, 3.907751722609624*^9}, {
   3.907752343943219*^9, 3.9077523745355167`*^9}, {3.907832224738473*^9, 
   3.9078322248964653`*^9}, {3.9078337850977583`*^9, 3.907833785378423*^9}, {
   3.907833826116457*^9, 3.907833826460145*^9}, {3.907834035919071*^9, 
   3.9078340364030237`*^9}, {3.9078340793838596`*^9, 
   3.9078341399709215`*^9}, {3.90792433474806*^9, 3.9079243427902036`*^9}, {
   3.9079254984190335`*^9, 3.9079255376684723`*^9}, {3.9083519145712442`*^9, 
   3.908351923827955*^9}, 3.9083521212615004`*^9, {3.908352222215871*^9, 
   3.908352234136639*^9}, {3.908879127271675*^9, 3.908879327339806*^9}, {
   3.912156594145809*^9, 3.912156629064908*^9}, {3.913782470338997*^9, 
   3.913782471796945*^9}, {3.913782592103737*^9, 3.9137825933828044`*^9}, {
   3.9276877030350475`*^9, 3.9276877090224285`*^9}, {3.9276882378523874`*^9, 
   3.92768824409864*^9}, {3.9276882786288147`*^9, 3.927688289808106*^9}, {
   3.9276883400880585`*^9, 3.9276883596858835`*^9}, {3.9276883898533125`*^9, 
   3.9276883925459967`*^9}, 3.9276887418740225`*^9, {3.9276902455481496`*^9, 
   3.927690251092232*^9}, {3.927691608607028*^9, 3.927691657202074*^9}, {
   3.9276917350791683`*^9, 3.927691762972479*^9}, {3.927691876379929*^9, 
   3.9276918795090885`*^9}, {3.9276924948107705`*^9, 
   3.9276925177702208`*^9}, {3.927693144583029*^9, 3.9276931637123594`*^9}, {
   3.9276932266556845`*^9, 3.9276932395045652`*^9}, {3.9276932744801598`*^9, 
   3.927693292364172*^9}, {3.9276933400909348`*^9, 3.9276933514822254`*^9}, {
   3.9276935879390945`*^9, 3.9276935915502205`*^9}, {3.9276937042112904`*^9, 
   3.927693714465885*^9}, {3.92769449699908*^9, 3.9276945024804306`*^9}, {
   3.927694571704837*^9, 3.927694620533058*^9}, {3.92769474692936*^9, 
   3.927694747362383*^9}, 3.9276948748798623`*^9, {3.9276950034691877`*^9, 
   3.9276950047108097`*^9}, {3.927696571018745*^9, 3.9276966345809703`*^9}, {
   3.9276966848314033`*^9, 3.9276967089044695`*^9}, 3.9285526689294624`*^9, 
   3.928563673172655*^9, {3.928563790192587*^9, 3.9285638127755723`*^9}, {
   3.928571163167287*^9, 3.9285711708360558`*^9}, 3.9285735840571337`*^9, {
   3.9285738921000223`*^9, 3.928573892754053*^9}, {3.928574024993023*^9, 
   3.9285740259430294`*^9}, 3.9285746949883504`*^9, {3.9285747776387944`*^9, 
   3.9285747793021216`*^9}, 3.928574813384385*^9, 3.9285750819421206`*^9},
 CellLabel->
  "In[369]:=",ExpressionUUID->"023be18e-a88f-449f-8612-4890e456231f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DilationImageVesselness", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"CSE2", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], "]"}], "+", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"4", "*", "d"}], ",", 
        RowBox[{"4", "*", "d"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DilationImageVesselness", "[", 
     RowBox[{"[", " ", 
      RowBox[{"All", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "d"}], "+", "1"}], ")"}], ";;", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "d"}], "+", "1"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "d"}], "+", "1"}], ")"}], ";;", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "d"}], "+", "1"}], ")"}]}]}]}], " ", "]"}], "]"}], 
    "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{"ImageData", "[", "thinCost", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetValueToOne", "[", 
    RowBox[{"\[Theta]_", ",", "x_", ",", "y_"}], "]"}], ":=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"DilationImageVesselness", "[", 
      RowBox[{"[", 
       RowBox[{"\[Theta]", ",", "x", ",", "y"}], "]"}], "]"}], " ", "=", " ", 
     "1"}], " ", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LocFunc", "[", "pos_", "]"}], " ", ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pos", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", 
            "orientations"}], "]"}], "+", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "&"}], ",", " ", 
      RowBox[{"withinReach", "[", 
       RowBox[{"[", 
        RowBox[{"pos", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DilationPos", " ", "=", " ", 
    RowBox[{"Position", "[", 
     RowBox[{"DilationImageVesselness", ",", " ", "1"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"LocList", " ", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LocFunc", "[", "#", "]"}], "&"}], ",", " ", "DilationPos"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LocList", " ", "=", " ", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{"LocList", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"(", 
           RowBox[{"Flatten", "@", "LocList"}], ")"}]}], "/", "3"}], ",", 
        "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Here", " ", "we", " ", "set", " ", "the", " ", "neigborhood", " ", "of", 
    " ", "the", " ", "points", " ", "that", " ", "have", " ", "value", " ", 
    "1", " ", "to", " ", "1"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SetValueToOne", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", " ", "LocList"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Image3D", "[", "DilationImageVesselness", "]"}]}], "Input",
 CellChangeTimes->{{3.908351970145547*^9, 3.908351976762072*^9}, {
   3.9083521435559835`*^9, 3.908352176733479*^9}, {3.908879060650756*^9, 
   3.908879066927425*^9}, {3.908879564900296*^9, 3.9088795663726406`*^9}, {
   3.9094782105497503`*^9, 3.909478214579474*^9}, 3.9146558070697236`*^9, {
   3.914655866655632*^9, 3.914655920345796*^9}, {3.9146559702880783`*^9, 
   3.914655977002267*^9}, {3.927688784181061*^9, 3.9276888239181404`*^9}, {
   3.927688893795107*^9, 3.927688904387184*^9}, {3.927688956236249*^9, 
   3.9276890051525*^9}, {3.9276904409367504`*^9, 3.9276904412728186`*^9}, {
   3.9276905597706146`*^9, 3.9276905910393534`*^9}, {3.92769062340571*^9, 
   3.9276906293409047`*^9}, {3.9276907034282117`*^9, 3.927690705426056*^9}, {
   3.9276908508275948`*^9, 3.927690882096531*^9}, {3.927697583503583*^9, 
   3.9276975890289664`*^9}, {3.9276977312474813`*^9, 3.927697762720525*^9}, {
   3.9277010041125517`*^9, 3.9277010070420675`*^9}, {3.92770109700008*^9, 
   3.927701123593384*^9}, {3.928228787669411*^9, 3.9282287917712345`*^9}},
 CellLabel->
  "In[380]:=",ExpressionUUID->"4511a6e7-5a03-46d8-81ca-d31ef92874ac"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Connected Components", "Title",
 CellChangeTimes->{{3.9058480603276577`*^9, 3.9058480641681247`*^9}, {
   3.927193744433096*^9, 3.927193747025034*^9}, 
   3.9338439060420637`*^9},ExpressionUUID->"f3c89fb5-3658-4434-90e3-\
12db05fa2820"],

Cell[CellGroupData[{

Cell["Binarized image", "Section",
 CellChangeTimes->{{3.905848138912648*^9, 3.9058481431755514`*^9}, 
   3.911029414553543*^9},ExpressionUUID->"fb627fb6-6fe5-4486-b206-\
0c753238b2ab"],

Cell[CellGroupData[{

Cell["Set parameters", "Subsection",
 CellChangeTimes->{{3.927175252602642*^9, 
  3.927175254369238*^9}},ExpressionUUID->"a470997d-a973-4e1b-a26f-\
c5aa3f95d724"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"without", " ", "dilation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"{", 
      RowBox[{"0.2", ",", "1", ",", "2"}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"with", " ", "dilation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.7", ",", "4"}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.9229551492230735`*^9, 3.9229551577828813`*^9}, {
   3.9276169622543316`*^9, 3.9276169629942408`*^9}, {3.9276170125771723`*^9, 
   3.927617020751073*^9}, {3.9276172295389442`*^9, 3.9276172538347387`*^9}, {
   3.9276175002190523`*^9, 3.92761750709546*^9}, {3.927617634726796*^9, 
   3.9276176355610266`*^9}, {3.92761780303985*^9, 3.927617803423644*^9}, {
   3.9276179960218077`*^9, 3.927618006805703*^9}, {3.927618204449115*^9, 
   3.9276182080264025`*^9}, {3.9276188501376076`*^9, 3.92761885123576*^9}, {
   3.9276198758223963`*^9, 3.92761987742183*^9}, {3.927620137826053*^9, 
   3.9276201381733723`*^9}, {3.927620789776743*^9, 3.9276207916456614`*^9}, {
   3.9276210725161695`*^9, 3.927621074100271*^9}, {3.9276212689976335`*^9, 
   3.927621270176015*^9}, {3.9276214529098806`*^9, 3.9276214540094843`*^9}, {
   3.9276217969120607`*^9, 3.9276217969885216`*^9}, {3.9276234683359203`*^9, 
   3.9276234690455856`*^9}, {3.9276236020574074`*^9, 
   3.9276236026232224`*^9}, {3.9276237442802315`*^9, 
   3.9276237513380723`*^9}, {3.9276238571130943`*^9, 
   3.9276238630643263`*^9}, {3.927623954645686*^9, 3.927623956568833*^9}, {
   3.9276240447654467`*^9, 3.92762404527864*^9}, 3.9276247346133404`*^9, {
   3.9276249910609016`*^9, 3.9276249913928604`*^9}, {3.9277014826362114`*^9, 
   3.9277014998637857`*^9}, {3.927702017083947*^9, 3.927702101795405*^9}, {
   3.9277022919469147`*^9, 3.927702292116638*^9}, 3.9277027518780813`*^9, {
   3.9277029788144035`*^9, 3.927702985844032*^9}, {3.9277031695670547`*^9, 
   3.927703172216302*^9}, {3.9282236037751813`*^9, 3.9282236164152994`*^9}, {
   3.9282285138226023`*^9, 3.928228513892565*^9}, {3.9282286279337263`*^9, 
   3.928228629033059*^9}, {3.928229165307829*^9, 3.928229166361247*^9}, {
   3.9282292417465634`*^9, 3.9282292461753798`*^9}, {3.9285638969805517`*^9, 
   3.928563899567557*^9}, 3.9285712887035356`*^9, {3.9285714454332952`*^9, 
   3.9285714649445267`*^9}, 3.9285737957562428`*^9, 3.928573873744915*^9, {
   3.9289941403768077`*^9, 3.9289941419308496`*^9}, {3.928994258253093*^9, 
   3.92899426209923*^9}, 3.9289950137702646`*^9, {3.9289950890586233`*^9, 
   3.928995089145638*^9}, 3.9289952142575426`*^9, 3.9289955045620775`*^9},
 CellLabel->
  "In[389]:=",ExpressionUUID->"57bda0c9-b95f-4d0e-8ad7-a3acb3c02139"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "If", " ", "this", " ", "is", " ", "changed", " ", "run", " ", "all", " ", 
    "following", " ", "cells", " ", "again"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"orientations", " ", "=", " ", "No"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Theta]step", " ", "=", " ", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "orientations"}]}]}], ";"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.890286943106577*^9, 3.890286946560541*^9}, 
   3.905852055962388*^9, {3.905933707482855*^9, 3.9059337076888895`*^9}, {
   3.9276233622500706`*^9, 3.9276233623231544`*^9}, 3.9276244433049235`*^9},
 CellLabel->
  "In[390]:=",ExpressionUUID->"269ca9a7-3480-4a0c-9e5e-305b4d19de68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imagebindata", "=", 
   RowBox[{"(*", 
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{"ImageData", "[", "thinCost", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], "*)"}], 
   RowBox[{"DilationImageVesselness", "[", 
    RowBox[{"[", " ", 
     RowBox[{"All", ",", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "d"}], "+", "1"}], ")"}], ";;", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "d"}], "+", "1"}], ")"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "d"}], "+", "1"}], ")"}], ";;", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "d"}], "+", "1"}], ")"}]}]}]}], " ", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"imagebindata", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", 
      RowBox[{"No", "/", "4"}]}], "]"}], "]"}], "=", 
   RowBox[{"imagebindata", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{"2", 
        RowBox[{"No", "/", "4"}]}]}], ";;", 
      RowBox[{"3", 
       RowBox[{"No", "/", "4"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"imagebindata", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"3", 
         RowBox[{"No", "/", "4"}]}], "+", "1"}], ";;", "No"}], "]"}], "]"}], 
    "=", 
    RowBox[{"imagebindata", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"No", "/", "4"}], "+", "1"}], ";;", 
       RowBox[{"2", 
        RowBox[{"No", "/", "4"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Using", " ", "bifurcation", " ", "or", " ", "not"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"imagebindata", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"Sequence", "@@", "#"}]}], "\[RightDoubleBracket]"}], "=", 
        "1"}], ";"}], "&"}], ",", "seedsNew"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"constantmatrix", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", " ", 
       RowBox[{"Dimensions", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"ImageData", "[", "thinCost", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"constantmatrix", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"Sequence", "@@", "#"}]}], "\[RightDoubleBracket]"}], "=", 
         "1"}], ";"}], "&"}], ",", "seedsIndex"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"imagebindata", "=", " ", 
     RowBox[{
      RowBox[{"Dilation", "[", 
       RowBox[{"constantmatrix", ",", "1"}], "]"}], "+", "imagebindata"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.914488936547594*^9, 3.9144889399828777`*^9}, {
   3.914489011124015*^9, 3.9144890444504495`*^9}, {3.927621679044322*^9, 
   3.9276217900883055`*^9}, 3.9276218838972797`*^9, 3.9276221200135365`*^9, {
   3.927622469260744*^9, 3.927622469876354*^9}, {3.927622708778201*^9, 
   3.9276227975512075`*^9}, {3.927622839484439*^9, 3.927622851335369*^9}, {
   3.9276229177804427`*^9, 3.9276229181444535`*^9}, {3.927623011638422*^9, 
   3.927623016495335*^9}, {3.927623050446451*^9, 3.927623122704116*^9}, {
   3.9276232863024426`*^9, 3.9276233516322365`*^9}, 3.9276244503041673`*^9, {
   3.9276247385707073`*^9, 3.9276247443416224`*^9}, {3.9276251135968723`*^9, 
   3.9276251139333076`*^9}, {3.927625208034071*^9, 3.9276252292996964`*^9}, {
   3.927697032083026*^9, 3.927697053275936*^9}, {3.9277011070180006`*^9, 
   3.9277011154038277`*^9}, {3.9277012533624525`*^9, 
   3.9277012726774035`*^9}, {3.9277017860218997`*^9, 3.927701872767044*^9}, {
   3.927701912652029*^9, 3.927701944375142*^9}, {3.9277021134054675`*^9, 
   3.927702124401985*^9}, {3.92770228102229*^9, 3.9277023118922415`*^9}, {
   3.9277024939142056`*^9, 3.927702525409214*^9}, {3.9277029692785606`*^9, 
   3.9277029748668766`*^9}, {3.9277031604164224`*^9, 3.927703165203935*^9}, 
   3.927705770527914*^9, {3.9277060781416335`*^9, 3.927706088138143*^9}, {
   3.928223591821562*^9, 3.9282235975569825`*^9}, {3.9282287673490105`*^9, 
   3.9282287708935385`*^9}, {3.928557255644044*^9, 3.9285572676205435`*^9}, {
   3.928563879658112*^9, 3.9285638877053647`*^9}, {3.9285712276349664`*^9, 
   3.928571258267362*^9}, {3.928571293747836*^9, 3.9285712978399787`*^9}, {
   3.9288227231218977`*^9, 3.9288227289348993`*^9}, {3.92898629322369*^9, 
   3.928986300518674*^9}, {3.9289866233440495`*^9, 3.928986624393903*^9}},
 CellLabel->
  "In[392]:=",ExpressionUUID->"a8bcf5e6-9b95-41b5-ae5e-12319b7b9397"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "imagebindata", "]"}]], "Input",
 CellChangeTimes->{{3.927701276980775*^9, 3.92770128680569*^9}},
 CellLabel->
  "In[396]:=",ExpressionUUID->"fefbcdbf-4833-4a7d-be9a-32fda0e5fba3"],

Cell[BoxData[
 RowBox[{"Image3D", "[", "imagebindata", "]"}]], "Input",
 CellChangeTimes->{{3.9277024660619335`*^9, 3.927702471672648*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"47a9f1cc-83b5-458a-bf5d-9eaf73e09e75"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculate Connected Components", "Subsection",
 CellChangeTimes->{{3.927175256452815*^9, 
  3.9271752630695376`*^9}},ExpressionUUID->"9af02a4a-2888-4eb2-8b0f-\
aea8661622aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", "32"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]step", "=", 
    RowBox[{"2", 
     RowBox[{"\[Pi]", "/", "orientations"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"alpha", " ", "=", " ", 
   RowBox[{"2", "*", "0.65"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"beta", " ", "=", " ", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"1", "/", "alpha"}]}], ")"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"DilationKernel", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "beta"}], " ", "*", " ", 
      SuperscriptBox[
       RowBox[{"halfAngleApproxmation", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "\[Theta]"}], "}"}], ",", "w"}], "]"}], 
       "beta"]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "d"}], ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "d"}], ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{
        RowBox[{"-", "d"}], " ", "\[Theta]step"}], ",", 
       RowBox[{"d", " ", "\[Theta]step"}], ",", "\[Theta]step"}], "}"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Dimensions", "[", "DilationKernel", "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Image", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"List3DRotate2D", "[", 
          RowBox[{"DilationKernel", ",", 
           RowBox[{"\[Theta]step", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], ",", 
           RowBox[{"d", "+", "1"}], ",", 
           RowBox[{"d", "+", "1"}], ",", 
           SuperscriptBox["10", "7"]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
     "\n", "\t", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "\n", "]"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dilationtable", " ", "=", " ", 
    RowBox[{"Table", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"List3DRotate2D", "[", 
       RowBox[{"DilationKernel", ",", 
        RowBox[{"\[Theta]step", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], ",", 
        RowBox[{"d", "+", "1"}], ",", 
        RowBox[{"d", "+", "1"}], ",", 
        SuperscriptBox["10", "7"]}], "]"}], ",", "\n", "\t", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "orientations"}], "}"}]}], "\n", "]"}]}], 
   ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "list", " ", "of", " ", "points", " ", "that", " ", "are", " ", "within", 
    " ", "reach"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"withinReach", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"Ramp", "[", 
          RowBox[{
           RowBox[{"dilationtable", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], "]"}], ",", "0."}], 
        "]"}], "-", 
       RowBox[{"(", 
        RowBox[{"d", "+", "1"}], ")"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "orientations"}], "}"}]}], "]"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Image", ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"DilationKernel", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "]"}], ";"}], 
   "*)"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"set", " ", "k"}], "=", "0"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "0"}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"set", " ", "\[ScriptCapitalI]"}], "=", "I"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"setI", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"imagebindata", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Nx", ",", "Ny"}], "}"}], "=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "setI", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"(*", 
    RowBox[{"adding", " ", "lifts"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"setI", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", "#", 
             RowBox[{"(*", 
              RowBox[{"-", 
               RowBox[{"{", 
                RowBox[{"ySelect", ",", "0"}], "}"}]}], "*)"}], ")"}]}], ",", 
           "All"}], "\[RightDoubleBracket]"}], "=", "1"}], ";"}], "&"}], ",", 
      RowBox[{"g0dListStartAndBifurcation", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", 
         RowBox[{"2", ";;"}]}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"setIlist", "=", 
    RowBox[{"Position", "[", 
     RowBox[{"setI", ",", "1"}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"Connected", " ", "component", " ", "volume"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"setICC", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Dimensions", "[", "setI", "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"progress", "=", "0.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"total", "=", 
    RowBox[{"Length", "[", "setIlist", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"while", " ", "I"}], "!=", "\[EmptySet]"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", "\n", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"setI", ",", "1"}], "]"}], "!=", 
        RowBox[{"{", "}"}]}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"update", " ", "k"}], "=", 
         RowBox[{"k", "+", "1"}]}], "*)"}], "\n", 
       RowBox[{
        RowBox[{"k", "+=", "1"}], ";", "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Pick", " ", 
           SubscriptBox["g", "0"]}], " ", "\[Element]", " ", "I"}], "*)"}], 
        "\n", 
        RowBox[{"g", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"setI", ",", "1"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Initialize", " ", "Connected", " ", "Component", " ", "sets", " ", 
           SuperscriptBox[
            SubscriptBox["C", 
             SubscriptBox["g", "0"]], 
            RowBox[{"-", "1"}]]}], ",", " ", 
          SuperscriptBox[
           SubscriptBox["C", 
            SubscriptBox["g", "0"]], "0"]}], "*)"}], "\n", 
        RowBox[{"Cold", "=", 
         RowBox[{"{", "}"}]}], ";", "\n", 
        RowBox[{"Cnew", "=", 
         RowBox[{"{", "g", "}"}]}], ";", "\n", 
        RowBox[{"newAdded", "=", 
         RowBox[{"{", "g", "}"}]}], ";", "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{"Morphological", " ", "Convolutions"}], "*)"}], "\n", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"newAdded", "!=", 
           RowBox[{"{", "}"}]}], ",", "\n", 
          RowBox[{
           RowBox[{"Cold", "=", "Cnew"}], ";", "\n", 
           RowBox[{"reachableFromNewAdded", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"withinReach", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
                   "]"}], "+", 
                  RowBox[{"withinReach", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ",", "\n",
                  "\t\t\t\t\t\t\t\t", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Nx", "+", 
                    RowBox[{"2", "d"}]}], ",", 
                    RowBox[{"Ny", "+", 
                    RowBox[{"2", "d"}]}], ",", "orientations"}], "}"}], ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"withinReach", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
                  "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"withinReach", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ",", "newAdded"}], "]"}]}], ";", 
           "\n", 
           RowBox[{"reachableFromNewAddedonI", "=", 
            RowBox[{"Intersection", "[", 
             RowBox[{"setIlist", ",", 
              RowBox[{"ArrayReshape", "[", 
               RowBox[{"reachableFromNewAdded", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "@", "reachableFromNewAdded"}], "]"}], 
                   "/", "3"}], ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ";", 
           "\n", 
           RowBox[{"newAdded", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{"reachableFromNewAddedonI", ",", "Cold"}], "]"}]}], ";", 
           "\n", 
           RowBox[{"Cnew", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"Cold", ",", "newAdded"}], "]"}]}], ";", "\n", 
           RowBox[{"progress", "=", 
            RowBox[{"1", "-", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"setI", ",", "3"}], "]"}], "/", "total"}], "+", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"DeleteDuplicates", "[", "Cnew", "]"}], "]"}], "/", 
              "total"}]}]}], ";"}]}], "\n", "]"}], ";", "\[IndentingNewLine]",
         "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"set", " ", 
           SubscriptBox["\[ScriptCapitalC]", "k"]}], ":=", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["C", 
             SubscriptBox["g", "0"]], "n"], "=", "Cnew"}]}], "*)"}], "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"setICC", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "=", "k"}], 
           ")"}], "&"}], "/@", "Cnew"}], ";", "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"update", " ", "\[ScriptCapitalI]"}], "=", 
          RowBox[{"\[ScriptCapitalI]", "\\", 
           SubscriptBox["\[ScriptCapitalC]", "k"]}]}], "*)"}], "\n", 
        RowBox[{"setI", "*=", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Clip", "[", "setICC", "]"}]}], ")"}]}], ";", "\n", 
        RowBox[{"setIlist", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"setI", ",", "1"}], "]"}]}], ";"}]}], "\n", "\n", "]"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"ProgressIndicator", "[", "progress", "]"}], "}"}]}], "]"}], 
   "]"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{"connectivity", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{"setIlist", ",", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"setIlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"Length", "[", 
              RowBox[{"withinReach", "[", 
               RowBox[{"[", 
                RowBox[{"setIlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "]"}], 
              "]"}]}], "]"}], "+", 
           RowBox[{"withinReach", "[", 
            RowBox[{"[", 
             RowBox[{"setIlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "setIlist", "]"}]}], "}"}]}], "]"}]}], ";"}],
     "]"}], "*)"}]}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.9059174818996477`*^9, 3.9059175620678177`*^9}, {
   3.9059176306544766`*^9, 3.9059176730942545`*^9}, {3.9059177527591295`*^9, 
   3.905917819865033*^9}, 3.905917861009328*^9, {3.905917926573958*^9, 
   3.905917933496333*^9}, {3.905918033935066*^9, 3.905918103343012*^9}, {
   3.9059181618397427`*^9, 3.905918181000431*^9}, {3.905918334560006*^9, 
   3.905918360150729*^9}, {3.905918426188959*^9, 3.905918443790374*^9}, {
   3.9059267068822813`*^9, 3.9059267974585247`*^9}, {3.9059268339823256`*^9, 
   3.9059268344065795`*^9}, {3.9059268743155603`*^9, 3.905927036270793*^9}, {
   3.9059270679381585`*^9, 3.905927312914645*^9}, {3.9059290332310233`*^9, 
   3.9059291120592947`*^9}, {3.9059293477430325`*^9, 
   3.9059293916786613`*^9}, {3.9059295075284967`*^9, 3.90592961597836*^9}, {
   3.905929672475383*^9, 3.9059296730934105`*^9}, {3.9059300515427046`*^9, 
   3.905930095173456*^9}, {3.905930151582816*^9, 3.9059302498116035`*^9}, {
   3.905930304762687*^9, 3.9059303334668036`*^9}, {3.905930371390701*^9, 
   3.905930410760631*^9}, {3.9059306236559258`*^9, 3.9059306458842273`*^9}, {
   3.9059309994115252`*^9, 3.9059310158403473`*^9}, {3.905931061710208*^9, 
   3.905931217943781*^9}, {3.905932156703105*^9, 3.905932200260456*^9}, {
   3.9059322931947904`*^9, 3.9059323822381735`*^9}, {3.90593260881618*^9, 
   3.905932642370202*^9}, 3.9059335444185557`*^9, 3.905934656601919*^9, {
   3.905934724585662*^9, 3.905934729744134*^9}, {3.906001084756899*^9, 
   3.9060011359142857`*^9}, {3.9060017708361998`*^9, 
   3.9060017773538156`*^9}, {3.906001923613333*^9, 3.9060019481325617`*^9}, {
   3.9060055655010257`*^9, 3.9060056383627515`*^9}, {3.906006740288844*^9, 
   3.9060068118843327`*^9}, {3.9060134477130013`*^9, 3.906013457755302*^9}, {
   3.906013879501503*^9, 3.9060139020525804`*^9}, {3.9060141186392956`*^9, 
   3.9060141502056313`*^9}, {3.9060141945472045`*^9, 
   3.9060142400554647`*^9}, {3.90601428171433*^9, 3.9060142871169243`*^9}, {
   3.9060143217750387`*^9, 3.906014351968088*^9}, {3.906014400045596*^9, 
   3.9060144198418045`*^9}, {3.906014592774339*^9, 3.906014593242447*^9}, {
   3.906014660337558*^9, 3.9060146762751765`*^9}, {3.9060153251404247`*^9, 
   3.90601535619525*^9}, {3.90601561358232*^9, 3.906015634798956*^9}, {
   3.906016392745878*^9, 3.906016392830969*^9}, {3.9060245459219584`*^9, 
   3.9060245539301906`*^9}, {3.9060246431144314`*^9, 
   3.9060246754210086`*^9}, {3.9060247067793655`*^9, 3.906024734332477*^9}, {
   3.9060249255213494`*^9, 3.906024946158149*^9}, {3.9060251124297447`*^9, 
   3.90602514808193*^9}, {3.906025445023749*^9, 3.9060254450743217`*^9}, 
   3.9060266645969753`*^9, {3.906026729392296*^9, 3.9060267570023894`*^9}, 
   3.9060273281074123`*^9, 3.906028722613384*^9, {3.9060294959880123`*^9, 
   3.90602953847771*^9}, {3.906029600627861*^9, 3.9060296093162413`*^9}, {
   3.906029652891245*^9, 3.906029709970929*^9}, 3.906029746923587*^9, {
   3.90602977988369*^9, 3.906029790909172*^9}, {3.906030126968068*^9, 
   3.906030142538841*^9}, {3.906030240725149*^9, 3.90603024770323*^9}, {
   3.9060304484056644`*^9, 3.906030454229089*^9}, {3.9060318863686185`*^9, 
   3.906031895697443*^9}, {3.9060811528422136`*^9, 3.906081154131648*^9}, 
   3.9060932224323883`*^9, {3.9061043256958714`*^9, 3.906104327683872*^9}, 
   3.90610483866105*^9, 3.9061103964586363`*^9, {3.906114182408111*^9, 
   3.906114219759761*^9}, 3.9061878430517797`*^9, 3.9061903661940684`*^9, 
   3.906191527793688*^9, {3.9061982834283724`*^9, 3.9061982848651657`*^9}, 
   3.906445204709363*^9, {3.9072393251930714`*^9, 3.907239388059399*^9}, {
   3.907239456384435*^9, 3.9072394600594225`*^9}, 3.907239508925485*^9, {
   3.9072396991080694`*^9, 3.90723970105814*^9}, {3.9072398096968794`*^9, 
   3.9072398108626065`*^9}, {3.907240655920842*^9, 3.9072406871537714`*^9}, {
   3.907387432160984*^9, 3.9073874323377104`*^9}, {3.9073875183837347`*^9, 
   3.9073875200064774`*^9}, 3.910238678686391*^9, 3.9102437028802247`*^9, 
   3.91025064980122*^9, 3.9102513099472227`*^9, 3.9110299039191656`*^9, 
   3.9110302888427935`*^9, {3.9229551544944396`*^9, 3.9229551549840975`*^9}, {
   3.9276168939709997`*^9, 3.9276169239704885`*^9}, 3.9282285380210867`*^9, {
   3.9289951055157757`*^9, 3.9289951065542808`*^9}, 3.9289954347687025`*^9},
 CellLabel->
  "In[398]:=",ExpressionUUID->"6d01318d-c54b-4ec4-8f87-213498094ce7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Visualize results", "Subsection",
 CellChangeTimes->{{3.927175270902731*^9, 
  3.9271752761360765`*^9}},ExpressionUUID->"eb419da7-1c67-47cb-8e38-\
104ee6b4c272"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"ImageData", "[", "thinCost", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.928574396620638*^9, 3.9285743996626263`*^9}, {
  3.9285745148369627`*^9, 3.9285745506872888`*^9}, {3.928917673532071*^9, 
  3.9289176773744626`*^9}, {3.9289177791629176`*^9, 3.9289177842888784`*^9}, {
  3.9289868665651517`*^9, 3.9289868681249657`*^9}, {3.928987045290588*^9, 
  3.9289870546141987`*^9}},
 CellLabel->
  "In[944]:=",ExpressionUUID->"f19190d6-8313-433f-8750-4967b2c60ddd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thinCost", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"ImageData", "[", "thinCost", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thinCost", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", 
      RowBox[{"No", "/", "4"}]}], "]"}], "]"}], "=", 
   RowBox[{"thinCost", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{"2", 
        RowBox[{"No", "/", "4"}]}]}], ";;", 
      RowBox[{"3", 
       RowBox[{"No", "/", "4"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thinCost", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"3", 
        RowBox[{"No", "/", "4"}]}], "+", "1"}], ";;", "No"}], "]"}], "]"}], 
   "=", 
   RowBox[{"thinCost", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"No", "/", "4"}], "+", "1"}], ";;", 
      RowBox[{"2", 
       RowBox[{"No", "/", "4"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thinCost", "=", 
    RowBox[{"Binarize", "[", 
     RowBox[{"Image3D", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"thinCost", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Colorize", "[", 
  RowBox[{"Round", "[", "setICC", 
   RowBox[{"(*", 
    RowBox[{"*", 
     RowBox[{"ImageData", "[", "thinCost", "]"}]}], "*)"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9101759564643297`*^9, 3.9101759607303095`*^9}, {
   3.9285744865834923`*^9, 3.9285744923941517`*^9}, {3.928574554251712*^9, 
   3.9285745599294367`*^9}, 3.9289173431301546`*^9, {3.9289176808949594`*^9, 
   3.9289176935750065`*^9}, {3.9289177860816607`*^9, 3.928917791166769*^9}, {
   3.9289843914761944`*^9, 3.9289843950527773`*^9}, {3.928986441756874*^9, 
   3.9289864577778606`*^9}, {3.928986734802744*^9, 3.9289867418833714`*^9}, 
   3.928986775896141*^9, 3.9289868555037255`*^9, {3.92898706879196*^9, 
   3.9289870818355184`*^9}, {3.9289872885188627`*^9, 3.928987303069646*^9}, {
   3.9289873757379384`*^9, 3.928987389791851*^9}, {3.928987550552721*^9, 
   3.9289875515841274`*^9}, {3.9289876251694064`*^9, 3.928987631651226*^9}},
 CellLabel->
  "In[415]:=",ExpressionUUID->"ab8ed823-70e1-4675-b328-0d52555496cf"],

Cell[BoxData[
 RowBox[{"Colorize", "[", 
  RowBox[{"Round", "[", 
   RowBox[{"Map", "[", 
    RowBox[{"Max", ",", 
     RowBox[{"setICC", "*", 
      RowBox[{"ImageData", "[", "thinCost", "]"}]}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.914570476524085*^9, 3.914570488402583*^9}, 
   3.928574577701744*^9, 3.928574890809812*^9, 3.928574938089856*^9, {
   3.928917703010373*^9, 3.928917706163065*^9}, {3.9289843989467735`*^9, 
   3.9289844048501883`*^9}, {3.928986427504655*^9, 3.9289864317459774`*^9}},
 CellLabel->
  "In[420]:=",ExpressionUUID->"e6dd27d2-4546-4c03-99c9-bfbe5136060e"],

Cell[TextData[{
 "Accurate way to dilate the data for the found connected components (in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", "3"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "115c4982-d87a-4062-94ae-e4aeae8adaf2"],
 "), but not very fast; result: 3D array"
}], "Text",
 CellChangeTimes->{{3.9271753467526593`*^9, 
  3.927175462421457*^9}},ExpressionUUID->"8adc4092-5283-42aa-8e3a-\
fc775230486a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"setICCwider", "=", 
    RowBox[{"ImageData", "[", 
     RowBox[{"Dilation", "[", 
      RowBox[{
       RowBox[{"Image3D", "@", "setICC"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
      "]"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9144900148621387`*^9, 3.91449002079473*^9}, {
  3.9144901180497694`*^9, 3.914490118782054*^9}, {3.9144901696715*^9, 
  3.9144902076942816`*^9}, {3.92717534007545*^9, 3.9271753446028957`*^9}},
 CellLabel->
  "In[952]:=",ExpressionUUID->"d4c4be60-4ce4-40fa-a74e-33eece6e0aa2"],

Cell[TextData[{
 "Less accurate way to dilate the data for the found connected components (in \
",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", "2"], TraditionalForm]],
  ExpressionUUID->"e4f4109e-e8bd-46c0-b051-db25a0e5497a"],
 "), but very fast; result: 2D array"
}], "Text",
 CellChangeTimes->{
  3.927175471902105*^9, {3.9271755045893736`*^9, 3.927175518390676*^9}, {
   3.927175552318918*^9, 
   3.9271755624525356`*^9}},ExpressionUUID->"ea6bd6f0-a525-44ad-9e45-\
99bfbe6f65cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"fast", " ", "to", " ", "calculate"}], ",", " ", 
    RowBox[{
    "but", " ", "less", " ", "accurate", " ", "compared", " ", "to", " ", 
     "other", " ", "methods"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"setICCwider", "=", 
    RowBox[{"ImageData", "[", 
     RowBox[{"Dilation", "[", 
      RowBox[{
       RowBox[{"Image", "@", 
        RowBox[{"Map", "[", 
         RowBox[{"Max", ",", 
          RowBox[{"setICC", "*", 
           RowBox[{"ImageData", "[", "thinCost", "]"}]}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], "]"}], "]"}]}],
    ";"}]}]], "Input",
 CellChangeTimes->{{3.9145702208395386`*^9, 3.9145702391352053`*^9}, {
  3.914570525346574*^9, 3.914570558307063*^9}, {3.9289168882510495`*^9, 
  3.928916889955866*^9}, {3.9289844134071255`*^9, 3.9289844184154162`*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"24d5228d-d989-419c-b210-5a5e8b3ac6c1"],

Cell[BoxData[
 RowBox[{"MinMax", "[", "setICCwider", "]"}]], "Input",
 CellChangeTimes->{{3.9145702698628426`*^9, 3.9145702716305933`*^9}},
 CellLabel->
  "In[962]:=",ExpressionUUID->"2befacbb-5a51-4daf-8ea4-1d5d0be8a094"],

Cell[BoxData[
 RowBox[{"Colorize", "[", 
  RowBox[{"Round", "[", "setICCwider", "]"}], 
  RowBox[{"(*", 
   RowBox[{",", 
    RowBox[{"ColorFunction", "->", "\"\<Rainbow\>\""}]}], "*)"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9145702443248386`*^9, 3.914570279190914*^9}, {
   3.927709092072485*^9, 3.9277090958325415`*^9}, 3.928916869581482*^9},
 CellLabel->
  "In[963]:=",ExpressionUUID->"5a63770b-d40c-4ddc-903b-0549ced68254"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Binarize", "[", 
  RowBox[{"Image", "@", 
   RowBox[{"GaussianFilter", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Max", ",", 
       RowBox[{"Boole", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "-", "i"}], "==", "0"}], "&"}], ",", "setICC", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], ",", "radiusBlurFilter"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9145697096319723`*^9, 3.9145697135206275`*^9}, {
  3.914569745887884*^9, 3.914569778901739*^9}, {3.927180524196048*^9, 
  3.927180525678816*^9}},
 CellLabel->
  "In[957]:=",ExpressionUUID->"a7a70ae1-cfe6-4e0a-86b5-ff14c21b3fe8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"best", " ", "result"}], ",", " ", 
    RowBox[{"but", " ", "slow", " ", "to", " ", "calculate"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"setICCdilated", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "setICC", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{";;", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", 
      RowBox[{"Max", "[", "setICC", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"setICCGaussianFilter", "=", 
       RowBox[{"i", "*", 
        RowBox[{"ImageData", "@", 
         RowBox[{"Binarize", "[", 
          RowBox[{"Image", "@", 
           RowBox[{"GaussianFilter", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"Max", ",", 
               RowBox[{"Boole", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "-", "i"}], "==", "0"}], "&"}], ",", 
                  "setICC", ",", 
                  RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", "radiusBlurFilter"}], 
            "]"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"setICCdilated", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"Max", ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"setICCdilated", ",", "setICCGaussianFilter"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "3", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9145695907662177`*^9, 3.914569621403097*^9}, {
  3.914569664409994*^9, 3.914569667405368*^9}, {3.9145697238898096`*^9, 
  3.9145697536780148`*^9}, {3.914570510580858*^9, 3.9145705192932653`*^9}},
 CellLabel->
  "In[959]:=",ExpressionUUID->"4cb7838d-110b-484c-99b7-1606ebd01ed8"],

Cell[BoxData[
 RowBox[{"Colorize", "[", 
  RowBox[{"Map", "[", 
   RowBox[{"Max", ",", "setICCdilated", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.914499529010995*^9, 3.914499537724001*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"ae94fdbb-e0b3-4623-9b09-b08cd1f766a8"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Colorize", "@", 
    RowBox[{"Map", "[", 
     RowBox[{"Max", ",", "setICC", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
          RowBox[{"PointImageCoordinates", "[", 
           RowBox[{"imhalf", ",", "seedsIndex"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Green", ",", 
          RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
          RowBox[{"PointImageCoordinates", "[", 
           RowBox[{"imhalf", ",", "g1ListTiers"}], "]"}]}], "}"}]}], "}"}], 
      "]"}], ","}], "*)"}], 
   RowBox[{"ImageSize", "->", "800"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.9061878783457766`*^9, {3.906446008814418*^9, 3.9064460184303827`*^9}, {
   3.906446057342435*^9, 3.9064460620812645`*^9}, 3.906446153820974*^9, 
   3.914489503655367*^9},
 CellLabel->
  "In[606]:=",ExpressionUUID->"e216cdf7-7229-4f9f-9921-5c2bc550dbb8"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Colorize", "@", 
    RowBox[{"Map", "[", 
     RowBox[{"Max", ",", 
      RowBox[{"Round", "[", "setICCwider", "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
          RowBox[{"PointImageCoordinates", "[", 
           RowBox[{"imhalf", ",", "seedsIndex"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Green", ",", 
          RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
          RowBox[{"PointImageCoordinates", "[", 
           RowBox[{"imhalf", ",", "g1ListTiers"}], "]"}]}], "}"}]}], "}"}], 
      "]"}], ","}], "*)"}], 
   RowBox[{"ImageSize", "->", "800"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9144900405477057`*^9, 3.9144900422075877`*^9}, {
  3.9144900953288116`*^9, 3.914490097006687*^9}},
 CellLabel->
  "In[607]:=",ExpressionUUID->"02c475c0-f27f-434c-a1f2-96c6c5055bf2"],

Cell[BoxData[
 RowBox[{"Image", "@", "imhalf"}]], "Input",
 CellChangeTimes->{{3.914491533495284*^9, 3.914491564467663*^9}},
 CellLabel->
  "In[608]:=",ExpressionUUID->"936d89a9-96c7-4820-b0aa-8c653b4a4df4"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Colorize", "@", 
    RowBox[{"Map", "[", 
     RowBox[{"Max", ",", 
      RowBox[{"MorphologicalComponents", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"imagebindata", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
          RowBox[{"PointImageCoordinates", "[", 
           RowBox[{"imhalf", ",", "seedsIndex"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Green", ",", 
          RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
          RowBox[{"PointImageCoordinates", "[", 
           RowBox[{"imhalf", ",", "g1ListTiers"}], "]"}]}], "}"}]}], "}"}], 
      "]"}], ","}], "*)"}], 
   RowBox[{"ImageSize", "->", "800"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9144913178815203`*^9, 3.914491342600479*^9}, {
  3.927181522299611*^9, 3.927181527898737*^9}},
 CellLabel->
  "In[609]:=",ExpressionUUID->"d3c0fe6d-6df0-40ce-a950-fb864be8c563"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Image", "@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Boole", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", "i"}], "]"}], "]"}], "==", "0"}], "]"}], "&"}], 
      ",", "setICC", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Max", "[", "setICC", "]"}], ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.914483299945964*^9, 3.914483342591357*^9}, {
  3.9144839767445755`*^9, 3.914483977558583*^9}, {3.914484243871727*^9, 
  3.9144842468067613`*^9}, {3.9144891811173534`*^9, 3.9144891812023487`*^9}},
 CellLabel->
  "In[610]:=",ExpressionUUID->"c54a0471-352a-4e1f-bb0d-b9ca070451e2"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1428, 839.25},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
InputAliases->((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((\
((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((\
(((((((((((((((((((((((((((((((((((((((((((((((Rule["intt", 
                    RowBox[{"\[Integral]", 
                    RowBox[{"\[SelectionPlaceholder]", 
                    RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], 
                    "dintt", 
                    RowBox[{
                    SubsuperscriptBox["\[Integral]", 
                    "\[SelectionPlaceholder]", "\[Placeholder]"], 
                    RowBox[{"\[Placeholder]", 
                    RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], 
                    "rintt", 
                    RowBox[{
                    UnderscriptBox["\[Integral]", 
                    
                    RowBox[{"\[SelectionPlaceholder]", "\[Element]", 
                    "\[Placeholder]"}]], "\[Placeholder]"}], "sumt", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    
                    RowBox[{"\[SelectionPlaceholder]", "=", 
                    "\[Placeholder]"}], "\[Placeholder]"], 
                    "\[Placeholder]"}], "prodt", 
                    RowBox[{
                    UnderoverscriptBox["\[Product]", 
                    
                    RowBox[{"\[SelectionPlaceholder]", "=", 
                    "\[Placeholder]"}], "\[Placeholder]"], 
                    "\[Placeholder]"}], "dt", 
                    RowBox[{
                    SubscriptBox["\[PartialD]", "\[SelectionPlaceholder]"], 
                    "\[Placeholder]"}], "cbrt", 
                    RadicalBox["\[SelectionPlaceholder]", "3", SurdForm -> 
                    True, MultilineFunction -> None], "surd", 
                    RadicalBox["\[SelectionPlaceholder]", "\[Placeholder]", 
                    SurdForm -> True, MultilineFunction -> None], "ket", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, "Ket"], "bra", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, "Bra"], "braket", 
                    
                    TemplateBox[{"\[SelectionPlaceholder]", 
                    "\[Placeholder]"}, "BraKet"], "delay", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "SystemsModelDelay"], "grad", 
                    RowBox[{
                    SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], 
                    "\[Placeholder]"}], "del.", 
                    RowBox[{
                    SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], ".", 
                    "\[Placeholder]"}], "delx", 
                    RowBox[{
                    SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], 
                    "\[Cross]", "\[Placeholder]"}], "del2", 
                    RowBox[{
                    SubsuperscriptBox["\[Del]", "\[SelectionPlaceholder]", 2],
                     "\[Placeholder]"}], "kd", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "KroneckerDeltaSeq"], "algs", 
                    TemplateBox[{}, "Algebraics"], "bools", 
                    TemplateBox[{}, "Booleans"], "comps", 
                    TemplateBox[{}, "Complexes"], "ints", 
                    TemplateBox[{}, "Integers"], "pris", 
                    TemplateBox[{}, "Primes"], "rats", 
                    TemplateBox[{}, "Rationals"], "reals", 
                    TemplateBox[{}, "Reals"], "pints", 
                    TemplateBox[{}, "PositiveIntegers"], "npints", 
                    TemplateBox[{}, "NonPositiveIntegers"], "nnints", 
                    TemplateBox[{}, "NonNegativeIntegers"], "nints", 
                    TemplateBox[{}, "NegativeIntegers"], "prats", 
                    TemplateBox[{}, "PositiveRationals"], "nprats", 
                    TemplateBox[{}, "NonPositiveRationals"], "nnrats", 
                    TemplateBox[{}, "NonNegativeRationals"], "nrats", 
                    TemplateBox[{}, "NegativeRationals"], "preals", 
                    TemplateBox[{}, "PositiveReals"], "npreals", 
                    TemplateBox[{}, "NonPositiveReals"], "nnreals", 
                    TemplateBox[{}, "NonNegativeReals"], "nreals", 
                    TemplateBox[{}, "NegativeReals"], "dlim", 
                    RowBox[{
                    UnderscriptBox["\[Limit]", 
                    RowBox[{"\[SelectionPlaceholder]", 
                    UnderscriptBox["\[Rule]", 
                    TemplateBox[{}, "Integers"]], "\[Infinity]"}]], 
                    "\[Placeholder]"}], "dMlim", 
                    RowBox[{
                    UnderscriptBox["\[MaxLimit]", 
                    RowBox[{"\[SelectionPlaceholder]", 
                    UnderscriptBox["\[Rule]", 
                    TemplateBox[{}, "Integers"]], "\[Infinity]"}]], 
                    "\[Placeholder]"}], "dmlim", 
                    RowBox[{
                    UnderscriptBox["\[MinLimit]", 
                    RowBox[{"\[SelectionPlaceholder]", 
                    UnderscriptBox["\[Rule]", 
                    TemplateBox[{}, "Integers"]], "\[Infinity]"}]], 
                    "\[Placeholder]"}], "tue", 
                    OverscriptBox["\[UndirectedEdge]", "\[Placeholder]"], 
                    "tde", 
                    OverscriptBox["\[DirectedEdge]", "\[Placeholder]"], "cB", 
                    TemplateBox[{}, "CombinatorB"], "cC", 
                    TemplateBox[{}, "CombinatorC"], "cI", 
                    TemplateBox[{}, "CombinatorI"], "cK", 
                    TemplateBox[{}, "CombinatorK"], "cS", 
                    TemplateBox[{}, "CombinatorS"], "cW", 
                    TemplateBox[{}, "CombinatorW"], "cY", 
                    TemplateBox[{}, "CombinatorY"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], "notation", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", 
                    "\[DoubleLongLeftRightArrow]", " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation>", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "notation<", 
                    RowBox[{"Notation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], " ", "\[DoubleLongLeftArrow]", 
                    " ", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "symb", 
                    RowBox[{"Symbolize", "[", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], "]"}], "infixnotation", 
                    RowBox[{"InfixNotation", "[", 
                    RowBox[{
                    
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationTemplateTag"], ",", "\[Placeholder]"}], "]"}], 
                    "addia", 
                    RowBox[{"AddInputAlias", "[", 
                    RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
                    TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], 
                    "]"}], "pattwraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationPatternTag"], "madeboxeswraper", 
                    TemplateBox[{"\[SelectionPlaceholder]"}, 
                    "NotationMadeBoxesTag"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], ":=<", 
                    OverscriptBox[":=", "\:02c2"], "=<", 
                    OverscriptBox["=", "\:02c2"]] -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {":=<" -> 
                    OverscriptBox[":=", "\:02c2"]}) -> {"=<" -> OverscriptBox[
                    "=", "\:02c2"]}) -> {":=<" -> OverscriptBox[":=", 
                    "\:02c2"]}) -> {"=<" -> OverscriptBox["=", 
                    "\:02c2"]}) -> {":=<" -> OverscriptBox[":=", 
                    "\:02c2"]}) -> {"=<" -> OverscriptBox["=", 
                    "\:02c2"]}) -> {":=<" -> OverscriptBox[":=", 
                    "\:02c2"]}) -> {"=<" -> OverscriptBox["=", 
                    "\:02c2"]}) -> {":=<" -> OverscriptBox[":=", 
                    "\:02c2"]}) -> {"=<" -> OverscriptBox["=", 
                    "\:02c2"]}) -> {":=<" -> OverscriptBox[":=", 
                    "\:02c2"]}) -> {"=<" -> OverscriptBox["=", 
                    "\:02c2"]}) -> {":=<" -> OverscriptBox[":=", 
                    "\:02c2"]}) -> {"=<" -> OverscriptBox["=", 
                    "\:02c2"]}) -> {":=<" -> OverscriptBox[":=", 
                    "\:02c2"]}) -> {"=<" -> OverscriptBox["=", 
                    "\:02c2"]}) -> {":=<" -> OverscriptBox[":=", 
                    "\:02c2"]}) -> {"=<" -> OverscriptBox["=", 
                    "\:02c2"]}) -> {":=<" -> OverscriptBox[":=", 
                    "\:02c2"]}) -> {"=<" -> OverscriptBox["=", 
                    "\:02c2"]}) -> {":=<" -> OverscriptBox[
                    ":=", "\:02c2"]}) -> {"=<" -> OverscriptBox[
                    "=", "\:02c2"]}) -> {":=<" -> OverscriptBox[
                    ":=", "\:02c2"]}) -> {"=<" -> OverscriptBox[
                    "=", "\:02c2"]}) -> {":=<" -> OverscriptBox[
                    ":=", "\:02c2"]}) -> {"=<" -> OverscriptBox[
                    "=", "\:02c2"]}) -> {":=<" -> OverscriptBox[
                    ":=", "\:02c2"]}) -> {"=<" -> OverscriptBox[
                    "=", "\:02c2"]}) -> {":=<" -> OverscriptBox[
                    ":=", "\:02c2"]}) -> {"=<" -> OverscriptBox[
                    "=", "\:02c2"]}) -> {":=<" -> OverscriptBox[
                    ":=", "\:02c2"]}) -> {"=<" -> 
                    OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                    ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                   ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                  "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
                 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
                "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
               ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
              "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
             ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
            "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
           ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
          "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
         ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
        "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
       ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
      "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
     ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
    "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
   ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
  "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}) -> {
 "=<" -> OverscriptBox["=", "\:02c2"]}) -> {
 ":=<" -> OverscriptBox[":=", "\:02c2"]}),
Magnification:>1. Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0c70fd00-7d2d-4d41-a024-18a0b837b446"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 267, 5, 28, "Input",ExpressionUUID->"b48582d0-796c-4d80-a70e-26fe08b36565"],
Cell[CellGroupData[{
Cell[850, 29, 158, 3, 69, "Chapter",ExpressionUUID->"1f1b5ca2-a3e0-4c9b-ae2f-da293954b2b8"],
Cell[CellGroupData[{
Cell[1033, 36, 164, 3, 66, "Section",ExpressionUUID->"5be36f9a-83fd-47c6-9cf4-aa397ae71445"],
Cell[CellGroupData[{
Cell[1222, 43, 171, 3, 53, "Subsection",ExpressionUUID->"5eecc558-7caf-4f54-a673-ab096ff804e1"],
Cell[1396, 48, 5248, 137, 300, "Code",ExpressionUUID->"ce0bcb8c-1ef3-4c54-ae9d-7ead0859c500",
 InitializationCell->False]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[6693, 191, 185, 3, 51, "Section",ExpressionUUID->"1ac3cd53-09e5-45f5-b47e-6795de51639f"],
Cell[6881, 196, 222, 4, 47, "Input",ExpressionUUID->"b66c351f-b1cc-4483-b96b-f808bb4bc972"],
Cell[CellGroupData[{
Cell[7128, 204, 281, 4, 53, "Subsection",ExpressionUUID->"98d76889-0838-449f-98b7-d7385e0c913c"],
Cell[7412, 210, 12372, 263, 717, "Input",ExpressionUUID->"e9b7349a-76e7-4e6b-9d41-a98e279a90e5"],
Cell[19787, 475, 993, 26, 70, "Input",ExpressionUUID->"00dbe610-eee4-4379-b93e-2e35226421c2"],
Cell[20783, 503, 794, 20, 70, "Input",ExpressionUUID->"9b967058-8619-4a9f-bd37-6860dc4468c6"]
}, Closed]],
Cell[CellGroupData[{
Cell[21614, 528, 180, 3, 37, "Subsection",ExpressionUUID->"bf5c9a22-840b-42b0-85ad-d8bddec3f25d"],
Cell[21797, 533, 10199, 232, 772, "Input",ExpressionUUID->"998a2175-9b2d-434e-b46e-c403fdbd3cb6"],
Cell[31999, 767, 4705, 106, 70, "Input",ExpressionUUID->"db448320-72fb-44bb-a98f-68f821a7f685"],
Cell[36707, 875, 4785, 108, 70, "Input",ExpressionUUID->"b7fe319a-fe9a-4561-9273-70c7584e6617"]
}, Closed]],
Cell[CellGroupData[{
Cell[41529, 988, 173, 3, 37, "Subsection",ExpressionUUID->"bd348826-fe53-4650-b8ef-3e44f2fcf11d"],
Cell[41705, 993, 14177, 299, 898, "Input",ExpressionUUID->"e4ab114b-0457-4183-a0d4-44eac90f96b7"],
Cell[55885, 1294, 14430, 301, 975, "Input",ExpressionUUID->"65e0e830-f568-4c71-b485-3d9de782c63e"],
Cell[70318, 1597, 11320, 251, 886, "Input",ExpressionUUID->"bf566bfa-53e3-4131-9fbd-16b8c7b203b7"],
Cell[81641, 1850, 11398, 252, 886, "Input",ExpressionUUID->"57e8162f-8cf3-4b50-9305-3a25c892b4df"],
Cell[93042, 2104, 10025, 234, 867, "Input",ExpressionUUID->"701ac80d-0526-4a5d-9504-385ea3956621"]
}, Closed]],
Cell[CellGroupData[{
Cell[103104, 2343, 235, 4, 37, "Subsection",ExpressionUUID->"d8f97c37-c04e-46b7-9fa2-6d972ebe7fc4"],
Cell[103342, 2349, 7877, 175, 600, "Input",ExpressionUUID->"7d410c18-dc97-4e07-9207-eee81814a759"]
}, Closed]],
Cell[CellGroupData[{
Cell[111256, 2529, 229, 4, 37, "Subsection",ExpressionUUID->"9c822d5e-81fa-450c-9fab-f7096b357395"],
Cell[111488, 2535, 2531, 63, 219, "Input",ExpressionUUID->"c3cc28ea-24c2-4fee-b90d-4395efb15945"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114056, 2603, 175, 3, 53, "Subsection",ExpressionUUID->"a95c6130-72fd-4a92-9df7-ebca3ed64023"],
Cell[114234, 2608, 1890, 50, 70, "Input",ExpressionUUID->"b3e0461f-bcd2-4551-a1a9-1adb1f6a4f75"],
Cell[116127, 2660, 879, 25, 70, "Input",ExpressionUUID->"15ead49b-71f9-4088-9076-e8f56b73b4a3"],
Cell[117009, 2687, 3713, 89, 70, "Input",ExpressionUUID->"afe599e2-5340-4632-9a19-d301a3d41ac9"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[120771, 2782, 174, 3, 51, "Section",ExpressionUUID->"eecdece1-910f-44e4-9306-eba9d653b292"],
Cell[CellGroupData[{
Cell[120970, 2789, 228, 4, 53, "Subsection",ExpressionUUID->"f6b16b30-d579-4b8b-b932-7b197d5d0218"],
Cell[121201, 2795, 79065, 1913, 10038, "Input",ExpressionUUID->"b8b6b901-30e3-44bd-84fc-bb4e11d9c60e"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[200327, 4715, 160, 3, 58, "Chapter",ExpressionUUID->"e3d614c7-a321-493e-b9de-8c298e25bd2c"],
Cell[200490, 4720, 320, 7, 35, "Text",ExpressionUUID->"16f5e194-3e94-476b-aac1-b0be1cad1755"],
Cell[200813, 4729, 2196, 51, 86, "Input",ExpressionUUID->"e63c50f6-8c77-494f-8c4c-e5054fd0725b"],
Cell[203012, 4782, 684, 16, 48, "Input",ExpressionUUID->"d8a36c1a-bfa1-408d-be05-a9f667281c4b"]
}, Closed]],
Cell[CellGroupData[{
Cell[203733, 4803, 224, 4, 58, "Chapter",ExpressionUUID->"453c3ba5-2e53-4b22-ae6a-b12e6f12af03"],
Cell[CellGroupData[{
Cell[203982, 4811, 173, 3, 66, "Section",ExpressionUUID->"f5b68bac-f174-4172-8a20-b793bc0f73f0"],
Cell[204158, 4816, 444, 8, 56, "Text",ExpressionUUID->"516df055-a022-4fe9-bdee-2ed5ecd53668"],
Cell[204605, 4826, 4478, 94, 333, "Input",ExpressionUUID->"2fd91371-8666-4a50-8e6a-f0e8dd8efe3b"],
Cell[209086, 4922, 204, 3, 34, "Text",ExpressionUUID->"2cd5c294-1395-4c05-bf49-dedcca015114"],
Cell[209293, 4927, 5721, 131, 637, "Input",ExpressionUUID->"93a570aa-ccbf-4d7d-a124-4f2ad8658084"],
Cell[CellGroupData[{
Cell[215039, 5062, 154, 3, 53, "Subsection",ExpressionUUID->"6a89fb72-7f3c-465e-b676-ef05e5a602c7"],
Cell[215196, 5067, 1419, 38, 180, "Input",ExpressionUUID->"4032094c-a6f1-4ada-b5d6-54959890ba8d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[216664, 5111, 324, 7, 141, "Section",ExpressionUUID->"3735de6c-fb93-4c4c-8242-a512849ff2a4"],
Cell[216991, 5120, 6423, 151, 695, "Input",ExpressionUUID->"efa9673d-f94d-4fde-8f99-a5a90711c788"],
Cell[223417, 5273, 3523, 101, 180, "Input",ExpressionUUID->"a2a642aa-096e-47f0-a317-7358e4fc44a2"],
Cell[226943, 5376, 3388, 74, 352, "Input",ExpressionUUID->"92847ee9-84ec-45e4-8786-b61aea887986"],
Cell[230334, 5452, 906, 19, 105, "Input",ExpressionUUID->"19916438-e529-484b-a336-0da868ff7988"],
Cell[CellGroupData[{
Cell[231265, 5475, 186, 3, 53, "Subsection",ExpressionUUID->"790a77c5-0dba-4a30-8761-212df252c596"],
Cell[231454, 5480, 4208, 96, 295, "Input",ExpressionUUID->"24910327-fd9b-4064-80c8-d7684dd8cc2d"],
Cell[235665, 5578, 4324, 98, 314, "Input",ExpressionUUID->"e93cd8d6-977f-4869-b461-cf169e9e5158"],
Cell[239992, 5678, 4106, 95, 295, "Input",ExpressionUUID->"240eeb6f-7f2e-4d41-91d0-45cb7c9e2a09"],
Cell[244101, 5775, 1224, 30, 180, "Input",ExpressionUUID->"6cb53c12-6799-497d-8286-8cdfadc79b6a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[245374, 5811, 410, 6, 66, "Section",ExpressionUUID->"942f5a5e-1754-422d-b548-57b081bfa039"],
Cell[245787, 5819, 3478, 67, 275, "Input",ExpressionUUID->"67d94281-ed8f-4e2c-abeb-6cdadf1294d0"],
Cell[CellGroupData[{
Cell[249290, 5890, 228, 4, 45, "Subsubsection",ExpressionUUID->"3b09db15-73bd-4f9c-b6dc-bee5c741d4fa"],
Cell[249521, 5896, 1552, 36, 66, "Input",ExpressionUUID->"d201e261-6747-42b9-bf19-a0a591f664f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251110, 5937, 163, 3, 45, "Subsubsection",ExpressionUUID->"d794eb85-9445-42f2-871d-e3804b665244"],
Cell[251276, 5942, 782, 20, 120, "Code",ExpressionUUID->"15c2e4b1-98ff-4ef8-8ce8-de8399bcc584"],
Cell[252061, 5964, 5832, 133, 352, "Input",ExpressionUUID->"adc7ab47-dc60-4e91-b247-624b83d20aa7"],
Cell[257896, 6099, 1254, 29, 123, "Input",ExpressionUUID->"66f1bc5b-7568-4819-b647-7f037447da0b"],
Cell[259153, 6130, 1801, 39, 123, "Input",ExpressionUUID->"a0f05e28-3db4-46a8-a302-903cf794a3a6"],
Cell[260957, 6171, 1491, 35, 105, "Input",ExpressionUUID->"d4c1ead0-b320-455f-bb5d-2302d55e2a28"],
Cell[262451, 6208, 217, 4, 27, "Input",ExpressionUUID->"6b560edf-3d4d-481b-ba11-a6616e35d97b"],
Cell[262671, 6214, 2498, 57, 66, "Input",ExpressionUUID->"b4a85317-1932-4494-ba03-550192634d4d"],
Cell[265172, 6273, 1124, 28, 47, "Input",ExpressionUUID->"2b1b404e-e478-42b9-99cf-ac4548605851"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[266357, 6308, 155, 3, 58, "Chapter",ExpressionUUID->"34a4ddeb-8738-40df-aa4a-9710b6868cf8"],
Cell[266515, 6313, 9216, 181, 352, "Input",ExpressionUUID->"5f75c1d1-87f1-4506-b00d-9f4d6ad9527b"]
}, Closed]],
Cell[CellGroupData[{
Cell[275768, 6499, 203, 3, 58, "Chapter",ExpressionUUID->"f2cf6634-0cb7-43dc-b16f-e6b62cf551f3"],
Cell[CellGroupData[{
Cell[275996, 6506, 173, 3, 53, "Subsection",ExpressionUUID->"1d24b0c7-bf80-4a41-a197-d54e551aab3e"],
Cell[276172, 6511, 1490, 39, 50, "Code",ExpressionUUID->"a2413ffe-6e3c-4240-be97-8324c1a98fa2"],
Cell[277665, 6552, 236, 4, 28, "Input",ExpressionUUID->"69f14586-f522-4d94-bb71-a269bc245a4a"],
Cell[277904, 6558, 2054, 49, 105, "Input",ExpressionUUID->"0f80ebb3-33e1-44c0-ac4d-a9d4a9693b45"],
Cell[CellGroupData[{
Cell[279983, 6611, 206, 3, 45, "Subsubsection",ExpressionUUID->"6c918c77-536a-40c4-99df-1a4d1bfec620"],
Cell[280192, 6616, 6992, 151, 565, "Input",ExpressionUUID->"c828423d-759c-4cfc-8b59-c102cc844862"],
Cell[287187, 6769, 2402, 58, 142, "Input",ExpressionUUID->"21efcc76-89bd-4a76-ab8f-a3437d6e67b7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[289638, 6833, 163, 3, 53, "Subsection",ExpressionUUID->"447d80d8-c07a-46b5-8d46-fe5c1b1c4916"],
Cell[289804, 6838, 923, 23, 47, "Input",ExpressionUUID->"c280649e-db11-43bb-a61a-5f2edaae149e"],
Cell[290730, 6863, 909, 24, 47, "Input",ExpressionUUID->"5f4c821f-5ce2-4f78-8263-b952988c68f9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[291688, 6893, 235, 4, 58, "Chapter",ExpressionUUID->"185074f2-58aa-4893-abbc-576795ecb0c9"],
Cell[CellGroupData[{
Cell[291948, 6901, 280, 6, 66, "Section",ExpressionUUID->"23acdb82-1568-468e-8f62-37a8a5c1c479"],
Cell[292231, 6909, 2938, 69, 240, "Input",ExpressionUUID->"a50e7429-70b8-4266-9496-7966f2eaf57b"],
Cell[295172, 6980, 3096, 76, 162, "Input",ExpressionUUID->"d3ff47c3-ceec-49c1-b315-66458e7d9f18"],
Cell[298271, 7058, 3370, 79, 162, "Input",ExpressionUUID->"fc6afbf8-5d07-43f5-b391-305f75ba7be5"],
Cell[301644, 7139, 1365, 31, 47, "Input",ExpressionUUID->"d2949db6-008f-4fd9-94d3-5796e6307c1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[303046, 7175, 161, 3, 66, "Section",ExpressionUUID->"f6ef710c-a3c1-4bc2-bc79-c2a0235ae6dd"],
Cell[303210, 7180, 900, 23, 120, "Input",ExpressionUUID->"b0081a05-ff0e-4057-9075-6dfd4928739f"],
Cell[304113, 7205, 1470, 39, 47, "Input",ExpressionUUID->"fd7726dd-b980-4d64-98bc-6283c9f61c6e"],
Cell[305586, 7246, 976, 24, 120, "Input",ExpressionUUID->"c1b44ee4-025f-4de6-9350-29518cf00814"],
Cell[306565, 7272, 1595, 40, 47, "Input",ExpressionUUID->"600ff998-a388-47fd-989e-1c6a2c8f73c0"],
Cell[308163, 7314, 1052, 25, 120, "Input",ExpressionUUID->"df766053-ac38-4675-9af9-19acf8602648"],
Cell[309218, 7341, 1682, 41, 66, "Input",ExpressionUUID->"4d9278e5-c563-4f97-808c-676ae31dea89"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[310949, 7388, 164, 3, 58, "Chapter",ExpressionUUID->"98c5111d-6504-4a9b-b163-ac3009843f20"],
Cell[CellGroupData[{
Cell[311138, 7395, 159, 3, 66, "Section",ExpressionUUID->"5ffa6200-b0b5-45fd-baec-02c2af4c8a7c"],
Cell[311300, 7400, 2908, 65, 238, "Input",ExpressionUUID->"828d8904-ccce-4f57-aa86-b950a9e61aac"],
Cell[314211, 7467, 920, 14, 28, "Input",ExpressionUUID->"634f3b58-91cd-4611-80bb-a9bf75556456"],
Cell[315134, 7483, 1302, 35, 47, "Input",ExpressionUUID->"6e27b9af-c421-49b2-a9f8-216949ea791e"],
Cell[316439, 7520, 582, 13, 28, "Input",ExpressionUUID->"9fb61981-2aa6-4237-bcf5-724cfdc85681"],
Cell[317024, 7535, 851, 17, 27, "Input",ExpressionUUID->"d2353441-16b6-4723-82cf-df58a1374ba1"],
Cell[317878, 7554, 803, 21, 66, "Input",ExpressionUUID->"a1a7f697-e933-4b1d-9242-719a8982a571"],
Cell[318684, 7577, 813, 21, 66, "Input",ExpressionUUID->"5125239e-319f-435b-9e7b-8a81566b0ae4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[319534, 7603, 167, 3, 66, "Section",ExpressionUUID->"3527b40f-68dd-4436-89c8-a53596ea29b6"],
Cell[319704, 7608, 405, 9, 27, "Input",ExpressionUUID->"92619747-15e0-42cd-8dfa-05349e1a7365"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[320158, 7623, 158, 3, 58, "Chapter",ExpressionUUID->"b6dc5ffb-df49-448c-96a5-3891d17c8709"],
Cell[320319, 7628, 10638, 223, 733, "Input",ExpressionUUID->"9269c7e6-4d85-4f8e-9893-5ddd1803d827"],
Cell[330960, 7853, 209, 4, 28, "Input",ExpressionUUID->"3f0396d5-4971-4328-865d-cb4cd9473c5b"],
Cell[331172, 7859, 649, 13, 28, "Input",ExpressionUUID->"ca48192d-95a1-41bb-9453-6ec614425b3e"],
Cell[331824, 7874, 255, 5, 28, "Input",ExpressionUUID->"a83e04cd-daf2-4e6b-a958-91942e91d782"],
Cell[332082, 7881, 461, 10, 28, "Input",ExpressionUUID->"3a01e780-c39d-48cd-9167-cebabe59b589"],
Cell[332546, 7893, 329, 8, 28, "Input",ExpressionUUID->"5a81461c-c46a-45ca-acbc-33f67bd35b18"],
Cell[332878, 7903, 2128, 41, 105, "Input",ExpressionUUID->"c463a3ea-f1d3-4ae5-b7ad-1a2c0fd82899"],
Cell[335009, 7946, 619, 14, 48, "Input",ExpressionUUID->"67680861-f0fb-44f5-862b-3f499908723c"],
Cell[335631, 7962, 253, 6, 28, "Input",ExpressionUUID->"ceb421ba-8515-4e4e-ae48-a6e3eb177d31"],
Cell[335887, 7970, 1030, 26, 86, "Input",ExpressionUUID->"75e5fb47-7374-46f2-ad6b-1d467383db9a"],
Cell[336920, 7998, 1147, 27, 86, "Input",ExpressionUUID->"253e5369-3429-47e8-bb6f-5f0ab61d106d"],
Cell[338070, 8027, 416, 9, 28, "Input",ExpressionUUID->"5dcb434c-2ecb-4f4d-a000-54c4c56b8863"]
}, Closed]],
Cell[CellGroupData[{
Cell[338523, 8041, 270, 6, 58, "Chapter",ExpressionUUID->"db8ae1e0-b1a4-4342-973b-80719a026738"],
Cell[CellGroupData[{
Cell[338818, 8051, 157, 3, 67, "Section",ExpressionUUID->"2ecfc3c5-2221-4969-af9a-af9ad175d9ce"],
Cell[CellGroupData[{
Cell[339000, 8058, 164, 3, 54, "Subsection",ExpressionUUID->"68be89c5-1704-4cec-826a-32bc9a8b5338"],
Cell[CellGroupData[{
Cell[339189, 8065, 166, 3, 45, "Subsubsection",ExpressionUUID->"654f99eb-1a69-4286-9b8b-4708add21052"],
Cell[339358, 8070, 3315, 57, 610, "Input",ExpressionUUID->"387f4d4a-5dae-41c7-ac0d-d824d5b3e1b8"]
}, Closed]],
Cell[CellGroupData[{
Cell[342710, 8132, 297, 5, 37, "Subsubsection",ExpressionUUID->"3f5e5aef-df03-45c7-b297-2fba5cde2d21"],
Cell[343010, 8139, 10317, 212, 657, "Input",ExpressionUUID->"12f0b6f8-a99c-4873-8f60-f45d9bea24a6"],
Cell[353330, 8353, 5108, 84, 162, "Input",ExpressionUUID->"4fd18640-9805-4e0a-9578-2ed627121b7b"],
Cell[358441, 8439, 9488, 189, 562, "Input",ExpressionUUID->"367e2b7e-be2b-4b79-9e16-d0af6dabd010"],
Cell[367932, 8630, 8953, 179, 486, "Input",ExpressionUUID->"46421821-0a7c-4a2c-869d-c658f2561e9a"],
Cell[376888, 8811, 3891, 86, 334, "Input",ExpressionUUID->"845a3cf4-4226-454e-8322-03c70c1de3b4"],
Cell[380782, 8899, 3534, 81, 220, "Input",ExpressionUUID->"8a2161c3-0c7e-4cfc-b12d-d1526483f9be"],
Cell[384319, 8982, 10317, 190, 529, "Input",ExpressionUUID->"e0401b75-656c-4494-826a-fba2d8bcf73c"],
Cell[394639, 9174, 5312, 88, 124, "Input",ExpressionUUID->"7b91c1b4-6cd2-4ef2-ba5b-1d3e5fc7db3a"],
Cell[399954, 9264, 1713, 32, 66, "Input",ExpressionUUID->"41b3f9fe-0983-40d2-96da-241751ef29f7"],
Cell[401670, 9298, 3814, 82, 352, "Input",ExpressionUUID->"2ff546d9-4171-4f0b-a522-90b403ce980c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[405533, 9386, 167, 3, 38, "Subsection",ExpressionUUID->"8bbffd92-8ae1-4706-a711-75b886c42820"],
Cell[CellGroupData[{
Cell[405725, 9393, 165, 3, 45, "Subsubsection",ExpressionUUID->"461cda36-ade4-475a-b494-2e9a87b7ebb0"],
Cell[405893, 9398, 3737, 66, 492, "Input",ExpressionUUID->"c4019279-2a52-4fe5-a399-80b7a27fe82a"]
}, Closed]],
Cell[CellGroupData[{
Cell[409667, 9469, 169, 3, 35, "Subsubsection",ExpressionUUID->"c3e64e1f-3192-4d4f-8943-05b13ce514c0"],
Cell[409839, 9474, 11710, 261, 878, "Input",ExpressionUUID->"d1908073-5226-44d0-9e22-428ad62187f5"],
Cell[421552, 9737, 4745, 95, 352, "Input",ExpressionUUID->"f12ae987-d9f8-440c-8d64-d72b7355b573"],
Cell[426300, 9834, 2082, 49, 181, "Input",ExpressionUUID->"595a731e-5ee2-4a64-bb52-8f4e63c0ebe2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[428431, 9889, 157, 3, 38, "Subsection",ExpressionUUID->"0f15e304-c093-457e-9fef-1afd28b09d3f"],
Cell[CellGroupData[{
Cell[428613, 9896, 168, 3, 45, "Subsubsection",ExpressionUUID->"a35aff76-3674-462d-8a12-166348df8c4c"],
Cell[428784, 9901, 1101, 25, 162, "Input",ExpressionUUID->"1c37753f-5123-4254-ac79-15d028c98464"]
}, Open  ]],
Cell[CellGroupData[{
Cell[429922, 9931, 169, 3, 45, "Subsubsection",ExpressionUUID->"e2bc870d-09a0-400e-8941-a1caff83d77c"],
Cell[430094, 9936, 2898, 73, 219, "Input",ExpressionUUID->"86634edb-d014-4828-846d-2258a18b5463"],
Cell[432995, 10011, 823, 21, 93, "Input",ExpressionUUID->"14eaee01-363e-42a2-b449-160366c66731"],
Cell[433821, 10034, 1876, 42, 124, "Input",ExpressionUUID->"7b5067f1-ae62-43ba-b72a-1607bae26bb9"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[435758, 10083, 164, 3, 53, "Section",ExpressionUUID->"4488ee5a-d8fb-4c36-8498-ccddf30e9bc0"],
Cell[435925, 10088, 3796, 82, 133, "Input",ExpressionUUID->"50fe6860-c173-4edd-aa38-6be638556479"],
Cell[439724, 10172, 563, 13, 28, "Input",ExpressionUUID->"692fbd37-5859-4ce7-9fbd-90969341847f"],
Cell[440290, 10187, 933, 21, 67, "Input",ExpressionUUID->"3e00d0e9-97fa-4890-b483-45bb5286aaaa"],
Cell[441226, 10210, 825, 15, 28, "Input",ExpressionUUID->"081c9be4-7e83-468a-8216-9664fd83a2dd"],
Cell[442054, 10227, 589, 13, 28, "Input",ExpressionUUID->"79e18c64-9724-451f-b4f1-a7c96ded4671"],
Cell[442646, 10242, 399, 10, 28, "Input",ExpressionUUID->"9c1e0769-c38a-45ad-a038-d890eca42f3b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[443082, 10257, 156, 3, 67, "Section",ExpressionUUID->"334556c7-8b96-44fc-a202-070508d103d6"],
Cell[443241, 10262, 2575, 51, 105, "Input",ExpressionUUID->"e70abd64-78f3-4511-a942-4e9079748346"],
Cell[445819, 10315, 565, 13, 48, "Input",ExpressionUUID->"aa69c104-9cf3-46d0-a9e2-457e23c11fce"],
Cell[446387, 10330, 772, 17, 28, "Input",ExpressionUUID->"20e269a3-af66-48b0-835c-da5f5c570da0"],
Cell[447162, 10349, 647, 17, 28, "Input",ExpressionUUID->"75be2a75-66e7-46c8-88db-abac63985bce"],
Cell[447812, 10368, 810, 20, 48, "Input",ExpressionUUID->"afef0957-4185-46ce-ab12-27b1b03598ed"],
Cell[448625, 10390, 488, 10, 28, "Input",ExpressionUUID->"8df6339f-7e21-4248-b73d-9d42bac80599"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[449162, 10406, 162, 2, 58, "Chapter",ExpressionUUID->"4d87868c-72c0-49a5-801e-8a7d380bc9ad"],
Cell[CellGroupData[{
Cell[449349, 10412, 386, 6, 67, "Section",ExpressionUUID->"373af919-e40b-46f8-ad52-25ff1bcde1a6"],
Cell[CellGroupData[{
Cell[449760, 10422, 184, 3, 52, "Subsection",ExpressionUUID->"7abba3a3-835a-4c68-b75a-13a45a6711f7"],
Cell[449947, 10427, 4936, 119, 371, "Input",ExpressionUUID->"66ddff11-de03-45ad-8165-aec28a22698f"],
Cell[454886, 10548, 3659, 79, 275, "Input",ExpressionUUID->"08091653-9256-4f30-9ff5-afd0ca5fe385"]
}, Closed]],
Cell[CellGroupData[{
Cell[458582, 10632, 231, 4, 37, "Subsection",ExpressionUUID->"f9d1dac9-8b60-4733-8e4e-eaa0c9dcf587"],
Cell[458816, 10638, 2879, 77, 243, "Code",ExpressionUUID->"ba179476-e1c0-4e1c-b319-7b74e0bac4c5"],
Cell[461698, 10717, 4952, 109, 371, "Input",ExpressionUUID->"abec1ac0-c250-4201-9c0e-8c30ac7208cb"],
Cell[466653, 10828, 5273, 114, 395, "Input",ExpressionUUID->"06bb48eb-fdc1-401a-9bfb-434537f1af48"]
}, Closed]],
Cell[CellGroupData[{
Cell[471963, 10947, 254, 4, 37, "Subsection",ExpressionUUID->"b1b99cb5-33f7-4eed-a1c5-c62d7fddd7a7"],
Cell[472220, 10953, 271, 6, 35, "Text",ExpressionUUID->"7d408438-996c-4586-a4e4-6af17b4ba670"],
Cell[CellGroupData[{
Cell[472516, 10963, 157, 3, 45, "Subsubsection",ExpressionUUID->"51e317f5-70cf-40a3-bc35-bfe20bdbc6c9"],
Cell[472676, 10968, 30620, 795, 1018, "Input",ExpressionUUID->"c4e34844-1f09-4d06-92dc-eba04949b5b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[503333, 11768, 143, 3, 45, "Subsubsection",ExpressionUUID->"37f2ac85-f627-48d9-be6a-3ac1f94ab3c9"],
Cell[503479, 11773, 916, 16, 226, "Code",ExpressionUUID->"999e65cc-94ca-43d3-906b-b56ac973861d"],
Cell[504398, 11791, 1725, 30, 66, "Input",ExpressionUUID->"11e04f98-237b-4f69-8475-9e50ee51cc5b"],
Cell[506126, 11823, 6567, 163, 295, "Input",ExpressionUUID->"59ca5700-f49c-41b7-a99b-f69a6bf5bde0"],
Cell[512696, 11988, 4483, 101, 275, "Input",ExpressionUUID->"953afee7-8380-4e30-93b3-a582a446235f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[517216, 12094, 171, 3, 45, "Subsubsection",ExpressionUUID->"c7710181-e938-4fcf-bc4e-fc6e3d0c00c3"],
Cell[517390, 12099, 518, 10, 102, "Code",ExpressionUUID->"034faaf6-2477-4f04-97f2-f1005f00edc5"],
Cell[517911, 12111, 5434, 128, 332, "Input",ExpressionUUID->"3a3cda3f-076c-4a2f-908c-d5a3ea9aff29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[523382, 12244, 227, 4, 45, "Subsubsection",ExpressionUUID->"67f9cfa9-902a-45dd-90f4-5b8864f4e4be"],
Cell[523612, 12250, 650, 12, 120, "Code",ExpressionUUID->"baa2ea06-d26f-4e05-a16b-d400f08a1fa1"],
Cell[524265, 12264, 1902, 33, 66, "Input",ExpressionUUID->"ee49478d-566d-44e9-9a4e-f5a848bf94cb"],
Cell[526170, 12299, 1448, 25, 85, "Input",ExpressionUUID->"8bc82193-24fd-428f-b68e-8c77baa8a64f"],
Cell[527621, 12326, 6582, 146, 600, "Input",ExpressionUUID->"2c49fd37-469b-434b-a80b-e0af97325b87"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[534252, 12478, 173, 3, 52, "Subsection",ExpressionUUID->"34d3e14f-3937-4e93-96c3-17e1f15a219b"],
Cell[534428, 12483, 636, 17, 32, "Code",ExpressionUUID->"5fd5e78f-8a68-4476-a126-dd8d19550033",
 InitializationCell->False],
Cell[535067, 12502, 1001, 30, 122, "Code",ExpressionUUID->"b3089416-0bff-44ce-bfc4-b0d4f6642dff",
 InitializationCell->False],
Cell[536071, 12534, 669, 18, 32, "Code",ExpressionUUID->"195907f2-0a95-4d5b-8f10-ccb5af1bcb33",
 InitializationCell->False]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[536789, 12558, 155, 3, 53, "Section",ExpressionUUID->"4966a8e6-870a-4be7-8eb1-9b46df4aac7d"],
Cell[CellGroupData[{
Cell[536969, 12565, 157, 3, 54, "Subsection",ExpressionUUID->"0b1d59b3-d3bd-4529-b36b-151004fb04d9"],
Cell[537129, 12570, 44556, 1054, 1457, "Input",ExpressionUUID->"138d3b2f-a725-41cc-b317-6c8b3e7ee715"]
}, Closed]],
Cell[CellGroupData[{
Cell[581722, 13629, 159, 3, 38, "Subsection",ExpressionUUID->"3b587400-b305-465c-b691-42ddc957f8be"],
Cell[581884, 13634, 413, 11, 28, "Input",ExpressionUUID->"02498ef1-17b5-4b00-9b46-1f5c0190d436"],
Cell[582300, 13647, 523, 11, 28, "Input",ExpressionUUID->"14e127c1-0a1b-470b-88ba-d65721431dcc"],
Cell[582826, 13660, 8226, 171, 523, "Input",ExpressionUUID->"023be18e-a88f-449f-8612-4890e456231f"],
Cell[591055, 13833, 5465, 147, 276, "Input",ExpressionUUID->"4511a6e7-5a03-46d8-81ca-d31ef92874ac"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[596581, 13987, 242, 4, 98, "Title",ExpressionUUID->"f3c89fb5-3658-4434-90e3-12db05fa2820"],
Cell[CellGroupData[{
Cell[596848, 13995, 185, 3, 67, "Section",ExpressionUUID->"fb627fb6-6fe5-4486-b206-0c753238b2ab"],
Cell[CellGroupData[{
Cell[597058, 14002, 162, 3, 54, "Subsection",ExpressionUUID->"a470997d-a973-4e1b-a26f-c5aa3f95d724"],
Cell[597223, 14007, 2811, 47, 105, "Input",ExpressionUUID->"57bda0c9-b95f-4d0e-8ad7-a3acb3c02139"],
Cell[600037, 14056, 765, 18, 70, "Code",ExpressionUUID->"269ca9a7-3480-4a0c-9e5e-305b4d19de68",
 InitializationCell->False],
Cell[600805, 14076, 5150, 129, 219, "Input",ExpressionUUID->"a8bcf5e6-9b95-41b5-ae5e-12319b7b9397"],
Cell[605958, 14207, 222, 4, 28, "Input",ExpressionUUID->"fefbcdbf-4833-4a7d-be9a-32fda0e5fba3"],
Cell[606183, 14213, 222, 4, 28, "Input",ExpressionUUID->"47a9f1cc-83b5-458a-bf5d-9eaf73e09e75"]
}, Closed]],
Cell[CellGroupData[{
Cell[606442, 14222, 180, 3, 38, "Subsection",ExpressionUUID->"9af02a4a-2888-4eb2-8b0f-aea8661622aa"],
Cell[606625, 14227, 17513, 431, 1416, "Code",ExpressionUUID->"6d01318d-c54b-4ec4-8f87-213498094ce7",
 InitializationCell->False]
}, Closed]],
Cell[CellGroupData[{
Cell[624175, 14663, 167, 3, 38, "Subsection",ExpressionUUID->"eb419da7-1c67-47cb-8e38-104ee6b4c272"],
Cell[624345, 14668, 515, 9, 28, "Input",ExpressionUUID->"f19190d6-8313-433f-8750-4967b2c60ddd"],
Cell[624863, 14679, 2468, 68, 124, "Input",ExpressionUUID->"ab8ed823-70e1-4675-b328-0d52555496cf"],
Cell[627334, 14749, 636, 13, 28, "Input",ExpressionUUID->"e6dd27d2-4546-4c03-99c9-bfbe5136060e"],
Cell[627973, 14764, 459, 11, 35, "Text",ExpressionUUID->"8adc4092-5283-42aa-8e3a-fc775230486a"],
Cell[628435, 14777, 1504, 39, 28, "Input",ExpressionUUID->"d4c4be60-4ce4-40fa-a74e-33eece6e0aa2"],
Cell[629942, 14818, 509, 13, 35, "Text",ExpressionUUID->"ea6bd6f0-a525-44ad-9e45-99bfbe6f65cd"],
Cell[630454, 14833, 1255, 32, 48, "Input",ExpressionUUID->"24d5228d-d989-419c-b210-5a5e8b3ac6c1"],
Cell[631712, 14867, 222, 4, 28, "Input",ExpressionUUID->"2befacbb-5a51-4daf-8ea4-1d5d0be8a094"],
Cell[631937, 14873, 432, 10, 28, "Input",ExpressionUUID->"5a63770b-d40c-4ddc-903b-0549ced68254"],
Cell[632372, 14885, 835, 22, 48, "Input",ExpressionUUID->"a7a70ae1-cfe6-4e0a-86b5-ff14c21b3fe8"],
Cell[633210, 14909, 2255, 59, 124, "Input",ExpressionUUID->"4cb7838d-110b-484c-99b7-1606ebd01ed8"],
Cell[635468, 14970, 313, 7, 28, "Input",ExpressionUUID->"ae94fdbb-e0b3-4623-9b09-b08cd1f766a8"],
Cell[635784, 14979, 1120, 29, 67, "Input",ExpressionUUID->"e216cdf7-7229-4f9f-9921-5c2bc550dbb8"],
Cell[636907, 15010, 1087, 28, 67, "Input",ExpressionUUID->"02c475c0-f27f-434c-a1f2-96c6c5055bf2"],
Cell[637997, 15040, 207, 4, 28, "Input",ExpressionUUID->"936d89a9-96c7-4820-b0aa-8c653b4a4df4"],
Cell[638207, 15046, 1243, 32, 67, "Input",ExpressionUUID->"d3c0fe6d-6df0-40ce-a950-fb864be8c563"],
Cell[639453, 15080, 825, 21, 28, "Input",ExpressionUUID->"c54a0471-352a-4e1f-bb0d-b9ca070451e2"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

